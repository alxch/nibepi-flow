[
    {
        "id": "51e88f22.62d4a",
        "type": "tab",
        "label": "Test",
        "disabled": true,
        "info": ""
    },
    {
        "id": "b7f67da0.fbf1",
        "type": "tab",
        "label": "Start",
        "disabled": false,
        "info": ""
    },
    {
        "id": "df0dd648.98daa8",
        "type": "tab",
        "label": "SMHI 1.1",
        "disabled": false,
        "info": ""
    },
    {
        "id": "358baec9.c8b902",
        "type": "tab",
        "label": "Indoor 1.1",
        "disabled": false,
        "info": ""
    },
    {
        "id": "960078e.e3e6d88",
        "type": "tab",
        "label": "Price 1.1",
        "disabled": false,
        "info": ""
    },
    {
        "id": "fa4686d6.c21688",
        "type": "tab",
        "label": "Hotwater 1.1",
        "disabled": false,
        "info": ""
    },
    {
        "id": "eee76599.b5f0d8",
        "type": "tab",
        "label": "RMU 1.1",
        "disabled": false,
        "info": ""
    },
    {
        "id": "ae9d7ce8.0991c",
        "type": "tab",
        "label": "Airflow 1.1",
        "disabled": false,
        "info": ""
    },
    {
        "id": "27236b7a.3c2274",
        "type": "tab",
        "label": "Diagnostic 1.1",
        "disabled": false,
        "info": ""
    },
    {
        "id": "65e6bc5.05f2644",
        "type": "tab",
        "label": "Graph 1.1",
        "disabled": false,
        "info": ""
    },
    {
        "id": "64327e50.8f365",
        "type": "subflow",
        "name": "Skrivläge",
        "info": "",
        "category": "output",
        "in": [
            {
                "x": 193,
                "y": 539,
                "wires": [
                    {
                        "id": "24d4f99f.449346"
                    }
                ]
            }
        ],
        "out": [],
        "icon": "node-red/alert.png"
    },
    {
        "id": "c191a5d.5d76258",
        "type": "subflow",
        "name": "Update core config",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 70,
                "y": 77,
                "wires": [
                    {
                        "id": "eb6f8564.c5a668"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 706,
                "y": 168,
                "wires": [
                    {
                        "id": "6905e0f5.dd875",
                        "port": 0
                    }
                ]
            },
            {
                "x": 706,
                "y": 224,
                "wires": [
                    {
                        "id": "a38b1ef.5259be",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99",
        "outputLabels": [
            "Node Config",
            "Config"
        ]
    },
    {
        "id": "d7f6b34d.d13d6",
        "type": "mqtt-broker",
        "z": "",
        "name": "NibePi",
        "broker": "127.0.0.1",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "6aa61182.b42ed",
        "type": "ui_tab",
        "z": 0,
        "name": "Inställningar",
        "icon": "settings",
        "order": 2,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "74cc47a5.9ee208",
        "type": "ui_tab",
        "z": 0,
        "name": "Prognosreglering",
        "icon": "wi-wu-sunny",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "72d88fa0.a760e",
        "type": "ui_tab",
        "z": 0,
        "name": "Inomhusreglering",
        "icon": "home",
        "order": 4,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "57a2c311.41401c",
        "type": "ui_tab",
        "z": "",
        "name": "Automatiskt luftflöde",
        "icon": "wi-darksky-tornado",
        "order": 5,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "ad3904c7.ceae48",
        "type": "ui_tab",
        "z": 0,
        "name": "Elprisreglering",
        "icon": "flash_on",
        "order": 6,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "9efe2aac.f80568",
        "type": "ui_tab",
        "z": 0,
        "name": "List",
        "icon": "dashboard",
        "order": 7
    },
    {
        "id": "d814a7db.5cdc38",
        "type": "ui_group",
        "z": 0,
        "name": "Uppdateringar",
        "tab": "6aa61182.b42ed",
        "order": 1,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "4f8b35d1.5c8fec",
        "type": "ui_group",
        "z": "",
        "name": "Registerhantering",
        "tab": "1dc0b5a5.8e56aa",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "810e862f.c36438",
        "type": "ui_group",
        "z": 0,
        "name": "SMHI",
        "tab": "74cc47a5.9ee208",
        "order": 3,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "a2cfe148.70708",
        "type": "ui_group",
        "z": "",
        "name": "Inomhusreglering S1",
        "tab": "72d88fa0.a760e",
        "order": 1,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "ad7a33f3.24adf",
        "type": "ui_group",
        "z": 0,
        "name": "Automatisk lufthastighet",
        "tab": "57a2c311.41401c",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "90803197.41c34",
        "type": "ui_group",
        "z": "",
        "name": "Graf S1",
        "tab": "ad3904c7.ceae48",
        "order": 5,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "53b18b65.7718c4",
        "type": "ui_group",
        "z": "",
        "name": "Temperaturgraf",
        "tab": "72d88fa0.a760e",
        "order": 4,
        "disp": false,
        "width": "12",
        "collapse": false
    },
    {
        "id": "4a7ab836.172ae8",
        "type": "ui_group",
        "z": "",
        "name": "Information",
        "tab": "6aa61182.b42ed",
        "order": 8,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "72d428b5.3b0eb8",
        "type": "ui_group",
        "z": 0,
        "name": "Default",
        "tab": "9efe2aac.f80568",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "7e910a08.c6c984",
        "type": "ui_group",
        "z": "",
        "name": "Prognosreglering S1",
        "tab": "74cc47a5.9ee208",
        "order": 2,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "b561c5cd.249a58",
        "type": "ui_group",
        "z": "",
        "name": "Inställningar Värme",
        "tab": "ad3904c7.ceae48",
        "order": 3,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "2e9c7d75.ee6312",
        "type": "ui_group",
        "z": "",
        "name": "Inställningar Varmvatten",
        "tab": "ad3904c7.ceae48",
        "order": 4,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "f481a5f0.f9f1c8",
        "type": "ui_group",
        "z": 0,
        "name": "Inställningar",
        "tab": "ad3904c7.ceae48",
        "order": 2,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "e13feb70.134618",
        "type": "ui_base",
        "z": 0,
        "theme": {
            "name": "theme-custom",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#cd0101",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "customTheme": {
                "name": "Nibe",
                "default": "#4B7930",
                "baseColor": "#a80202",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "reset": false
            },
            "themeState": {
                "base-color": {
                    "default": "#4B7930",
                    "value": "#a80202",
                    "edited": true
                },
                "page-titlebar-backgroundColor": {
                    "value": "#a80202",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#ffffff",
                    "edited": true
                },
                "page-sidebar-backgroundColor": {
                    "value": "#ffffff",
                    "edited": true
                },
                "group-textColor": {
                    "value": "#f40303",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#555555",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": true
                },
                "widget-textColor": {
                    "value": "#000000",
                    "edited": true
                },
                "widget-backgroundColor": {
                    "value": "#a80202",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": true
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey"
            }
        },
        "site": {
            "name": "NibePi",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "YYYY/MM/DD",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "d342c0ba.f2418",
        "type": "ui_group",
        "z": "",
        "name": "Solfaktor",
        "tab": "74cc47a5.9ee208",
        "order": 4,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "455ba55e.e91e8c",
        "type": "ui_group",
        "z": "",
        "name": "Vindfaktor",
        "tab": "74cc47a5.9ee208",
        "order": 5,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "1409f0ed.f2d6cf",
        "type": "ui_group",
        "z": 0,
        "name": "Automatisk lufthastighet",
        "tab": "88b70b91.66f338",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "88b70b91.66f338",
        "type": "ui_tab",
        "z": 0,
        "name": "Lufthastighet",
        "icon": "wi-darksky-tornado",
        "order": 8,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "844659a2.8d8508",
        "type": "nibe-config",
        "z": "",
        "mqtt": true,
        "mqtt_discovery": true,
        "mqtt_topic": "nibe/modbus/",
        "mqtt_host": "127.0.0.1",
        "mqtt_port": "1883",
        "mqtt_user": "",
        "mqtt_pass": "",
        "connection_series": "fSeries",
        "connection": "serial",
        "serial_port": "/dev/ttyAMA0",
        "tcp_server": "",
        "tcp_port": ""
    },
    {
        "id": "b75c3bdd.9e0ae8",
        "type": "ui_tab",
        "z": "",
        "name": "Startsida",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "a8bf2b6e.6abc18",
        "type": "ui_group",
        "z": "",
        "name": "Husinformation",
        "tab": "b75c3bdd.9e0ae8",
        "order": 4,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "197ce413.27432c",
        "type": "ui_group",
        "z": "",
        "name": "Prognosreglering S2",
        "tab": "74cc47a5.9ee208",
        "order": 6,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "794cdfce.3f74f",
        "type": "ui_group",
        "z": "",
        "name": "Default",
        "tab": "ecddb018.0e4f3",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "ecddb018.0e4f3",
        "type": "ui_tab",
        "z": "",
        "name": "List",
        "icon": "dashboard",
        "order": 9
    },
    {
        "id": "1dc0b5a5.8e56aa",
        "type": "ui_tab",
        "z": "",
        "name": "Datahantering",
        "icon": "dashboard",
        "order": 10,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "bd199d65.157fc",
        "type": "ui_group",
        "z": "",
        "name": "Data",
        "tab": "1dc0b5a5.8e56aa",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "261b1f51.5c37e",
        "type": "ui_group",
        "z": "",
        "name": "Graf",
        "tab": "1dc0b5a5.8e56aa",
        "disp": true,
        "width": "18",
        "collapse": false
    },
    {
        "id": "33ed6fb8.2f3ce",
        "type": "ui_group",
        "z": "",
        "name": "Inställningar",
        "tab": "74cc47a5.9ee208",
        "order": 1,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "fb207b28.da59b8",
        "type": "ui_group",
        "z": "",
        "name": "Extra givare",
        "tab": "6aa61182.b42ed",
        "order": 2,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "95b0af9c.89089",
        "type": "ui_group",
        "z": "",
        "name": "Inställningar",
        "tab": "72d88fa0.a760e",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": true
    },
    {
        "id": "70965431.b26cbc",
        "type": "ui_group",
        "z": "",
        "name": "Data",
        "tab": "72d88fa0.a760e",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "1b40f24f.7b6d9e",
        "type": "ui_group",
        "z": "",
        "name": "Elprisreglering S1",
        "tab": "ad3904c7.ceae48",
        "order": 6,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "94305680.d32c48",
        "type": "ui_group",
        "z": "",
        "name": "Elprisreglering S2",
        "tab": "ad3904c7.ceae48",
        "order": 7,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "e6946a7.5e1e698",
        "type": "ui_group",
        "z": "",
        "name": "Information",
        "tab": "ad3904c7.ceae48",
        "order": 1,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "6ee1e12a.a6f04",
        "type": "ui_group",
        "z": "",
        "name": "Inomhusreglering S2",
        "tab": "72d88fa0.a760e",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "da3c0db0.9c6aa",
        "type": "ui_group",
        "z": "",
        "name": "System",
        "tab": "6aa61182.b42ed",
        "order": 9,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "605e2041.0137e",
        "type": "ui_group",
        "z": "",
        "name": "Värmekurva S1",
        "tab": "6aa61182.b42ed",
        "order": 10,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "ea24545a.5d7038",
        "type": "ui_group",
        "z": "",
        "name": "Värmekurva S2",
        "tab": "6aa61182.b42ed",
        "order": 11,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "958d2405.84c788",
        "type": "ui_tab",
        "z": "",
        "name": "Varmvattenreglering",
        "icon": "hot_tub",
        "order": 11,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "bcb5f9e4.9bc858",
        "type": "ui_group",
        "z": "",
        "name": "Automatisk Tillfällig Lyx",
        "tab": "958d2405.84c788",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "38b6d907.520796",
        "type": "ui_group",
        "z": "",
        "name": "Varmvatten Prioritet",
        "tab": "958d2405.84c788",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "97526682.5406d8",
        "type": "ui_group",
        "z": "",
        "name": "Loggning",
        "tab": "6aa61182.b42ed",
        "order": 3,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "ef983ace.21f138",
        "type": "ui_group",
        "z": "",
        "name": "RMU40 S1",
        "tab": "6aa61182.b42ed",
        "order": 13,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "32b15b25.77ef94",
        "type": "ui_group",
        "z": "",
        "name": "RMU40 S2",
        "tab": "6aa61182.b42ed",
        "order": 14,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "1d61b1b5.3ea93e",
        "type": "ui_group",
        "z": "",
        "name": "Kompressorförbrukning",
        "tab": "b75c3bdd.9e0ae8",
        "order": 5,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "fe94277c.dcd118",
        "type": "ui_group",
        "z": "",
        "name": "Avancerat",
        "tab": "6aa61182.b42ed",
        "order": 5,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "723a0250.fd7dcc",
        "type": "ui_group",
        "z": "",
        "name": "MQTT",
        "tab": "6aa61182.b42ed",
        "order": 6,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "6dbad083.a9946",
        "type": "ui_group",
        "z": "",
        "name": "Förbrukning strömavkännare",
        "tab": "b75c3bdd.9e0ae8",
        "order": 6,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "ab2b8fca.17eca",
        "type": "ui_group",
        "z": "",
        "name": "Graf S2",
        "tab": "ad3904c7.ceae48",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "b7178cee.09314",
        "type": "ui_group",
        "z": "",
        "name": "Sänk luftflöde",
        "tab": "57a2c311.41401c",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "2ed5a2d7.ca08ce",
        "type": "ui_group",
        "z": "",
        "name": "Forcering luftflöde",
        "tab": "57a2c311.41401c",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "7c351fda.75426",
        "type": "ui_group",
        "z": "",
        "name": "Filterrengöring",
        "tab": "57a2c311.41401c",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "4aaf21c9.38fb8",
        "type": "ui_group",
        "z": "",
        "name": "Data Export",
        "tab": "f3ab33ed.96488",
        "disp": true,
        "width": "12"
    },
    {
        "id": "f3ab33ed.96488",
        "type": "ui_tab",
        "z": "",
        "name": "Dashboard",
        "icon": "dashboard",
        "order": 1
    },
    {
        "id": "db563368.2a2e6",
        "type": "ui_group",
        "z": "",
        "name": "Default",
        "tab": "9a2cdcec.a1512",
        "disp": true,
        "width": "6"
    },
    {
        "id": "9a2cdcec.a1512",
        "type": "ui_tab",
        "z": "",
        "name": "testing",
        "icon": "dashboard"
    },
    {
        "id": "6356450b.b9318c",
        "type": "ui_group",
        "z": "",
        "name": "RMU40",
        "tab": "6aa61182.b42ed",
        "order": 12,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "da1887c7.ca0d38",
        "type": "ui_group",
        "z": "",
        "name": "Förord",
        "tab": "b75c3bdd.9e0ae8",
        "order": 1,
        "disp": false,
        "width": "12",
        "collapse": false
    },
    {
        "id": "c400f9d6.0a6028",
        "type": "ui_tab",
        "z": "",
        "name": "Diagnostik",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "3af8f7e6.d24338",
        "type": "ui_group",
        "z": "",
        "name": "Kompressoreffektivitet",
        "tab": "c400f9d6.0a6028",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "ffc74889.8cb7c8",
        "type": "ui_group",
        "z": "",
        "name": "Gradminut boost",
        "tab": "57a2c311.41401c",
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "24d4f99f.449346",
        "type": "exec",
        "z": "64327e50.8f365",
        "command": "sudo mount -o remount,rw /",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 582,
        "y": 539,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "39b0fc16.7de5c4",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "let data = global.get('data')||[];\nif(msg.raw!==undefined) {\n    let index = data.findIndex(n => n.register == msg.raw.register);\n    if(index!==-1) {\n        data[index] = msg.raw;\n    } else {\n        data.push(msg.raw);\n    }\n    global.set('data',data)\n    \n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 267,
        "y": 112,
        "wires": [
            [
                "9e97fa96.89ec78"
            ]
        ]
    },
    {
        "id": "9e97fa96.89ec78",
        "type": "debug",
        "z": "b7f67da0.fbf1",
        "name": "Data",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 400,
        "y": 112,
        "wires": []
    },
    {
        "id": "9ce049af.4ea4c8",
        "type": "nibe-input",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "",
        "add": false,
        "x": 112,
        "y": 112,
        "wires": [
            [],
            [
                "39b0fc16.7de5c4"
            ]
        ]
    },
    {
        "id": "da854f32.84c7f",
        "type": "inject",
        "z": "df0dd648.98daa8",
        "name": "Starta",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 91,
        "y": 43,
        "wires": [
            [
                "8ab34ba6.4ee288"
            ]
        ]
    },
    {
        "id": "8ab34ba6.4ee288",
        "type": "subflow:64327e50.8f365",
        "z": "df0dd648.98daa8",
        "name": "Skrivläge",
        "env": [],
        "x": 227,
        "y": 43,
        "wires": []
    },
    {
        "id": "6b181179.f7cdf",
        "type": "function",
        "z": "df0dd648.98daa8",
        "name": "",
        "func": "var config = global.get('config');\nvar windSet = global.get('windSet');\nif(config===undefined) {\n    node.error('Prognosreglering',{topic:\"Prognosreglering\",payload:\"Saknar config fil.\"})\n    return;\n}\nvar hours = (config.home.hours-1);\nvar sunrise = toTimestamp(msg.astro.sunrise);\nvar sunset = toTimestamp(msg.astro.sunset);\n\nvar timeNow = Number((Date.now()/1000).toFixed());\nvar time = Number((Date.now()/1000).toFixed())+(config.home.hours*3600);\nlet sun;\nif(time>sunrise && time<sunset) {\n    sun = true;\n} else {\n    sun = false;\n}\nvar temp = msg.payload.timeSeries[hours].parameters.find(temp => temp.name == \"t\");\nvar tempNow = msg.payload.timeSeries[0].parameters.find(tempNow => tempNow.name == \"t\");\nvar weather = msg.payload.timeSeries[hours].parameters.find(weather => weather.name == \"Wsymb2\");\n\nvar tempPredicted;\nif (temp!==undefined) {\ntempPredicted = temp.values[0];\n}\nvar weatherPredicted;\nif (weather!==undefined) {\nweatherPredicted = Number(weather.values[0]);\n}\nvar tempOutside = msg.outside;\nvar tempInside ;\nvar heatCurve = msg.heatcurve;\nvar setOffset;\nvar sunFactor = 0;\nif(tempOutside===undefined || heatCurve===undefined) {\n    node.error('Prognosreglering',{topic:\"Prognosreglering\",payload:\"Saknar värde från utomhusgivaren eller värmekurvan.\"});\n    return;\n}\nif(weatherPredicted===1 && sun===true) {\n    sunFactor = config.weather.clear;\n} else if(weatherPredicted===2 && sun===true) {\n    sunFactor = config.weather.mostly_clear;\n} else if(weatherPredicted===3 && sun===true) {\n    sunFactor = config.weather.half_clear;\n}\n// Test prognosjustering\n\nif(windSet!==undefined) {\n    tempPredicted = windSet;\n}\ntempPredicted = Number(((tempOutside-tempNow.values[0])+tempPredicted).toFixed(2));\nif(config.weather.sun_enable===undefined || config.weather.sun_enable===false) sunFactor = 0;\nsetOffset = Number(((tempOutside-tempPredicted-sunFactor)*(heatCurve*1.2/10)/((heatCurve/10)+1)).toFixed(2));\n\nglobal.set('weatherSet',Number(setOffset));\n\nnode.send({topic:\"Utomhustemp\",payload:tempOutside});\nnode.send({topic:\"Inomhustemp\",payload:tempInside});\nnode.send({topic:\"Prognos nu\",payload:tempNow.values[0]});\n\nnode.send({topic:\"Prognos (Nu) \"+config.home.hours+\"h\",payload:tempPredicted});\nnode.send([{topic:\"Prognos \"+config.home.hours+\"h\",payload:tempPredicted,timestamp:Date.now()+(config.home.hours*3600000)},{topic:\"SMHI Utomhustemp\",payload:tempPredicted,delay:(config.home.hours*3600000)}]);\nnode.send({topic:\"Kurvjustering\",payload:setOffset});\n\nfunction toTimestamp(strDate){\n var datum = Date.parse(strDate);\n return Number((datum/1000).toFixed());\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1079,
        "y": 938,
        "wires": [
            []
        ]
    },
    {
        "id": "415ceb72.bb9114",
        "type": "ui_toast",
        "z": "df0dd648.98daa8",
        "position": "bottom right",
        "displayTime": "7",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "topic": "",
        "name": "",
        "x": 720,
        "y": 42,
        "wires": []
    },
    {
        "id": "3e9a73d2.df1c3c",
        "type": "ui_slider",
        "z": "df0dd648.98daa8",
        "name": "",
        "label": "Norr ",
        "tooltip": "",
        "group": "455ba55e.e91e8c",
        "order": 13,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "wind_factor_n",
        "min": 0,
        "max": "2",
        "step": "0.1",
        "x": 1002,
        "y": 735,
        "wires": [
            [
                "e2a1ad3d.f8237"
            ]
        ]
    },
    {
        "id": "e0568cfa.ce37d",
        "type": "ui_slider",
        "z": "df0dd648.98daa8",
        "name": "",
        "label": "Söder",
        "tooltip": "",
        "group": "455ba55e.e91e8c",
        "order": 15,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "wind_factor_s",
        "min": 0,
        "max": "2",
        "step": "0.1",
        "x": 1003,
        "y": 784,
        "wires": [
            [
                "21ec51aa.8d21ce"
            ]
        ]
    },
    {
        "id": "c0ca403c.4cd65",
        "type": "ui_slider",
        "z": "df0dd648.98daa8",
        "name": "",
        "label": "Väst ",
        "tooltip": "",
        "group": "455ba55e.e91e8c",
        "order": 17,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "wind_factor_w",
        "min": 0,
        "max": "2",
        "step": "0.1",
        "x": 1003,
        "y": 833,
        "wires": [
            [
                "7ea5d6a2.6b6f78"
            ]
        ]
    },
    {
        "id": "de90adfc.3a51d",
        "type": "ui_slider",
        "z": "df0dd648.98daa8",
        "name": "",
        "label": "Öst  ",
        "tooltip": "",
        "group": "455ba55e.e91e8c",
        "order": 19,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "wind_factor_e",
        "min": 0,
        "max": "2",
        "step": "0.1",
        "x": 1003,
        "y": 882,
        "wires": [
            [
                "66f72656.28acb8"
            ]
        ]
    },
    {
        "id": "73f9e0db.d20a2",
        "type": "ui_chart",
        "z": "df0dd648.98daa8",
        "name": "",
        "group": "455ba55e.e91e8c",
        "order": 5,
        "width": "0",
        "height": "0",
        "label": "Vindprognos",
        "chartType": "line",
        "legend": "true",
        "xformat": "dd HH:mm",
        "interpolate": "linear",
        "nodata": "Data ej tillgängligt",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "48",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 910,
        "y": 294,
        "wires": [
            []
        ]
    },
    {
        "id": "2050771b.5288a8",
        "type": "function",
        "z": "df0dd648.98daa8",
        "name": "",
        "func": "var config = global.get('config');\nif(config===undefined) {\n    node.error('Prognosreglering',{topic:\"Prognosreglering\",payload:\"Saknar konfiguration\"})\n    return;\n}\nvar hours = (config.home.hours-1);\nvar array = msg.payload.timeSeries;\n\nvar tempOutside = msg.outside;\nvar tempInside = msg.inside;\nvar heatCurve = msg.heatcurve;\nvar setOffset;\nif(tempOutside===undefined || heatCurve===undefined) {\n    node.error('Prognosreglering',{topic:\"Prognosreglering\",payload:\"Saknar värde från utomhusgivaren eller värmekurvan.\"});\n    return;\n}\n\nvar wind_speed_arr = [];\nvar wind_gust_arr = [];\nvar temp_arr = [];\nvar feel_arr = [];\nvar direction_arr = [];\nfor( var o = 0; o < 49; o++){\n    let timestamp = toTimestamp(array[o].validTime)\n    let topic = \"Vind\"\n    let speed = array[o].parameters.find(speed => speed.name == \"ws\");\n    let dir = array[o].parameters.find(dir => dir.name == \"wd\");\n    let gust = array[o].parameters.find(gust => gust.name == \"gust\");\n    let temp = array[o].parameters.find(temp => temp.name == \"t\");\n    speed = speed.values[0];\n    gust = gust.values[0];\n    temp = temp.values[0];\n    dir = dir.values[0];\n    let direction = 0;\n    let factor = 1;\n    if(((1 <= dir) && (dir <= 45)) || ((315 <= dir) && (dir <= 360))) {\n        direction = -1;\n        factor = config.weather.wind_factor_n;\n    } else if(136 <= dir && dir <= 225) {\n        direction = -2;\n        factor = config.weather.wind_factor_s;\n    } else if(226 <= dir && dir <= 314) {\n        direction = -3;\n        factor = config.weather.wind_factor_w;\n    } else if(46 <= dir && dir <= 135) {\n        direction = -4;\n        factor = config.weather.wind_factor_e;\n    }\n    let v = Math.pow(speed, 0.16);\n    feel = Number((13.12+(0.6215*temp)-(13.956*v)+(0.48669*temp*v)).toFixed(2));\n    if(feel>0) {\n        feel = feel/factor;\n        if(feel>temp) {\n            feel = temp;\n        }\n    } else {\n        feel = feel*factor\n        if(feel>temp) {\n            feel = temp;\n        }\n    }\n    if(speed<2 || temp>10 || speed>35 || direction===0) feel = temp;\n    wind_speed_arr.push({x:timestamp,y:Number(speed)});\n    wind_gust_arr.push({x:timestamp,y:Number(gust)});\n    temp_arr.push({x:timestamp,y:Number(temp)});\n    feel_arr.push({x:timestamp,y:feel});\n    direction_arr.push({x:timestamp,y:direction});\n    if(config.weather.wind_enable!==undefined && config.weather.wind_enable===true) {\n        if(o===hours) {\n            global.set('windSet',feel);\n        }\n    } else {\n        global.set('windSet',undefined);\n    }\n}\n//var test = wind_speed_arr.sort(function(a,b){return a.x - b.y});\nwind_speed_arr.sort((a, b) => (a.x > b.x) ? 1 : -1)\nwind_gust_arr.sort((a, b) => (a.x > b.x) ? 1 : -1)\ntemp_arr.sort((a, b) => (a.x > b.x) ? 1 : -1)\nfeel_arr.sort((a, b) => (a.x > b.x) ? 1 : -1)\ndirection_arr.sort((a, b) => (a.x > b.x) ? 1 : -1)\nvar sendArray = [\n    {\n        \"series\":[\"Vindhastighet\",\"Byvind\",\"Utomhustemp\",\"Köldeffekt\",\"Riktning\"],\n        \"data\":[wind_speed_arr,wind_gust_arr,temp_arr,feel_arr,direction_arr],\n        \"labels\":[\"Vindhastighet\",\"Byvind\",\"Utomhustemp\",\"Köldeffekt\",\"Riktning\"]\n    }];\nnode.send({topic:\"Vindhastighet\",payload:sendArray});\nfunction toTimestamp(strDate){\n var datum = Date.parse(strDate);\n return Number((datum).toFixed());\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1219,
        "y": 938,
        "wires": [
            []
        ]
    },
    {
        "id": "d9645915.c269b8",
        "type": "ui_button",
        "z": "df0dd648.98daa8",
        "name": "Rensa graf Vind",
        "group": "455ba55e.e91e8c",
        "order": 10,
        "width": "12",
        "height": "1",
        "passthru": false,
        "label": "Rensa graf",
        "tooltip": "Rensar grafen och börjar om på nytt",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "[]",
        "payloadType": "json",
        "topic": "",
        "x": 689,
        "y": 287,
        "wires": [
            [
                "73f9e0db.d20a2"
            ]
        ]
    },
    {
        "id": "a1689e47.01c06",
        "type": "ui_template",
        "z": "df0dd648.98daa8",
        "group": "455ba55e.e91e8c",
        "name": "SMHI Riktning info",
        "order": 7,
        "width": 0,
        "height": 0,
        "format": "Riktning: Norr: -1, Söder: -2, Väst: -3, Öst: -4<br>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 1245,
        "y": 336,
        "wires": [
            []
        ]
    },
    {
        "id": "1d1c593e.bdd0c7",
        "type": "ui_switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "MQTT Broker",
        "tooltip": "",
        "group": "723a0250.fd7dcc",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "enable",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 157,
        "y": 224,
        "wires": [
            [
                "68fb54e2.e8cb7c"
            ]
        ]
    },
    {
        "id": "3f2df90a.87e2f6",
        "type": "ui_text_input",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "MQTT Topic",
        "tooltip": "",
        "group": "723a0250.fd7dcc",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "topic",
        "x": 147,
        "y": 322,
        "wires": [
            [
                "5a6f14bc.96beac"
            ]
        ]
    },
    {
        "id": "1dd16422.6e81ec",
        "type": "function",
        "z": "c191a5d.5d76258",
        "name": "",
        "func": "let config = msg.config;\nlet pluginName = env.get(\"Name\");\nif(config===undefined) return;\nif(config[pluginName]===undefined) {config[pluginName] = {}}\nconfig[pluginName][msg.topic] = msg.payload;\nnode.send({payload:config});",
        "outputs": 1,
        "noerr": 0,
        "x": 344,
        "y": 112,
        "wires": [
            [
                "b562cc0e.728b4"
            ]
        ]
    },
    {
        "id": "b562cc0e.728b4",
        "type": "nibe-output",
        "z": "c191a5d.5d76258",
        "server": "844659a2.8d8508",
        "name": "setConfig",
        "x": 529,
        "y": 112,
        "wires": [
            []
        ]
    },
    {
        "id": "eb6f8564.c5a668",
        "type": "nibe-request",
        "z": "c191a5d.5d76258",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 197,
        "y": 77,
        "wires": [
            [
                "1dd16422.6e81ec"
            ],
            []
        ]
    },
    {
        "id": "9110855e.8bfd98",
        "type": "function",
        "z": "c191a5d.5d76258",
        "name": "",
        "func": "    let topic = env.get(\"Function\");\n    let pluginName = env.get(\"Name\");\n    \n    if(topic!==undefined) {\n        if(msg.payload[pluginName]===undefined) {\n            msg.payload[pluginName] = {};\n        }\n        if(msg.payload[pluginName][topic]!==undefined) {\n            node.send({payload:msg.payload[pluginName][topic],topic:\"Input\"});\n            node.send([null,{topic:\"config\",payload:msg.payload}]);\n        }\n    }",
        "outputs": 2,
        "noerr": 0,
        "x": 344,
        "y": 168,
        "wires": [
            [
                "6905e0f5.dd875"
            ],
            [
                "a38b1ef.5259be"
            ]
        ]
    },
    {
        "id": "68fb54e2.e8cb7c",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "mqtt",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable",
                "type": "str"
            }
        ],
        "x": 395,
        "y": 224,
        "wires": [
            [
                "1d1c593e.bdd0c7",
                "b4a9d18b.4c69a"
            ],
            []
        ]
    },
    {
        "id": "2b22f2ea.5b3ece",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "mqtt",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "topic",
                "type": "str"
            }
        ],
        "x": 496,
        "y": 322,
        "wires": [
            [
                "3f2df90a.87e2f6"
            ],
            []
        ]
    },
    {
        "id": "c559c6e7.c4b388",
        "type": "ui_text_input",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Latitud",
        "tooltip": "",
        "group": "a8bf2b6e.6abc18",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "lat",
        "x": 820,
        "y": 525,
        "wires": [
            [
                "ba1e9bfe.f81a78"
            ]
        ]
    },
    {
        "id": "3698a0bc.b86fc",
        "type": "ui_text_input",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Longitud",
        "tooltip": "",
        "group": "a8bf2b6e.6abc18",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "lon",
        "x": 830,
        "y": 574,
        "wires": [
            [
                "18984de6.08fc72"
            ]
        ]
    },
    {
        "id": "97d47914.109668",
        "type": "comment",
        "z": "b7f67da0.fbf1",
        "name": "Husdata",
        "info": "",
        "x": 683,
        "y": 420,
        "wires": []
    },
    {
        "id": "6b8355d0.18512c",
        "type": "nibe-request",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "cpr_tot_kwh",
        "x": 609,
        "y": 1134,
        "wires": [
            [
                "c1d7dd0f.8b712"
            ],
            []
        ]
    },
    {
        "id": "c1d7dd0f.8b712",
        "type": "nibe-request",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "cpr_hw_kwh",
        "x": 770,
        "y": 1134,
        "wires": [
            [
                "d34de900.a6d0d8"
            ],
            []
        ]
    },
    {
        "id": "99ffc02f.7bb77",
        "type": "ui_chart",
        "z": "b7f67da0.fbf1",
        "name": "",
        "group": "1d61b1b5.3ea93e",
        "order": 5,
        "width": 0,
        "height": 0,
        "label": "Kompressorförbrukning",
        "chartType": "pie",
        "legend": "true",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "48",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#d20000",
            "#0000ff",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 1139,
        "y": 1127,
        "wires": [
            []
        ]
    },
    {
        "id": "d34de900.a6d0d8",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "if(msg.cpr_tot_kwh!==undefined && msg.cpr_tot_kwh!==0) {\n    let hide = {\n        \"group\":\n            {\"show\":\n                [\"Startsida_Kompressorförbrukning\"]\n            }\n        }\n    node.send([null,null,{payload:hide}]);\n    node.send({topic:\"Värme\",payload:Number((msg.cpr_tot_kwh-msg.cpr_hw_kwh).toFixed(0))});\n    node.send([null,{topic:\"Varmvatten\",payload:Number(msg.cpr_hw_kwh.toFixed(0))}]);\n} else {\n    let hide = {\n        \"group\":\n            {\"hide\":\n                [\"Startsida_Kompressorförbrukning\"]\n            }\n        }\n    node.send([null,null,{payload:hide}]);\n}\n",
        "outputs": 3,
        "noerr": 0,
        "x": 918,
        "y": 1134,
        "wires": [
            [
                "99ffc02f.7bb77",
                "a508560f.9d9228"
            ],
            [
                "b7aacf55.4c083",
                "99ffc02f.7bb77"
            ],
            [
                "bbeace10.c8e3d"
            ]
        ]
    },
    {
        "id": "a5330dfd.4dd73",
        "type": "inject",
        "z": "b7f67da0.fbf1",
        "name": "",
        "topic": "",
        "payload": "[]",
        "payloadType": "json",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 918,
        "y": 1092,
        "wires": [
            [
                "99ffc02f.7bb77"
            ]
        ]
    },
    {
        "id": "a508560f.9d9228",
        "type": "ui_text",
        "z": "b7f67da0.fbf1",
        "group": "1d61b1b5.3ea93e",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "{{msg.topic}}",
        "format": "{{msg.payload}} kWh",
        "layout": "row-left",
        "x": 1065,
        "y": 1225,
        "wires": []
    },
    {
        "id": "b7aacf55.4c083",
        "type": "ui_text",
        "z": "b7f67da0.fbf1",
        "group": "1d61b1b5.3ea93e",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "{{msg.topic}}",
        "format": "{{msg.payload}} kWh",
        "layout": "row-left",
        "x": 1065,
        "y": 1183,
        "wires": []
    },
    {
        "id": "116b9a89.73baf5",
        "type": "ui_ui_control",
        "z": "b7f67da0.fbf1",
        "name": "",
        "events": "change",
        "x": 130,
        "y": 1134,
        "wires": [
            [
                "67efbfba.ccf4a"
            ]
        ]
    },
    {
        "id": "67efbfba.ccf4a",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Startsida",
        "func": "if(msg.name==\"Startsida\") {\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 277,
        "y": 1134,
        "wires": [
            [
                "1803ad9d.9710a2"
            ]
        ]
    },
    {
        "id": "1803ad9d.9710a2",
        "type": "delay",
        "z": "b7f67da0.fbf1",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 437,
        "y": 1134,
        "wires": [
            [
                "6b8355d0.18512c"
            ]
        ]
    },
    {
        "id": "257d3e61.f15db2",
        "type": "ui_text_input",
        "z": "df0dd648.98daa8",
        "name": "",
        "label": "Klart väder",
        "tooltip": "",
        "group": "d342c0ba.f2418",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "number",
        "delay": "0",
        "topic": "clear",
        "x": 161,
        "y": 630,
        "wires": [
            [
                "bc73fbe5.bdfd48"
            ]
        ]
    },
    {
        "id": "a1d2b301.cca65",
        "type": "ui_text_input",
        "z": "df0dd648.98daa8",
        "name": "",
        "label": "Mestadels klart väder",
        "tooltip": "",
        "group": "d342c0ba.f2418",
        "order": 8,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "number",
        "delay": "0",
        "topic": "mostly_clear",
        "x": 191,
        "y": 679,
        "wires": [
            [
                "bac43b6a.ac8a48"
            ]
        ]
    },
    {
        "id": "3aa1cf7c.e15ef",
        "type": "ui_text_input",
        "z": "df0dd648.98daa8",
        "name": "",
        "label": "Halvklart väder",
        "tooltip": "",
        "group": "d342c0ba.f2418",
        "order": 10,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "number",
        "delay": "0",
        "topic": "half_clear",
        "x": 171,
        "y": 728,
        "wires": [
            [
                "22b888d6.4e5778"
            ]
        ]
    },
    {
        "id": "6e9d06f1.c9ebc8",
        "type": "ui_switch",
        "z": "df0dd648.98daa8",
        "name": "Aktivera Solfaktor",
        "label": "Aktivera",
        "tooltip": "",
        "group": "d342c0ba.f2418",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "sun_enable",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 188,
        "y": 861,
        "wires": [
            [
                "c84a3009.de52b"
            ]
        ]
    },
    {
        "id": "2aa7811b.637b2e",
        "type": "ui_switch",
        "z": "df0dd648.98daa8",
        "name": "Aktivera Vindfaktor",
        "label": "Aktivera",
        "tooltip": "",
        "group": "455ba55e.e91e8c",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "wind_enable",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 188,
        "y": 812,
        "wires": [
            [
                "3f21aae7.95c2e6"
            ]
        ]
    },
    {
        "id": "a8deecfc.3d34b",
        "type": "ui_slider",
        "z": "358baec9.c8b902",
        "name": "",
        "label": "Inomhus börvärde",
        "tooltip": "",
        "group": "a2cfe148.70708",
        "order": 5,
        "width": "11",
        "height": "1",
        "passthru": false,
        "outs": "end",
        "topic": "",
        "min": "5",
        "max": "30",
        "step": "0.5",
        "x": 678,
        "y": 182,
        "wires": [
            [
                "e9e08f7a.850de"
            ]
        ]
    },
    {
        "id": "5e3504d0.fd3ffc",
        "type": "ui_slider",
        "z": "358baec9.c8b902",
        "name": "",
        "label": "Utomhustemp blockering",
        "tooltip": "Välj vid vilken temperatur som värmen ska blockeras.",
        "group": "95b0af9c.89089",
        "order": 1,
        "width": "0",
        "height": "0",
        "passthru": false,
        "outs": "end",
        "topic": "outdoor_set",
        "min": "8",
        "max": "26",
        "step": "1",
        "x": 677,
        "y": 588,
        "wires": [
            [
                "589ea604.984ac8"
            ]
        ]
    },
    {
        "id": "8a3192fa.29d1d",
        "type": "ui_slider",
        "z": "358baec9.c8b902",
        "name": "",
        "label": "Faktor för Inomhusgivare",
        "tooltip": "Ställ in hur mycket inomhus givare ska påverka framledningstemperaturen.",
        "group": "a2cfe148.70708",
        "order": 6,
        "width": "11",
        "height": "1",
        "passthru": false,
        "outs": "end",
        "topic": "inside_factor",
        "min": "0",
        "max": "6",
        "step": "0.1",
        "x": 698,
        "y": 280,
        "wires": [
            [
                "7e1732cb.c8f15c"
            ]
        ]
    },
    {
        "id": "e9e08f7a.850de",
        "type": "nibe-output",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "inside_set_s1",
        "x": 934,
        "y": 182,
        "wires": [
            [
                "a8deecfc.3d34b"
            ]
        ]
    },
    {
        "id": "8df4a3c.164c26",
        "type": "nibe-request",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "inside_set_s1",
        "x": 465,
        "y": 182,
        "wires": [
            [],
            [
                "a8deecfc.3d34b",
                "bc50dbcc.0268c8"
            ]
        ]
    },
    {
        "id": "43a637b0.9a2d78",
        "type": "ui_ui_control",
        "z": "358baec9.c8b902",
        "name": "",
        "events": "all",
        "x": 95,
        "y": 182,
        "wires": [
            [
                "a3bbe686.2f1518"
            ]
        ]
    },
    {
        "id": "a3bbe686.2f1518",
        "type": "function",
        "z": "358baec9.c8b902",
        "name": "Inomhusreglering",
        "func": "var timeSaved = context.get('time')||(Date.now()-1000);\nvar time = Date.now();\nif(msg.name==\"Inomhusreglering\") {\n    if(time>timeSaved) {\n        context.set('time',(time+30000));\n        return msg;\n    }\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 265,
        "y": 182,
        "wires": [
            [
                "d6176cc8.3e0d3",
                "87a83c1.3cd9fc"
            ]
        ]
    },
    {
        "id": "bc50dbcc.0268c8",
        "type": "nibe-request",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "outdoor_set",
        "x": 427,
        "y": 581,
        "wires": [
            [],
            [
                "5e3504d0.fd3ffc",
                "432a1d50.84fbc4"
            ]
        ]
    },
    {
        "id": "589ea604.984ac8",
        "type": "nibe-output",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "outdoor_set",
        "x": 889,
        "y": 588,
        "wires": [
            [
                "5e3504d0.fd3ffc"
            ]
        ]
    },
    {
        "id": "432a1d50.84fbc4",
        "type": "nibe-request",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "inside_factor_s1",
        "x": 444,
        "y": 287,
        "wires": [
            [],
            [
                "8a3192fa.29d1d"
            ]
        ]
    },
    {
        "id": "7e1732cb.c8f15c",
        "type": "nibe-output",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "inside_factor_s1",
        "x": 927,
        "y": 280,
        "wires": [
            [
                "8a3192fa.29d1d"
            ]
        ]
    },
    {
        "id": "8b79bac6.370258",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "home",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "lat",
                "type": "str"
            }
        ],
        "x": 1133,
        "y": 525,
        "wires": [
            [
                "c559c6e7.c4b388"
            ],
            []
        ]
    },
    {
        "id": "3118479a.5faed8",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "home",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "lon",
                "type": "str"
            }
        ],
        "x": 1133,
        "y": 574,
        "wires": [
            [
                "3698a0bc.b86fc"
            ],
            []
        ]
    },
    {
        "id": "bc73fbe5.bdfd48",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "weather",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "clear",
                "type": "str"
            }
        ],
        "x": 405,
        "y": 630,
        "wires": [
            [
                "257d3e61.f15db2"
            ],
            []
        ]
    },
    {
        "id": "bac43b6a.ac8a48",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "weather",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "mostly_clear",
                "type": "str"
            }
        ],
        "x": 405,
        "y": 679,
        "wires": [
            [
                "a1d2b301.cca65"
            ],
            []
        ]
    },
    {
        "id": "22b888d6.4e5778",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "weather",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "half_clear",
                "type": "str"
            }
        ],
        "x": 405,
        "y": 728,
        "wires": [
            [
                "3aa1cf7c.e15ef"
            ],
            []
        ]
    },
    {
        "id": "3f21aae7.95c2e6",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "weather",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "wind_enable",
                "type": "str"
            }
        ],
        "x": 405,
        "y": 812,
        "wires": [
            [
                "2aa7811b.637b2e",
                "9489e9a0.cd1268"
            ],
            []
        ]
    },
    {
        "id": "c84a3009.de52b",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "weather",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "sun_enable",
                "type": "str"
            }
        ],
        "x": 405,
        "y": 861,
        "wires": [
            [
                "6e9d06f1.c9ebc8",
                "740712c9.2bd05c"
            ],
            []
        ]
    },
    {
        "id": "e2a1ad3d.f8237",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "weather",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "wind_factor_n",
                "type": "str"
            }
        ],
        "x": 1161,
        "y": 735,
        "wires": [
            [
                "3e9a73d2.df1c3c"
            ],
            []
        ]
    },
    {
        "id": "21ec51aa.8d21ce",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "weather",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "wind_factor_s",
                "type": "str"
            }
        ],
        "x": 1161,
        "y": 784,
        "wires": [
            [
                "e0568cfa.ce37d"
            ],
            []
        ]
    },
    {
        "id": "7ea5d6a2.6b6f78",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "weather",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "wind_factor_w",
                "type": "str"
            }
        ],
        "x": 1161,
        "y": 833,
        "wires": [
            [
                "c0ca403c.4cd65"
            ],
            []
        ]
    },
    {
        "id": "66f72656.28acb8",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "weather",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "wind_factor_e",
                "type": "str"
            }
        ],
        "x": 1161,
        "y": 882,
        "wires": [
            [
                "de90adfc.3a51d"
            ],
            []
        ]
    },
    {
        "id": "4b0bab33.266894",
        "type": "ui_ui_control",
        "z": "b7f67da0.fbf1",
        "name": "",
        "events": "all",
        "x": 270,
        "y": 546,
        "wires": [
            [
                "236045ec.27f9ca"
            ]
        ]
    },
    {
        "id": "236045ec.27f9ca",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Inställningar",
        "func": "var timeSaved = context.get('time')||(Date.now()-1000);\nvar time = Date.now();\nif(msg.name==\"Inställningar\") {\n    if(time>timeSaved) {\n        context.set('time',(time+30000));\n        return msg;\n    }\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 434,
        "y": 546,
        "wires": [
            [
                "ed4672a6.2a277",
                "a2146cd8.91aae"
            ]
        ]
    },
    {
        "id": "5a6f14bc.96beac",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Add /",
        "func": "var value = msg.payload;\nvar check = value.endsWith(\"/\");\nif(check===false) {\n    value = value+\"/\";\n}\nmsg.payload = value;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 309,
        "y": 322,
        "wires": [
            [
                "2b22f2ea.5b3ece"
            ]
        ]
    },
    {
        "id": "ec0195eb.b769a8",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "weather",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable_s1",
                "type": "str"
            }
        ],
        "x": 132,
        "y": 322,
        "wires": [
            [
                "4f685464.ce3e7c"
            ],
            []
        ]
    },
    {
        "id": "4f685464.ce3e7c",
        "type": "ui_switch",
        "z": "df0dd648.98daa8",
        "name": "",
        "label": "Aktivera",
        "tooltip": "",
        "group": "7e910a08.c6c984",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "weather/enable",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 305,
        "y": 322,
        "wires": [
            [
                "c1f92f58.722e9"
            ]
        ]
    },
    {
        "id": "d92d33b1.e333d",
        "type": "nibe-request",
        "z": "c191a5d.5d76258",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 204,
        "y": 168,
        "wires": [
            [],
            [
                "9110855e.8bfd98"
            ]
        ]
    },
    {
        "id": "520d09d6.d3cbb8",
        "type": "inject",
        "z": "c191a5d.5d76258",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "x": 133,
        "y": 231,
        "wires": [
            [
                "d92d33b1.e333d"
            ]
        ]
    },
    {
        "id": "a9a8b1e1.e176b",
        "type": "nibe-input",
        "z": "c191a5d.5d76258",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 92,
        "y": 126,
        "wires": [
            [
                "9110855e.8bfd98"
            ],
            []
        ]
    },
    {
        "id": "c1f92f58.722e9",
        "type": "nibe-weather",
        "z": "df0dd648.98daa8",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "sun": true,
        "wind": false,
        "adjust": "0.5",
        "hours": "8",
        "x": 458,
        "y": 245,
        "wires": [
            [],
            [
                "73f9e0db.d20a2"
            ]
        ]
    },
    {
        "id": "d9788d5a.89152",
        "type": "ui_button",
        "z": "df0dd648.98daa8",
        "name": "Uppdatera S1",
        "group": "7e910a08.c6c984",
        "order": 6,
        "width": "12",
        "height": "1",
        "passthru": false,
        "label": "Uppdatera",
        "tooltip": "Begär ny väderdata och uppdatera grafen med nya värden.",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "update",
        "x": 269,
        "y": 245,
        "wires": [
            [
                "c1f92f58.722e9"
            ]
        ]
    },
    {
        "id": "ed4672a6.2a277",
        "type": "nibe-request",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "heatcurve_s1",
        "x": 206,
        "y": 595,
        "wires": [
            [],
            [
                "d5d861a9.d7ae9"
            ]
        ]
    },
    {
        "id": "2f31d75c.487a68",
        "type": "nibe-output",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "heatcurve_s1",
        "x": 598,
        "y": 595,
        "wires": [
            []
        ]
    },
    {
        "id": "33987348.04de5c",
        "type": "nibe-weather",
        "z": "df0dd648.98daa8",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s2",
        "sun": true,
        "wind": false,
        "adjust": "0",
        "hours": "1",
        "x": 633,
        "y": 462,
        "wires": [
            [
                "c6b38433.c27d98"
            ],
            []
        ]
    },
    {
        "id": "e7144dfe.63ec7",
        "type": "ui_button",
        "z": "df0dd648.98daa8",
        "name": "Uppdatera S2",
        "group": "197ce413.27432c",
        "order": 6,
        "width": "12",
        "height": "1",
        "passthru": false,
        "label": "Uppdatera",
        "tooltip": "Begär ny väderdata och uppdatera grafen med nya värden.",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "update",
        "x": 437,
        "y": 525,
        "wires": [
            [
                "33987348.04de5c"
            ]
        ]
    },
    {
        "id": "27f7876f.904e08",
        "type": "ui_slider",
        "z": "df0dd648.98daa8",
        "name": "",
        "label": "Prognostid",
        "tooltip": "",
        "group": "7e910a08.c6c984",
        "order": 3,
        "width": "0",
        "height": "0",
        "passthru": false,
        "outs": "end",
        "topic": "home/hours",
        "min": "0",
        "max": "24",
        "step": "1",
        "x": 329,
        "y": 175,
        "wires": [
            [
                "c1f92f58.722e9"
            ]
        ]
    },
    {
        "id": "65733a0b.1018c4",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "home",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "hours_s1",
                "type": "str"
            }
        ],
        "x": 139,
        "y": 175,
        "wires": [
            [
                "27f7876f.904e08"
            ],
            []
        ]
    },
    {
        "id": "6321d043.e7772",
        "type": "ui_slider",
        "z": "df0dd648.98daa8",
        "name": "",
        "label": "Prognostid",
        "tooltip": "",
        "group": "197ce413.27432c",
        "order": 3,
        "width": "0",
        "height": "0",
        "passthru": false,
        "outs": "end",
        "topic": "home/hours",
        "min": "0",
        "max": "24",
        "step": "1",
        "x": 441,
        "y": 413,
        "wires": [
            [
                "33987348.04de5c"
            ]
        ]
    },
    {
        "id": "90f9072d.c6e398",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "home",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "hours_s2",
                "type": "str"
            }
        ],
        "x": 153,
        "y": 413,
        "wires": [
            [
                "6321d043.e7772"
            ],
            []
        ]
    },
    {
        "id": "c6b38433.c27d98",
        "type": "function",
        "z": "df0dd648.98daa8",
        "name": "Enable/Disable",
        "func": "if(msg.enabled!==undefined && msg.enabled===false) {\n    node.send(msg);\n    let hide = {\n        \"group\":\n            {\"hide\":\n                [\"Prognosreglering_Prognosreglering_S2\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n} else if(msg.enabled===true) {\n    let hide = {\n        \"group\":\n            {\"show\":\n                [\"Prognosreglering_Prognosreglering_S2\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 766,
        "y": 539,
        "wires": [
            [
                "6321d043.e7772",
                "e7144dfe.63ec7",
                "191d7af8.9d5725"
            ],
            [
                "c65b6d8f.e1f51"
            ]
        ]
    },
    {
        "id": "5eaea9fd.2ab8b8",
        "type": "ui_text_input",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Host",
        "tooltip": "",
        "group": "723a0250.fd7dcc",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "host",
        "x": 127,
        "y": 371,
        "wires": [
            [
                "8e2dcb3b.b540d8"
            ]
        ]
    },
    {
        "id": "8e2dcb3b.b540d8",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "mqtt",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "host",
                "type": "str"
            }
        ],
        "x": 300,
        "y": 371,
        "wires": [
            [
                "5eaea9fd.2ab8b8"
            ],
            []
        ]
    },
    {
        "id": "3eed3ea7.c66072",
        "type": "ui_text_input",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Port",
        "tooltip": "",
        "group": "723a0250.fd7dcc",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "port",
        "x": 127,
        "y": 413,
        "wires": [
            [
                "be65b446.64ee38"
            ]
        ]
    },
    {
        "id": "be65b446.64ee38",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "mqtt",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "port",
                "type": "str"
            }
        ],
        "x": 300,
        "y": 413,
        "wires": [
            [
                "3eed3ea7.c66072"
            ],
            []
        ]
    },
    {
        "id": "7cc82e4d.8f653",
        "type": "ui_text_input",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "User",
        "tooltip": "",
        "group": "723a0250.fd7dcc",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "user",
        "x": 127,
        "y": 455,
        "wires": [
            [
                "50364127.011b3"
            ]
        ]
    },
    {
        "id": "50364127.011b3",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "mqtt",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "user",
                "type": "str"
            }
        ],
        "x": 300,
        "y": 455,
        "wires": [
            [
                "7cc82e4d.8f653"
            ],
            []
        ]
    },
    {
        "id": "b4c7f670.d5d7a8",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "mqtt",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "pass",
                "type": "str"
            }
        ],
        "x": 314,
        "y": 497,
        "wires": [
            [
                "6fe84622.e973e8"
            ],
            []
        ]
    },
    {
        "id": "6fe84622.e973e8",
        "type": "ui_text_input",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Password",
        "tooltip": "",
        "group": "723a0250.fd7dcc",
        "order": 8,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "password",
        "delay": "0",
        "topic": "pass",
        "x": 137,
        "y": 497,
        "wires": [
            [
                "b4c7f670.d5d7a8"
            ]
        ]
    },
    {
        "id": "c03aa9f0.099228",
        "type": "ui_slider",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Kurvjustering S1",
        "tooltip": "",
        "group": "605e2041.0137e",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "adjust_s1",
        "min": "-6",
        "max": "6",
        "step": "0.5",
        "x": 451,
        "y": 735,
        "wires": [
            [
                "d25aa0c5.71b29"
            ]
        ]
    },
    {
        "id": "d25aa0c5.71b29",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "home",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "adjust_s1",
                "type": "str"
            }
        ],
        "x": 643,
        "y": 735,
        "wires": [
            [
                "c03aa9f0.099228"
            ],
            []
        ]
    },
    {
        "id": "3976a9c5.383436",
        "type": "ui_slider",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Kurvjustering S2",
        "tooltip": "",
        "group": "ea24545a.5d7038",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "adjust_s2",
        "min": "-6",
        "max": "6",
        "step": "0.5",
        "x": 451,
        "y": 777,
        "wires": [
            [
                "c216385f.b7bea8"
            ]
        ]
    },
    {
        "id": "c216385f.b7bea8",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "home",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "adjust_s2",
                "type": "str"
            }
        ],
        "x": 643,
        "y": 777,
        "wires": [
            [
                "3976a9c5.383436"
            ],
            []
        ]
    },
    {
        "id": "d5d861a9.d7ae9",
        "type": "ui_slider",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Värmekurva S1",
        "tooltip": "",
        "group": "605e2041.0137e",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "",
        "min": "0",
        "max": "15",
        "step": "1",
        "x": 402,
        "y": 595,
        "wires": [
            [
                "2f31d75c.487a68"
            ]
        ]
    },
    {
        "id": "1870fc41.cbc664",
        "type": "nibe-request",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "heatcurve_s2",
        "x": 591,
        "y": 644,
        "wires": [
            [],
            [
                "350136be.28c46a"
            ]
        ]
    },
    {
        "id": "73df1de4.6aa284",
        "type": "nibe-output",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "heatcurve_s2",
        "x": 990,
        "y": 637,
        "wires": [
            []
        ]
    },
    {
        "id": "350136be.28c46a",
        "type": "ui_slider",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Värmekurva S2",
        "tooltip": "",
        "group": "ea24545a.5d7038",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "",
        "min": "0",
        "max": "15",
        "step": "1",
        "x": 780,
        "y": 644,
        "wires": [
            [
                "73df1de4.6aa284"
            ]
        ]
    },
    {
        "id": "a2146cd8.91aae",
        "type": "nibe-request",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "supply_s2",
        "x": 193,
        "y": 665,
        "wires": [
            [],
            [
                "6a959097.836b1"
            ]
        ]
    },
    {
        "id": "f6e7533e.8d656",
        "type": "exec",
        "z": "df0dd648.98daa8",
        "command": "sudo mount -o remount,ro /",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 414,
        "y": 105,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "c6de94c3.8844f8",
        "type": "inject",
        "z": "df0dd648.98daa8",
        "name": "Starta",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 141,
        "y": 105,
        "wires": [
            [
                "f6e7533e.8d656"
            ]
        ]
    },
    {
        "id": "191d7af8.9d5725",
        "type": "ui_switch",
        "z": "df0dd648.98daa8",
        "name": "",
        "label": "Aktivera",
        "tooltip": "",
        "group": "197ce413.27432c",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "weather/enable",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 333,
        "y": 462,
        "wires": [
            [
                "33987348.04de5c"
            ]
        ]
    },
    {
        "id": "aab00c37.39668",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "weather",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable_s2",
                "type": "str"
            }
        ],
        "x": 139,
        "y": 462,
        "wires": [
            [
                "191d7af8.9d5725"
            ],
            []
        ]
    },
    {
        "id": "d46527de.09f758",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Add Registers",
        "func": "var register = global.get('register');\nlet icons = {\n    \"\":\"fa-bars\",\n    \"°C\":\"fa-thermometer-three-quarters\",\n    \"A\":\"fa-flash\",\n    \"Hz\":\"fa-bar-chart\",\n    \"min\":\"fa-clock-o\",\n    \"h\":\"fa-clock-o\",\n    \"m\":\"fa-clock-o\",\n    \"kWh\":\"fa-area-chart\",\n    \"W\":\"fa-flash\",\n    \"l/m\":\"fa-leaf\",\n    \"%RH\":\"fa-cloud\",\n    \"%\":\"fa-percent\"\n}\nif(register===undefined) return;\nlet config = msg.payload;\nvar outRegister = [];\nvar remove = [];\nfor( var i = 0; i < register.length; i++){\n    outRegister[i] = {};\n    outRegister[i].title = register[i].register+\" (\"+register[i].mode+\") (\"+register[i].size+\"): \"+register[i].titel;\n    outRegister[i].description = register[i].info;\n    outRegister[i].register = register[i].register;\n    outRegister[i].mode = register[i].mode;\n    outRegister[i].unit = register[i].unit;\n    outRegister[i].icon_name = icons[register[i].unit];\n    for( var n = 0; n < config.registers.length; n++){\n        if(config.registers[n]===register[i].register) {\n            outRegister[i].isChecked = true;\n            let word = register[i].register+\": \"+register[i].titel;\n            remove.push({[word]:register[i].register});\n        }\n    }\n    if(register[i].register==\"45001\") outRegister[i].icon_name = \"fa-warning\";\n    if(register[i].register==\"10001\") outRegister[i].icon_name = \"fa-warning\";\n}\nif(outRegister!==undefined && outRegister!==[]) {\n    node.send({payload:outRegister});\n}\nif(remove!==undefined && remove!==[]) {\n    node.send([null,{options:remove}]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 500,
        "y": 1379,
        "wires": [
            [
                "bd1f8046.e4efe"
            ],
            [
                "a06c6ec7.72b5e"
            ]
        ]
    },
    {
        "id": "bd1f8046.e4efe",
        "type": "ui_list",
        "z": "b7f67da0.fbf1",
        "group": "4f8b35d1.5c8fec",
        "name": "Register",
        "order": 4,
        "width": "12",
        "height": "16",
        "lineType": "three",
        "actionType": "check",
        "allowHTML": false,
        "outputs": 1,
        "topic": "",
        "x": 676,
        "y": 1379,
        "wires": [
            [
                "3c0e48ab.ada8f8"
            ]
        ]
    },
    {
        "id": "3c0e48ab.ada8f8",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Add/Remove Registers",
        "func": "if(msg.payload.isChecked===true) {\n    node.send({topic:\"addRegister\",payload:msg.payload.register});\n} else if (msg.payload.isChecked===false) {\n    node.send({topic:\"removeRegister\",payload:msg.payload.register});\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 866,
        "y": 1379,
        "wires": [
            [
                "1b0cc4df.6a668b"
            ]
        ]
    },
    {
        "id": "1b0cc4df.6a668b",
        "type": "nibe-output",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "",
        "x": 1085,
        "y": 1379,
        "wires": [
            []
        ]
    },
    {
        "id": "c6cddead.51a4d",
        "type": "nibe-input",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 134,
        "y": 1379,
        "wires": [
            [
                "d46527de.09f758",
                "4249c2be.4caddc"
            ],
            []
        ]
    },
    {
        "id": "79bf305.f523ad",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Data",
        "func": "var data = global.get('data');\nlet icons = {\n    \"\":\"fa-bars\",\n    \"°C\":\"fa-thermometer-three-quarters\",\n    \"A\":\"fa-flash\",\n    \"Hz\":\"fa-bar-chart\",\n    \"min\":\"fa-clock-o\",\n    \"h\":\"fa-clock-o\",\n    \"m\":\"fa-clock-o\",\n    \"kWh\":\"fa-area-chart\",\n    \"W\":\"fa-flash\",\n    \"l/m\":\"fa-leaf\",\n    \"%RH\":\"fa-cloud\",\n    \"%\":\"fa-percent\"\n}\nvar config = msg.payload;\nif(config===undefined) return;\n\nlet time = Date.now();\nif(data===undefined) return;\nvar outRegister = [];\nfor( var n = 0; n < config.registers.length; n++){\n    for( var i = 0; i < data.length; i++){\n        if(config.registers[n]==data[i].register) {\n            outRegister[n] = {};\n            outRegister[n].title = `${data[i].register}, ${data[i].titel}`;\n            outRegister[n].description = `${data[i].data} ${data[i].unit}`;\n            outRegister[n].register = data[i].register;\n            outRegister[n].icon_name = icons[data[i].unit];\n            outRegister[n].isChecked = data[i].isChecked;\n            if(data[i].register==\"45001\") outRegister[n].icon_name = \"fa-warning\";\n            if(data[i].register==\"10001\") outRegister[n].icon_name = \"fa-warning\";\n        }\n    }\n    \n}\noutRegister.sort((a, b) => (a.register > b.register) ? 1 : -1)\nif(outRegister!==undefined && outRegister!==[]) {\n    node.send({payload:outRegister});\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 421,
        "y": 1624,
        "wires": [
            []
        ]
    },
    {
        "id": "7af5eaeb.53f964",
        "type": "inject",
        "z": "b7f67da0.fbf1",
        "name": "",
        "topic": "check",
        "payload": "",
        "payloadType": "date",
        "repeat": "5",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "x": 139,
        "y": 1624,
        "wires": [
            [
                "5e0de75.c411d18"
            ]
        ]
    },
    {
        "id": "353f9a08.a4fce6",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "var data = global.get('data');\nvar time = Date.now();\nif(data===undefined) return;\nif(msg.payload.isChecked!==undefined) {\n        let index = data.findIndex(n => n.register == msg.payload.register);\n    if(index!==-1) {\n        data[index].isChecked = msg.payload.isChecked;\n        global.set('data',data);\n    } else {\n        \n    }\n} else {\n    for( var i = 0; i < data.length; i++){\n        if(data[i].isChecked===true) {\n            if(data[i].raw_data>-3276) {\n                node.send({topic:data[i].titel,payload:data[i].raw_data,timestamp:time});\n            }\n        }\n    }\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 777,
        "y": 1680,
        "wires": [
            [
                "bdd50741.a958d8"
            ]
        ]
    },
    {
        "id": "7add9b61.438214",
        "type": "inject",
        "z": "b7f67da0.fbf1",
        "name": "",
        "topic": "check",
        "payload": "",
        "payloadType": "date",
        "repeat": "60",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "x": 580,
        "y": 1680,
        "wires": [
            [
                "353f9a08.a4fce6"
            ]
        ]
    },
    {
        "id": "bdd50741.a958d8",
        "type": "debug",
        "z": "b7f67da0.fbf1",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 1008,
        "y": 1722,
        "wires": []
    },
    {
        "id": "3d76f90c.3a1716",
        "type": "ui_template",
        "z": "b7f67da0.fbf1",
        "group": "4f8b35d1.5c8fec",
        "name": "Registerinfo",
        "order": 1,
        "width": "12",
        "height": "2",
        "format": "<div><p>Välj vilka register som ska hämtas från värmepumpen<br>\nRegister aktiverade med LOG.SET är förvalda och går ej ta bort.<br>\n</p></div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 672,
        "y": 1337,
        "wires": [
            []
        ]
    },
    {
        "id": "f7bb30d9.a8d72",
        "type": "ui_template",
        "z": "b7f67da0.fbf1",
        "group": "bd199d65.157fc",
        "name": "Datainfo",
        "order": 1,
        "width": "12",
        "height": "2",
        "format": "<div><p>Alla valda register visas här under, inkl. nuvarande värde.<br>\nFör att visa data i graf nedan, markera register.<br>\n</p></div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 536,
        "y": 1582,
        "wires": [
            []
        ]
    },
    {
        "id": "9489e9a0.cd1268",
        "type": "function",
        "z": "df0dd648.98daa8",
        "name": "Enable/Disable",
        "func": "msg = {\n    enabled:msg.payload\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 633,
        "y": 812,
        "wires": [
            [
                "3e9a73d2.df1c3c",
                "e0568cfa.ce37d",
                "c0ca403c.4cd65",
                "de90adfc.3a51d",
                "d9645915.c269b8"
            ]
        ]
    },
    {
        "id": "6905e0f5.dd875",
        "type": "trigger",
        "z": "c191a5d.5d76258",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "payl",
        "duration": "500",
        "extend": true,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 528,
        "y": 168,
        "wires": [
            []
        ]
    },
    {
        "id": "740712c9.2bd05c",
        "type": "function",
        "z": "df0dd648.98daa8",
        "name": "Enable/Disable",
        "func": "msg = {\n    enabled:msg.payload\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 633,
        "y": 868,
        "wires": [
            [
                "257d3e61.f15db2",
                "a1d2b301.cca65",
                "3aa1cf7c.e15ef"
            ]
        ]
    },
    {
        "id": "56ef8656.34a448",
        "type": "ui_switch",
        "z": "df0dd648.98daa8",
        "name": "Aktivera Prognoskorrigering",
        "label": "Aktivera Prognoskorrigering",
        "tooltip": "",
        "group": "33ed6fb8.2f3ce",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "forecast_adjust",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 218,
        "y": 980,
        "wires": [
            [
                "ff911f0f.b33a1"
            ]
        ]
    },
    {
        "id": "ff911f0f.b33a1",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "weather",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "forecast_adjust",
                "type": "str"
            }
        ],
        "x": 461,
        "y": 980,
        "wires": [
            [
                "56ef8656.34a448"
            ],
            []
        ]
    },
    {
        "id": "ed8eca.7d185138",
        "type": "ui_template",
        "z": "df0dd648.98daa8",
        "group": "33ed6fb8.2f3ce",
        "name": "Prognoskorrigering text",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<div>\n    Prognoskorrigering jämför nuvarande utomhustemperatur mot nuvarande prognostemperatur.\n    Samma avvikelse appliceras även på framtida prognostemperatur.\n    <br>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 316,
        "y": 924,
        "wires": [
            []
        ]
    },
    {
        "id": "6df21a09.04d1f4",
        "type": "ui_template",
        "z": "df0dd648.98daa8",
        "group": "d342c0ba.f2418",
        "name": "Solfaktor text",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<div>\n    Vid mycket solinstrålning så går det att ställa en solfaktor.\n    Värdet som valts läggs till på prognostemperaturen.\n    <br>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 161,
        "y": 588,
        "wires": [
            []
        ]
    },
    {
        "id": "31a20aae.3f8386",
        "type": "ui_template",
        "z": "df0dd648.98daa8",
        "group": "455ba55e.e91e8c",
        "name": "Vindfaktor text",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<div>\n    Om fastigheten är utsatt för mycket vind kan man ta med detta\n     i prognosen och kompensera med höjt börvärde. Justeringsfaktorn är ställbart från varje väderstreck.\n    <br>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 1039,
        "y": 693,
        "wires": [
            []
        ]
    },
    {
        "id": "560fbe9d.0f52c",
        "type": "ui_template",
        "z": "df0dd648.98daa8",
        "group": "7e910a08.c6c984",
        "name": "Prognosreglering text S1",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<div>\n    Prognosreglering för klimatsystem 1. Styr värmeproduktionen efter prognostemperatur istället.\n    Rekommenderas framför allt för golvvärme.\n    <br>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 565,
        "y": 175,
        "wires": [
            []
        ]
    },
    {
        "id": "654ec70b.5a5818",
        "type": "ui_template",
        "z": "df0dd648.98daa8",
        "group": "197ce413.27432c",
        "name": "Prognosreglering text S2",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<div>\n    Prognosreglering för klimatsystem 2. Styr värmeproduktionen efter prognostemperatur istället.\n    Rekommenderas framför allt för golvvärme.\n    <br>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 712,
        "y": 413,
        "wires": [
            []
        ]
    },
    {
        "id": "c65b6d8f.e1f51",
        "type": "ui_ui_control",
        "z": "df0dd648.98daa8",
        "name": "Disable Group S2",
        "events": "all",
        "x": 888,
        "y": 623,
        "wires": [
            []
        ]
    },
    {
        "id": "122b1739.bf0d69",
        "type": "ui_ui_control",
        "z": "b7f67da0.fbf1",
        "name": "",
        "events": "change",
        "x": 144,
        "y": 1428,
        "wires": [
            [
                "45726bd6.629654"
            ]
        ]
    },
    {
        "id": "45726bd6.629654",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Datahantering",
        "func": "if(msg.name==\"Datahantering\") {\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 311,
        "y": 1428,
        "wires": [
            [
                "4048162e.e23ad8"
            ]
        ]
    },
    {
        "id": "4048162e.e23ad8",
        "type": "delay",
        "z": "b7f67da0.fbf1",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 514,
        "y": 1428,
        "wires": [
            [
                "bd243274.ffbda"
            ]
        ]
    },
    {
        "id": "bd243274.ffbda",
        "type": "nibe-request",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 666,
        "y": 1428,
        "wires": [
            [],
            [
                "d46527de.09f758"
            ]
        ]
    },
    {
        "id": "7767041b.f6a2ac",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "New Inside sensors",
        "func": "let topic = msg.payload.topic;\nlet name = msg.payload.name;\nlet mqtt = msg.payload.mqtt;\n\nlet config = msg.config;\nif(config.home.inside_sensors===undefined) config.home.inside_sensors = [];\nif(name!==\"\") {\n    let newSensor = true;\n    for (const arr of config.home.inside_sensors) {\n        if(arr.register!==undefined && arr.register===topic) {\n            newSensor = false;\n            node.error('Inomhusgivare',{topic:\"Inomhusgivare\",payload:\"Givare finns redan\"})\n        }\n    }\n    if(newSensor===true) {\n        let source = \"nibe\";\n        if(mqtt===true) {\n            source = \"mqtt\";\n        }\n        config.home.inside_sensors.push({name:name,register:topic,source:source});\n        node.send({topic:\"addSensor\",payload:config});\n    }\n    \n}",
        "outputs": 1,
        "noerr": 0,
        "x": 741,
        "y": 1820,
        "wires": [
            [
                "af5403b7.bf541"
            ]
        ]
    },
    {
        "id": "fc464c80.f957e",
        "type": "debug",
        "z": "b7f67da0.fbf1",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1086,
        "y": 2051,
        "wires": []
    },
    {
        "id": "e20b901b.2d06d",
        "type": "nibe-request",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 519,
        "y": 1820,
        "wires": [
            [
                "7767041b.f6a2ac"
            ],
            []
        ]
    },
    {
        "id": "130a1b17.cc1ea5",
        "type": "ui_form",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Lägg till givare",
        "group": "fb207b28.da59b8",
        "order": 2,
        "width": 0,
        "height": 0,
        "options": [
            {
                "label": "MQTT",
                "value": "mqtt",
                "type": "checkbox",
                "required": false
            },
            {
                "label": "Namn",
                "value": "name",
                "type": "text",
                "required": true
            },
            {
                "label": "Register / Topic",
                "value": "topic",
                "type": "text",
                "required": true
            }
        ],
        "formValue": {
            "mqtt": false,
            "name": "",
            "topic": ""
        },
        "payload": "",
        "submit": "Lägg till",
        "cancel": "Avbryt",
        "topic": "",
        "x": 308,
        "y": 1820,
        "wires": [
            [
                "e20b901b.2d06d"
            ]
        ]
    },
    {
        "id": "1ce07a10.589406",
        "type": "ui_dropdown",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Ta bort",
        "tooltip": "",
        "place": "Välj",
        "group": "fb207b28.da59b8",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "options": [
            {
                "label": "",
                "value": "",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "removeSensor",
        "x": 974,
        "y": 1883,
        "wires": [
            [
                "fc464c80.f957e",
                "af5403b7.bf541"
            ]
        ]
    },
    {
        "id": "e9b65b68.0cdfb8",
        "type": "nibe-input",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 533,
        "y": 1883,
        "wires": [
            [
                "2498c1b9.89a73e"
            ],
            []
        ]
    },
    {
        "id": "2498c1b9.89a73e",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "var sensors = msg.payload.home.inside_sensors||[];\nvar output = [];\nif(sensors.length!==0) {\n    for (const arr of sensors) {\n        output.push({[arr.name]:arr})\n    }\n}\nif(output!==undefined) {\n    node.send({options:output});\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 854,
        "y": 1883,
        "wires": [
            [
                "1ce07a10.589406"
            ]
        ]
    },
    {
        "id": "af5403b7.bf541",
        "type": "nibe-output",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "",
        "x": 1155,
        "y": 1827,
        "wires": [
            []
        ]
    },
    {
        "id": "aa92aa28.ba94f8",
        "type": "catch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "scope": [
            "7767041b.f6a2ac"
        ],
        "uncaught": false,
        "x": 610,
        "y": 1953,
        "wires": [
            [
                "70afba29.2d0e34"
            ]
        ]
    },
    {
        "id": "70afba29.2d0e34",
        "type": "ui_toast",
        "z": "b7f67da0.fbf1",
        "position": "bottom right",
        "displayTime": "5",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "topic": "",
        "name": "",
        "x": 874,
        "y": 1953,
        "wires": []
    },
    {
        "id": "88479ffd.f321c",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "let config = msg.config;\nif(config.home.inside_sensors!==undefined) {\n    let i = config.home.inside_sensors.findIndex(i => i.register == msg.payload.register);\n    if(i!==-1) {\n        config.home.inside_sensors.splice(i,1);\n        node.send({topic:\"setConfig\",payload:config});\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1240,
        "y": 1946,
        "wires": [
            []
        ]
    },
    {
        "id": "fbe205f1.95af88",
        "type": "nibe-request",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 1100,
        "y": 1981,
        "wires": [
            [
                "88479ffd.f321c"
            ],
            []
        ]
    },
    {
        "id": "112e4ce5.d4a8c3",
        "type": "ui_dropdown",
        "z": "df0dd648.98daa8",
        "name": "",
        "label": "Välj Inomhusgivare",
        "tooltip": "",
        "place": "Välj",
        "group": "33ed6fb8.2f3ce",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "options": [
            {
                "label": "",
                "value": "",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "weather/sensor",
        "x": 573,
        "y": 371,
        "wires": [
            [
                "c1f92f58.722e9"
            ]
        ]
    },
    {
        "id": "10e30751.e4e639",
        "type": "function",
        "z": "df0dd648.98daa8",
        "name": "",
        "func": "var sensors = msg.payload.home.inside_sensors||[];\nvar output = [\"Ingen\"];\nfor (const arr of sensors) {\n    output.push(arr.name)\n}\nif(output!==undefined && output!==[]) {\n    node.send({options:output});\n    node.send({payload:msg.payload.weather.sensor_s1})\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 406,
        "y": 371,
        "wires": [
            [
                "112e4ce5.d4a8c3"
            ]
        ]
    },
    {
        "id": "334236ca.6e53ba",
        "type": "nibe-input",
        "z": "df0dd648.98daa8",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 85,
        "y": 371,
        "wires": [
            [
                "10e30751.e4e639"
            ],
            []
        ]
    },
    {
        "id": "e9a893c0.59865",
        "type": "ui_ui_control",
        "z": "b7f67da0.fbf1",
        "name": "",
        "events": "change",
        "x": 214,
        "y": 2016,
        "wires": [
            [
                "a22ff0ff.aa4fa"
            ]
        ]
    },
    {
        "id": "a22ff0ff.aa4fa",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Inställningar",
        "func": "if(msg.name==\"Inställningar\") {\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 371,
        "y": 2016,
        "wires": [
            [
                "f7fce578.ff4a68"
            ]
        ]
    },
    {
        "id": "f7fce578.ff4a68",
        "type": "delay",
        "z": "b7f67da0.fbf1",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 584,
        "y": 2016,
        "wires": [
            [
                "e021eb6c.058688"
            ]
        ]
    },
    {
        "id": "e021eb6c.058688",
        "type": "nibe-request",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 736,
        "y": 2016,
        "wires": [
            [],
            [
                "2498c1b9.89a73e"
            ]
        ]
    },
    {
        "id": "72520bf5.692d14",
        "type": "nibe-input",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 127,
        "y": 427,
        "wires": [
            [
                "dff05253.9f618"
            ],
            []
        ]
    },
    {
        "id": "dff05253.9f618",
        "type": "function",
        "z": "358baec9.c8b902",
        "name": "",
        "func": "var sensors = msg.payload.home.inside_sensors||[];\nvar output = [\"Ingen\"];\nfor (const arr of sensors) {\n    output.push(arr.name)\n}\nif(output!==undefined && output!==[]) {\n    node.send({options:output});\n    if(msg.payload.indoor!==undefined) {\n        node.send({payload:msg.payload.indoor.sensor_s1})\n    }\n    \n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 421,
        "y": 427,
        "wires": [
            [
                "f421e95f.a41718"
            ]
        ]
    },
    {
        "id": "f421e95f.a41718",
        "type": "ui_dropdown",
        "z": "358baec9.c8b902",
        "name": "",
        "label": "Välj Inomhusgivare",
        "tooltip": "",
        "place": "Välj",
        "group": "a2cfe148.70708",
        "order": 8,
        "width": "0",
        "height": "0",
        "passthru": false,
        "options": [
            {
                "label": "",
                "value": "",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "indoor/sensor",
        "x": 629,
        "y": 427,
        "wires": [
            [
                "fdd4d594.2498b8"
            ]
        ]
    },
    {
        "id": "fdd4d594.2498b8",
        "type": "nibe-indoor",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "adjust": "0.5",
        "x": 857,
        "y": 378,
        "wires": [
            [
                "7c62f68b.7e53a8"
            ],
            [
                "96122fbe.f0ca2"
            ]
        ]
    },
    {
        "id": "d68a22ce.9289d",
        "type": "ui_button",
        "z": "358baec9.c8b902",
        "name": "Uppdatera S1",
        "group": "a2cfe148.70708",
        "order": 11,
        "width": "12",
        "height": "1",
        "passthru": false,
        "label": "Uppdatera",
        "tooltip": "Begär ny data och uppdatera grafen med nya värden.",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "update",
        "x": 633,
        "y": 364,
        "wires": [
            [
                "fdd4d594.2498b8"
            ]
        ]
    },
    {
        "id": "c0a999e9.8d63b8",
        "type": "ui_switch",
        "z": "358baec9.c8b902",
        "name": "Aktivera Gradminut återställning",
        "label": "Gradminut återställning",
        "tooltip": "",
        "group": "95b0af9c.89089",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "dm_reset_enable",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 256,
        "y": 1393,
        "wires": [
            [
                "c3b3d118.e4f23"
            ]
        ]
    },
    {
        "id": "c3b3d118.e4f23",
        "type": "subflow:c191a5d.5d76258",
        "z": "358baec9.c8b902",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "indoor",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "dm_reset_enable",
                "type": "str"
            }
        ],
        "x": 517,
        "y": 1393,
        "wires": [
            [
                "c0a999e9.8d63b8",
                "bb501ea0.7f712"
            ],
            []
        ]
    },
    {
        "id": "5e1062d0.a33cbc",
        "type": "ui_text",
        "z": "358baec9.c8b902",
        "group": "a2cfe148.70708",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Inomhustemperatur",
        "format": "{{msg.payload}} ºC",
        "layout": "row-spread",
        "x": 1189,
        "y": 98,
        "wires": []
    },
    {
        "id": "7c62f68b.7e53a8",
        "type": "switch",
        "z": "358baec9.c8b902",
        "name": "Data",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Inomhustemperatur",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Utomhustemperatur",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Gradminuter",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Tid",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Avvikelse",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Kurvjustering",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 1058,
        "y": 371,
        "wires": [
            [
                "5e1062d0.a33cbc"
            ],
            [
                "61436d60.0601e4"
            ],
            [
                "5f8c6837.106e18"
            ],
            [],
            [
                "cf0c0b96.d635f8"
            ],
            [
                "c475b1a1.ae577"
            ]
        ]
    },
    {
        "id": "61436d60.0601e4",
        "type": "ui_text",
        "z": "358baec9.c8b902",
        "group": "70965431.b26cbc",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Utomhustemperatur",
        "format": "{{msg.payload}} ºC",
        "layout": "row-spread",
        "x": 1157,
        "y": 756,
        "wires": []
    },
    {
        "id": "5f8c6837.106e18",
        "type": "ui_text",
        "z": "358baec9.c8b902",
        "group": "70965431.b26cbc",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "Gradminuter",
        "label": "Gradminuter",
        "format": "{{msg.payload}} ºM",
        "layout": "row-spread",
        "x": 1127,
        "y": 714,
        "wires": []
    },
    {
        "id": "9f4e48ae.0cdd88",
        "type": "ui_template",
        "z": "358baec9.c8b902",
        "group": "95b0af9c.89089",
        "name": "Gradminut info",
        "order": 2,
        "width": 0,
        "height": 0,
        "format": "När inomhusbörvärdet är uppnått så återställs gradminuter till startvärdet<br><br>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 1137,
        "y": 581,
        "wires": [
            []
        ]
    },
    {
        "id": "67e507d8.25dac8",
        "type": "nibe-request",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "inside_enable_s1",
        "x": 433,
        "y": 133,
        "wires": [
            [
                "d23336a5.00c4a8"
            ],
            [
                "8df4a3c.164c26"
            ]
        ]
    },
    {
        "id": "e1739c13.ca664",
        "type": "ui_template",
        "z": "358baec9.c8b902",
        "group": "a2cfe148.70708",
        "name": "Välj Inomhusgivare info",
        "order": 7,
        "width": 0,
        "height": 0,
        "format": "Välj en temperaturgivare som ska användas i grafen och för ekvationen.<br><br>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 327,
        "y": 364,
        "wires": [
            []
        ]
    },
    {
        "id": "8ebe60ad.11b1d",
        "type": "ui_text",
        "z": "358baec9.c8b902",
        "group": "70965431.b26cbc",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Senast uppdaterad",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1266,
        "y": 798,
        "wires": []
    },
    {
        "id": "e78514aa.0d9f28",
        "type": "function",
        "z": "358baec9.c8b902",
        "name": "",
        "func": "msg.payload = getFormattedDate(msg.raw.timestamp);\nreturn msg;\nfunction getFormattedDate() {\n    var date = new Date();\n\n    var month = date.getMonth() + 1;\n    var day = date.getDate();\n    var hour = date.getHours();\n    var min = date.getMinutes();\n    var sec = date.getSeconds();\n\n    month = (month < 10 ? \"0\" : \"\") + month;\n    day = (day < 10 ? \"0\" : \"\") + day;\n    hour = (hour < 10 ? \"0\" : \"\") + hour;\n    min = (min < 10 ? \"0\" : \"\") + min;\n    sec = (sec < 10 ? \"0\" : \"\") + sec;\n\n    var str = hour + \":\" + min + \":\" + sec;\n\n    /*alert(str);*/\n\n    return str;\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 1093,
        "y": 798,
        "wires": [
            [
                "8ebe60ad.11b1d"
            ]
        ]
    },
    {
        "id": "5725972f.b219a8",
        "type": "ui_text",
        "z": "358baec9.c8b902",
        "group": "a2cfe148.70708",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "Avvikelse",
        "label": "Avvikelse",
        "format": "{{msg.payload}} %",
        "layout": "row-spread",
        "x": 1306,
        "y": 182,
        "wires": []
    },
    {
        "id": "cf0c0b96.d635f8",
        "type": "range",
        "z": "358baec9.c8b902",
        "minin": "1",
        "maxin": "2",
        "minout": "0",
        "maxout": "100",
        "action": "scale",
        "round": true,
        "property": "payload",
        "name": "",
        "x": 1145,
        "y": 182,
        "wires": [
            [
                "5725972f.b219a8"
            ]
        ]
    },
    {
        "id": "c475b1a1.ae577",
        "type": "ui_text",
        "z": "358baec9.c8b902",
        "group": "a2cfe148.70708",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "Kurvjustering",
        "label": "{{msg.topic}}",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1204,
        "y": 140,
        "wires": []
    },
    {
        "id": "8dd4be0a.86e46",
        "type": "nibe-price",
        "z": "960078e.e3e6d88",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "adjust": "0",
        "x": 629,
        "y": 175,
        "wires": [
            [
                "63612ac7.366764",
                "9179d381.0be36",
                "91d8769c.f63f68"
            ],
            [
                "63612ac7.366764"
            ]
        ]
    },
    {
        "id": "3925bdab.14e9a2",
        "type": "ui_switch",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "NibePis Elprisreglering",
        "tooltip": "",
        "group": "f481a5f0.f9f1c8",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "price/enable",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 352,
        "y": 910,
        "wires": [
            [
                "321fde4.84f6d22",
                "aa3b6866.eabab8",
                "8dd4be0a.86e46"
            ]
        ]
    },
    {
        "id": "eafa7076.636ee",
        "type": "ui_dropdown",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Väldigt högt pris",
        "tooltip": "Varmvattenproduktion vid väldigt högt pris",
        "place": "Välj",
        "group": "2e9c7d75.ee6312",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "options": [
            {
                "label": "Ekonomi (0)",
                "value": "0",
                "type": "str"
            },
            {
                "label": "Normal (1)",
                "value": "1",
                "type": "str"
            },
            {
                "label": "Lyx (2)",
                "value": "2",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "hotwater_very_expensive",
        "x": 822,
        "y": 1099,
        "wires": [
            [
                "40e36211.562a3c"
            ]
        ]
    },
    {
        "id": "4a4b467b.cb3d98",
        "type": "ui_dropdown",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Normalt pris",
        "tooltip": "Varmvattenproduktion vid normalt pris",
        "place": "Välj",
        "group": "2e9c7d75.ee6312",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "options": [
            {
                "label": "Ekonomi (0)",
                "value": "0",
                "type": "str"
            },
            {
                "label": "Normal (1)",
                "value": "1",
                "type": "str"
            },
            {
                "label": "Lyx (2)",
                "value": "2",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "hotwater_normal",
        "x": 812,
        "y": 1190,
        "wires": [
            [
                "58a6446.c8ceebc"
            ]
        ]
    },
    {
        "id": "64b8af88.aedae",
        "type": "ui_dropdown",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Lågt pris",
        "tooltip": "Varmvattenproduktion vid lågt pris",
        "place": "Välj",
        "group": "2e9c7d75.ee6312",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "options": [
            {
                "label": "Ekonomi (0)",
                "value": "0",
                "type": "str"
            },
            {
                "label": "Normal (1)",
                "value": "1",
                "type": "str"
            },
            {
                "label": "Lyx (2)",
                "value": "2",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "hotwater_cheap",
        "x": 802,
        "y": 1239,
        "wires": [
            [
                "5ea44899.ef5278"
            ]
        ]
    },
    {
        "id": "3b93422b.85e62e",
        "type": "ui_dropdown",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Väldigt lågt pris",
        "tooltip": "Varmvattenproduktion vid väldigtlågt pris",
        "place": "Välj",
        "group": "2e9c7d75.ee6312",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "options": [
            {
                "label": "Ekonomi (0)",
                "value": "0",
                "type": "str"
            },
            {
                "label": "Normal (1)",
                "value": "1",
                "type": "str"
            },
            {
                "label": "Lyx (2)",
                "value": "2",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "hotwater_very_cheap",
        "x": 822,
        "y": 1288,
        "wires": [
            [
                "57585f07.0f133"
            ]
        ]
    },
    {
        "id": "e0b7517f.586f3",
        "type": "ui_switch",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Varmvattenreglering",
        "tooltip": "Vill du att varmvattnet ska reglera sig efter elpriset enligt nedan",
        "group": "2e9c7d75.ee6312",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "hotwater_enable",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 824,
        "y": 1393,
        "wires": [
            [
                "d67cd90b.4e8bd8"
            ]
        ]
    },
    {
        "id": "b18004d5.977448",
        "type": "ui_text_input",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Tibber Token",
        "tooltip": "",
        "group": "f481a5f0.f9f1c8",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "token",
        "x": 987,
        "y": 791,
        "wires": [
            [
                "73a31dd2.de8774"
            ]
        ]
    },
    {
        "id": "9179d381.0be36",
        "type": "ui_chart",
        "z": "960078e.e3e6d88",
        "name": "Elprisreglering S1",
        "group": "90803197.41c34",
        "order": 2,
        "width": 0,
        "height": 0,
        "label": "",
        "chartType": "line",
        "legend": "true",
        "xformat": "dd HH:mm",
        "interpolate": "step",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "48",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 916,
        "y": 49,
        "wires": [
            []
        ]
    },
    {
        "id": "8af5cb53.d25198",
        "type": "ui_ui_control",
        "z": "960078e.e3e6d88",
        "name": "",
        "events": "all",
        "x": 193,
        "y": 847,
        "wires": [
            [
                "912b5ed8.d07cf"
            ]
        ]
    },
    {
        "id": "912b5ed8.d07cf",
        "type": "function",
        "z": "960078e.e3e6d88",
        "name": "Elprisreglering",
        "func": "var timeSaved = context.get('time')||(Date.now()-1000);\nvar time = Date.now();\nif(msg.name==\"Elprisreglering\") {\n    if(time>timeSaved) {\n        context.set('time',(time+60000));\n        return msg;\n    }\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 353,
        "y": 847,
        "wires": [
            [
                "1e4f140c.04c97c",
                "419d4955.0dded8",
                "749fe356.3ce75c"
            ]
        ]
    },
    {
        "id": "1e4f140c.04c97c",
        "type": "nibe-request",
        "z": "960078e.e3e6d88",
        "server": "844659a2.8d8508",
        "name": "price_enable",
        "x": 546,
        "y": 847,
        "wires": [
            [],
            [
                "54bb4384.e1936c",
                "9ff28997.48cac8",
                "d383b3f8.c2437"
            ]
        ]
    },
    {
        "id": "54bb4384.e1936c",
        "type": "ui_switch",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Nibes Elprisreglering",
        "tooltip": "",
        "group": "f481a5f0.f9f1c8",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "30",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "10",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 758,
        "y": 847,
        "wires": [
            []
        ]
    },
    {
        "id": "d54ff528.d710e8",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable",
                "type": "str"
            }
        ],
        "x": 111,
        "y": 910,
        "wires": [
            [
                "3925bdab.14e9a2"
            ],
            [
                "217bd6b8.16c73a"
            ]
        ]
    },
    {
        "id": "2ec7e694.30d2ea",
        "type": "ui_dropdown",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Datakälla",
        "tooltip": "Välj vart elprisuppgifter ska hämtas från",
        "place": "Välj datakälla",
        "group": "f481a5f0.f9f1c8",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "options": [],
        "payload": "",
        "topic": "source",
        "x": 228,
        "y": 1015,
        "wires": [
            [
                "f6c2eadb.af1c28"
            ]
        ]
    },
    {
        "id": "f6c2eadb.af1c28",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "source",
                "type": "str"
            }
        ],
        "x": 391,
        "y": 1057,
        "wires": [
            [
                "2ec7e694.30d2ea"
            ],
            [
                "dc3a27b1.8a8ef8"
            ]
        ]
    },
    {
        "id": "4d63b4e4.90710c",
        "type": "ui_button",
        "z": "960078e.e3e6d88",
        "name": "Uppdatera S1",
        "group": "90803197.41c34",
        "order": 3,
        "width": 12,
        "height": 1,
        "passthru": false,
        "label": "Uppdatera",
        "tooltip": "Begär ny data och uppdatera med nya värden.",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "update",
        "x": 367,
        "y": 56,
        "wires": [
            [
                "8dd4be0a.86e46"
            ]
        ]
    },
    {
        "id": "68d91eb2.2d481",
        "type": "ui_switch",
        "z": "960078e.e3e6d88",
        "name": "Aktivera S1",
        "label": "Aktivera",
        "tooltip": "",
        "group": "1b40f24f.7b6d9e",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "price/enable_heat",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 322,
        "y": 98,
        "wires": [
            [
                "8dd4be0a.86e46"
            ]
        ]
    },
    {
        "id": "12912295.62786d",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable_heat_s1",
                "type": "str"
            }
        ],
        "x": 132,
        "y": 70,
        "wires": [
            [
                "68d91eb2.2d481"
            ],
            []
        ]
    },
    {
        "id": "254cff77.34a55",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable_heat_s2",
                "type": "str"
            }
        ],
        "x": 111,
        "y": 777,
        "wires": [
            [
                "4849d6b9.2a3868"
            ],
            []
        ]
    },
    {
        "id": "4849d6b9.2a3868",
        "type": "ui_switch",
        "z": "960078e.e3e6d88",
        "name": "Aktivera S2",
        "label": "Aktivera",
        "tooltip": "",
        "group": "94305680.d32c48",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "price/enable_heat",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 301,
        "y": 777,
        "wires": [
            [
                "aa3b6866.eabab8"
            ]
        ]
    },
    {
        "id": "360796e8.919dfa",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "token",
                "type": "str"
            }
        ],
        "x": 1336,
        "y": 791,
        "wires": [
            [
                "5a685251.39ba2c"
            ],
            []
        ]
    },
    {
        "id": "aa3b6866.eabab8",
        "type": "nibe-price",
        "z": "960078e.e3e6d88",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s2",
        "adjust": "0",
        "x": 601,
        "y": 756,
        "wires": [
            [
                "ef64204.7fdb6e",
                "92d4347e.266668"
            ],
            []
        ]
    },
    {
        "id": "44279d43.2995f4",
        "type": "ui_form",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Skicka värde",
        "group": "bd199d65.157fc",
        "order": 4,
        "width": 0,
        "height": 0,
        "options": [
            {
                "label": "Register",
                "value": "register",
                "type": "number",
                "required": true
            },
            {
                "label": "Värde",
                "value": "value",
                "type": "number",
                "required": true
            }
        ],
        "formValue": {
            "register": "",
            "value": ""
        },
        "payload": "",
        "submit": "Skicka",
        "cancel": "",
        "topic": "",
        "x": 335,
        "y": 1533,
        "wires": [
            [
                "2effd06.0f5ca3"
            ]
        ]
    },
    {
        "id": "4539bf17.179d5",
        "type": "nibe-output",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "",
        "x": 742,
        "y": 1533,
        "wires": [
            [
                "5e0de75.c411d18"
            ]
        ]
    },
    {
        "id": "2effd06.0f5ca3",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "msg.topic = msg.payload.register;\nmsg.payload = msg.payload.value;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 526,
        "y": 1533,
        "wires": [
            [
                "4539bf17.179d5"
            ]
        ]
    },
    {
        "id": "5a685251.39ba2c",
        "type": "function",
        "z": "960078e.e3e6d88",
        "name": "Hide token",
        "func": "if(msg.payload!==\"\" && msg.payload!==undefined) {\n    msg.payload = \"Token inlagd\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 819,
        "y": 791,
        "wires": [
            [
                "b18004d5.977448"
            ]
        ]
    },
    {
        "id": "73a31dd2.de8774",
        "type": "switch",
        "z": "960078e.e3e6d88",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "Token inlagd",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1162,
        "y": 791,
        "wires": [
            [
                "360796e8.919dfa"
            ]
        ]
    },
    {
        "id": "63612ac7.366764",
        "type": "debug",
        "z": "960078e.e3e6d88",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 882,
        "y": 105,
        "wires": []
    },
    {
        "id": "40e36211.562a3c",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "hotwater_very_expensive",
                "type": "str"
            }
        ],
        "x": 1035,
        "y": 1099,
        "wires": [
            [
                "eafa7076.636ee"
            ],
            []
        ]
    },
    {
        "id": "9e47d1c5.a1f6a",
        "type": "ui_dropdown",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Högt pris",
        "tooltip": "Varmvattenproduktion vid högt pris",
        "place": "Välj",
        "group": "2e9c7d75.ee6312",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "options": [
            {
                "label": "Ekonomi (0)",
                "value": "0",
                "type": "str"
            },
            {
                "label": "Normal (1)",
                "value": "1",
                "type": "str"
            },
            {
                "label": "Lyx (2)",
                "value": "2",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "hotwater_expensive",
        "x": 802,
        "y": 1141,
        "wires": [
            [
                "21d246a8.2de9aa"
            ]
        ]
    },
    {
        "id": "21d246a8.2de9aa",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "hotwater_expensive",
                "type": "str"
            }
        ],
        "x": 986,
        "y": 1141,
        "wires": [
            [
                "9e47d1c5.a1f6a"
            ],
            []
        ]
    },
    {
        "id": "58a6446.c8ceebc",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "hotwater_normal",
                "type": "str"
            }
        ],
        "x": 1007,
        "y": 1190,
        "wires": [
            [
                "4a4b467b.cb3d98"
            ],
            []
        ]
    },
    {
        "id": "5ea44899.ef5278",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "hotwater_cheap",
                "type": "str"
            }
        ],
        "x": 1007,
        "y": 1239,
        "wires": [
            [
                "64b8af88.aedae"
            ],
            []
        ]
    },
    {
        "id": "57585f07.0f133",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "hotwater_very_cheap",
                "type": "str"
            }
        ],
        "x": 1021,
        "y": 1288,
        "wires": [
            [
                "3b93422b.85e62e"
            ],
            []
        ]
    },
    {
        "id": "d67cd90b.4e8bd8",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "hotwater_enable",
                "type": "str"
            }
        ],
        "x": 1042,
        "y": 1393,
        "wires": [
            [
                "e0b7517f.586f3"
            ],
            []
        ]
    },
    {
        "id": "40c00df0.72a6e4",
        "type": "ui_slider",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Högt pris",
        "tooltip": "Hur mycket ska kurvjusteringen vara när det är högt pris?",
        "group": "1b40f24f.7b6d9e",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "price/heat_expensive",
        "min": "-10",
        "max": "0",
        "step": 1,
        "x": 312,
        "y": 203,
        "wires": [
            [
                "8dd4be0a.86e46"
            ]
        ]
    },
    {
        "id": "b30b63c9.c96a9",
        "type": "ui_slider",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Lågt pris",
        "tooltip": "Hur mycket ska kurvjusteringen vara när det är lågt pris?",
        "group": "1b40f24f.7b6d9e",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "price/heat_cheap",
        "min": "0",
        "max": 10,
        "step": 1,
        "x": 312,
        "y": 252,
        "wires": [
            [
                "8dd4be0a.86e46"
            ]
        ]
    },
    {
        "id": "b3a09f2.d70226",
        "type": "ui_slider",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Väldigt lågt pris",
        "tooltip": "Hur mycket ska kurvjusteringen vara när det är väldigt lågt pris?",
        "group": "1b40f24f.7b6d9e",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "price/heat_very_cheap",
        "min": "0",
        "max": 10,
        "step": 1,
        "x": 332,
        "y": 301,
        "wires": [
            [
                "8dd4be0a.86e46"
            ]
        ]
    },
    {
        "id": "1e82db4e.4957f5",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "heat_expensive_s1",
                "type": "str"
            }
        ],
        "x": 132,
        "y": 203,
        "wires": [
            [
                "40c00df0.72a6e4"
            ],
            []
        ]
    },
    {
        "id": "c30269ad.b26128",
        "type": "ui_slider",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Väldigt högt pris",
        "tooltip": "Hur mycket ska kurvjusteringen vara när det är väldigt högt pris?",
        "group": "1b40f24f.7b6d9e",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "price/heat_very_expensive",
        "min": "-10",
        "max": "0",
        "step": 1,
        "x": 332,
        "y": 154,
        "wires": [
            [
                "8dd4be0a.86e46"
            ]
        ]
    },
    {
        "id": "a44c9b0.7de6a68",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "heat_very_expensive_s1",
                "type": "str"
            }
        ],
        "x": 132,
        "y": 154,
        "wires": [
            [
                "c30269ad.b26128"
            ],
            []
        ]
    },
    {
        "id": "59781121.2432f",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "heat_cheap_s1",
                "type": "str"
            }
        ],
        "x": 132,
        "y": 252,
        "wires": [
            [
                "b30b63c9.c96a9"
            ],
            []
        ]
    },
    {
        "id": "2691b2ec.33f61e",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "heat_very_cheap_s1",
                "type": "str"
            }
        ],
        "x": 132,
        "y": 301,
        "wires": [
            [
                "b3a09f2.d70226"
            ],
            []
        ]
    },
    {
        "id": "523b61b1.02fb1",
        "type": "ui_text",
        "z": "960078e.e3e6d88",
        "group": "e6946a7.5e1e698",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Nuvarande Elpris",
        "format": "{{msg.payload}} öre",
        "layout": "row-spread",
        "x": 1028,
        "y": 161,
        "wires": []
    },
    {
        "id": "800a0005.55ffc",
        "type": "ui_text",
        "z": "960078e.e3e6d88",
        "group": "e6946a7.5e1e698",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Nuvarande Elprisnivå",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1038,
        "y": 203,
        "wires": []
    },
    {
        "id": "91d8769c.f63f68",
        "type": "function",
        "z": "960078e.e3e6d88",
        "name": "",
        "func": "let level = {\n    UNKNOWN: \"Okänt\",\n    VERY_CHEAP: \"Väldigt lågt pris\",\n    CHEAP: \"Lågt pris\",\n    NORMAL:\"Normalt pris\",\n    EXPENSIVE: \"Högt pris\",\n    VERY_EXPENSIVE: \"Väldigt högt pris\"\n}\nif(msg.topic==\"Nuvarande Elpris\") {\n    node.send([{payload:msg.payload}])\n} else if(msg.topic==\"Nuvarande Elprisnivå\") {\n    node.send([null,{payload:level[msg.payload]}])\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 848,
        "y": 175,
        "wires": [
            [
                "523b61b1.02fb1"
            ],
            [
                "800a0005.55ffc"
            ]
        ]
    },
    {
        "id": "dc3a27b1.8a8ef8",
        "type": "function",
        "z": "960078e.e3e6d88",
        "name": "Enable/Disable Source",
        "func": "let source = msg.payload.price.source;\nif(source==\"tibber\") {\n    msg = {\n    enabled:true\n};\nreturn msg;\n} else if(source==\"nibe\") {\n    msg = {\n    enabled:false\n};\nreturn msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 569,
        "y": 1001,
        "wires": [
            [
                "eafa7076.636ee",
                "3b93422b.85e62e",
                "c30269ad.b26128",
                "b3a09f2.d70226",
                "b18004d5.977448",
                "d07cb165.8756a",
                "b0a104eb.836b28"
            ]
        ]
    },
    {
        "id": "a38b1ef.5259be",
        "type": "trigger",
        "z": "c191a5d.5d76258",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "payl",
        "duration": "500",
        "extend": true,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 528,
        "y": 210,
        "wires": [
            []
        ]
    },
    {
        "id": "ef64204.7fdb6e",
        "type": "function",
        "z": "960078e.e3e6d88",
        "name": "Enable/Disable",
        "func": "if(msg.enabled!==undefined) {\n    let hide = {\n        \"group\":\n            {\"hide\":\n                [\"Elprisreglering_Graf_S2\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n} else {\n    let hide = {\n        \"group\":\n            {\"show\":\n                [\"Elprisreglering_Graf_S2\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 822,
        "y": 728,
        "wires": [
            [],
            [
                "a2a91bd1.6ad658"
            ]
        ]
    },
    {
        "id": "a2a91bd1.6ad658",
        "type": "ui_ui_control",
        "z": "960078e.e3e6d88",
        "name": "Disable Group S2",
        "events": "all",
        "x": 1035,
        "y": 728,
        "wires": [
            []
        ]
    },
    {
        "id": "217bd6b8.16c73a",
        "type": "function",
        "z": "960078e.e3e6d88",
        "name": "Enable/Disable NibePi",
        "func": "let source = msg.payload.price.enable;\nif(source===true) {\n    msg = {\n    enabled:true\n};\nreturn msg;\n} else if(source===false) {\n    msg = {\n    enabled:false\n};\n\nreturn msg;\n}\n",
        "outputs": 2,
        "noerr": 0,
        "x": 1052,
        "y": 567,
        "wires": [
            [
                "eafa7076.636ee",
                "9e47d1c5.a1f6a",
                "4a4b467b.cb3d98",
                "64b8af88.aedae",
                "3b93422b.85e62e",
                "e0b7517f.586f3",
                "2ec7e694.30d2ea",
                "b18004d5.977448",
                "4849d6b9.2a3868",
                "b30b63c9.c96a9",
                "40c00df0.72a6e4",
                "c30269ad.b26128",
                "68d91eb2.2d481",
                "d07cb165.8756a",
                "1bb82fc2.e8b78",
                "de834f9d.9b477",
                "b0a104eb.836b28",
                "b3a09f2.d70226"
            ],
            [
                "8dd4be0a.86e46",
                "aa3b6866.eabab8"
            ]
        ]
    },
    {
        "id": "1bb82fc2.e8b78",
        "type": "ui_slider",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Högt pris",
        "tooltip": "Hur mycket ska kurvjusteringen vara när det är högt pris?",
        "group": "94305680.d32c48",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "price/heat_expensive",
        "min": "-10",
        "max": "0",
        "step": 1,
        "x": 291,
        "y": 609,
        "wires": [
            [
                "aa3b6866.eabab8"
            ]
        ]
    },
    {
        "id": "de834f9d.9b477",
        "type": "ui_slider",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Lågt pris",
        "tooltip": "Hur mycket ska kurvjusteringen vara när det är lågt pris?",
        "group": "94305680.d32c48",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "price/heat_cheap",
        "min": "0",
        "max": 10,
        "step": 1,
        "x": 291,
        "y": 658,
        "wires": [
            [
                "aa3b6866.eabab8"
            ]
        ]
    },
    {
        "id": "b0a104eb.836b28",
        "type": "ui_slider",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Väldigt lågt pris",
        "tooltip": "Hur mycket ska kurvjusteringen vara när det är väldigt lågt pris?",
        "group": "94305680.d32c48",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "price/heat_very_cheap",
        "min": "0",
        "max": 10,
        "step": 1,
        "x": 311,
        "y": 707,
        "wires": [
            [
                "aa3b6866.eabab8"
            ]
        ]
    },
    {
        "id": "d2766d78.d5abf",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "heat_expensive_s2",
                "type": "str"
            }
        ],
        "x": 111,
        "y": 609,
        "wires": [
            [
                "1bb82fc2.e8b78"
            ],
            []
        ]
    },
    {
        "id": "d07cb165.8756a",
        "type": "ui_slider",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Väldigt högt pris",
        "tooltip": "Hur mycket ska kurvjusteringen vara när det är väldigt högt pris?",
        "group": "94305680.d32c48",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "price/heat_very_expensive",
        "min": "-10",
        "max": "0",
        "step": 1,
        "x": 311,
        "y": 560,
        "wires": [
            [
                "aa3b6866.eabab8"
            ]
        ]
    },
    {
        "id": "5ed538ba.60f5e8",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "heat_very_expensive_s2",
                "type": "str"
            }
        ],
        "x": 111,
        "y": 560,
        "wires": [
            [
                "d07cb165.8756a"
            ],
            []
        ]
    },
    {
        "id": "a3c9c25b.1c4fc",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "heat_cheap_s2",
                "type": "str"
            }
        ],
        "x": 111,
        "y": 658,
        "wires": [
            [
                "de834f9d.9b477"
            ],
            []
        ]
    },
    {
        "id": "eb82842d.507e48",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "heat_very_cheap_s2",
                "type": "str"
            }
        ],
        "x": 111,
        "y": 707,
        "wires": [
            [
                "b0a104eb.836b28"
            ],
            []
        ]
    },
    {
        "id": "9958a8f1.7abba8",
        "type": "ui_text",
        "z": "960078e.e3e6d88",
        "group": "f481a5f0.f9f1c8",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "SmartPrice Info",
        "label": "",
        "format": "OBS. För att kunna använda prisnivåer från Nibe Uplink måste Nibes SmartPrice vara aktiverat i värmepumpen manuellt under meny 4.1.6 Smart Price Adaption.",
        "layout": "row-spread",
        "x": 843,
        "y": 637,
        "wires": []
    },
    {
        "id": "9ff28997.48cac8",
        "type": "function",
        "z": "960078e.e3e6d88",
        "name": "Enable/Disable SmartPrice",
        "func": "let source = msg.payload;\nif(source==\"30\") {\n    msg = {\n    enabled:true\n};\nreturn msg;\n} else if(source==\"10\") {\n    msg = {\n    enabled:false\n};\nreturn msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 603,
        "y": 665,
        "wires": [
            [
                "9958a8f1.7abba8",
                "65bf37a8.e18928"
            ]
        ]
    },
    {
        "id": "f5bfde4f.200e",
        "type": "ui_dropdown",
        "z": "358baec9.c8b902",
        "name": "",
        "label": "Inomhusreglering",
        "tooltip": "",
        "place": "Välj",
        "group": "a2cfe148.70708",
        "order": 1,
        "width": "0",
        "height": "0",
        "passthru": false,
        "options": [
            {
                "label": "Avaktiverat",
                "value": "off",
                "type": "str"
            },
            {
                "label": "Nibes Inomhusreglering",
                "value": "nibe",
                "type": "str"
            },
            {
                "label": "NibePis Inomhusreglering",
                "value": "nibepi",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "site",
        "x": 412,
        "y": 35,
        "wires": [
            [
                "8cec67c8.150f68"
            ]
        ]
    },
    {
        "id": "d23336a5.00c4a8",
        "type": "function",
        "z": "358baec9.c8b902",
        "name": "",
        "func": "let nibe = msg.inside_enable_s1;\nlet nibepi = msg.config.indoor.enable_s1;\nmsg.topic = \"red\";\nif(nibe===1 && (nibepi===undefined || nibepi===false)) {\n    msg.payload = \"nibe\";\n} else if(nibe===0 && nibepi===true) {\n    msg.payload = \"nibepi\";\n} else {\n    msg.payload = \"off\"\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 239,
        "y": 35,
        "wires": [
            [
                "f5bfde4f.200e",
                "f65e7c49.0cfac"
            ]
        ]
    },
    {
        "id": "f65e7c49.0cfac",
        "type": "function",
        "z": "358baec9.c8b902",
        "name": "",
        "func": "let config = msg.config;\nlet topic = msg.topic;\nif(msg.payload==\"nibe\") {\n    //config.indoor.enable_s1 = false;\n    //config.indoor.sensor_s1 = undefined;\n    if(topic==\"site\") {\n        node.send([{topic:\"inside_enable_s1\",payload:1},{topic:\"indoor/enable\",payload:false},{enabled:true},{enabled:false}]);\n        node.send([null,{topic:\"indoor/sensor\",payload:undefined}])\n    } else {\n        node.send([null,null,{enabled:true},{enabled:false}]);\n    }\n    \n} else if(msg.payload==\"nibepi\") {\n    //config.indoor.enable_s1 = true;\n    if(topic==\"site\") {\n        node.send([{topic:\"inside_enable_s1\",payload:0},{topic:\"indoor/enable\",payload:true},{enabled:true},{enabled:true}]);\n    } else {\n        node.send([null,null,{enabled:true},{enabled:true}]);\n    }\n} else {\n    //config.indoor.enable_s1 = false;\n    //config.indoor.sensor_s1 = undefined;\n    if(topic==\"site\") {\n        node.send([{topic:\"inside_enable_s1\",payload:0},{topic:\"indoor/enable\",payload:false},{enabled:false},{enabled:false}]);\n        node.send([null,{topic:\"indoor/sensor\",payload:undefined}])\n    } else {\n        node.send([null,null,{enabled:false},{enabled:false}]);\n    }\n}",
        "outputs": 4,
        "noerr": 0,
        "x": 729,
        "y": 35,
        "wires": [
            [
                "f9a0b44f.224b78"
            ],
            [
                "fdd4d594.2498b8"
            ],
            [
                "a8deecfc.3d34b",
                "8a3192fa.29d1d",
                "d68a22ce.9289d",
                "c0a999e9.8d63b8",
                "9f4e48ae.0cdd88"
            ],
            [
                "e1739c13.ca664",
                "f421e95f.a41718"
            ]
        ]
    },
    {
        "id": "d6176cc8.3e0d3",
        "type": "nibe-request",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 260,
        "y": 133,
        "wires": [
            [
                "67e507d8.25dac8"
            ],
            []
        ]
    },
    {
        "id": "8cec67c8.150f68",
        "type": "nibe-request",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 582,
        "y": 35,
        "wires": [
            [
                "f65e7c49.0cfac"
            ],
            []
        ]
    },
    {
        "id": "f9a0b44f.224b78",
        "type": "nibe-output",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "",
        "x": 938,
        "y": 28,
        "wires": [
            []
        ]
    },
    {
        "id": "d136e0d4.36424",
        "type": "ui_slider",
        "z": "358baec9.c8b902",
        "name": "",
        "label": "Inomhus börvärde",
        "tooltip": "",
        "group": "6ee1e12a.a6f04",
        "order": 5,
        "width": "11",
        "height": "1",
        "passthru": false,
        "outs": "end",
        "topic": "",
        "min": "5",
        "max": "30",
        "step": "0.5",
        "x": 685,
        "y": 1015,
        "wires": [
            [
                "b78dec32.a1881"
            ]
        ]
    },
    {
        "id": "d5bb2eff.594fe",
        "type": "ui_slider",
        "z": "358baec9.c8b902",
        "name": "",
        "label": "Faktor för Inomhusgivare",
        "tooltip": "Ställ in hur mycket inomhus givare ska påverka framledningstemperaturen.",
        "group": "6ee1e12a.a6f04",
        "order": 6,
        "width": "11",
        "height": "1",
        "passthru": false,
        "outs": "end",
        "topic": "inside_factor",
        "min": "0",
        "max": "6",
        "step": "0.1",
        "x": 705,
        "y": 1113,
        "wires": [
            [
                "f74bcb8.67d6438"
            ]
        ]
    },
    {
        "id": "b78dec32.a1881",
        "type": "nibe-output",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "inside_set_s2",
        "x": 941,
        "y": 1015,
        "wires": [
            [
                "d136e0d4.36424"
            ]
        ]
    },
    {
        "id": "64fe7e0e.2c1d6",
        "type": "nibe-request",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "inside_set_s2",
        "x": 472,
        "y": 1022,
        "wires": [
            [],
            [
                "d136e0d4.36424",
                "2c965701.af9058"
            ]
        ]
    },
    {
        "id": "6696956c.64474c",
        "type": "ui_ui_control",
        "z": "358baec9.c8b902",
        "name": "",
        "events": "all",
        "x": 102,
        "y": 1015,
        "wires": [
            [
                "81278907.1d9f08"
            ]
        ]
    },
    {
        "id": "81278907.1d9f08",
        "type": "function",
        "z": "358baec9.c8b902",
        "name": "Inomhusreglering",
        "func": "var timeSaved = context.get('time')||(Date.now()-1000);\nvar time = Date.now();\nif(msg.name==\"Inomhusreglering\") {\n    if(time>timeSaved) {\n        context.set('time',(time+30000));\n        return msg;\n    }\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 272,
        "y": 1015,
        "wires": [
            [
                "b123c693.644da8"
            ]
        ]
    },
    {
        "id": "2c965701.af9058",
        "type": "nibe-request",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "inside_factor_s2",
        "x": 472,
        "y": 1113,
        "wires": [
            [],
            [
                "d5bb2eff.594fe"
            ]
        ]
    },
    {
        "id": "f74bcb8.67d6438",
        "type": "nibe-output",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "inside_factor_s2",
        "x": 934,
        "y": 1113,
        "wires": [
            [
                "d5bb2eff.594fe"
            ]
        ]
    },
    {
        "id": "4990a4f.f34705c",
        "type": "nibe-input",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 134,
        "y": 1260,
        "wires": [
            [
                "47ac4ac3.4282f4"
            ],
            []
        ]
    },
    {
        "id": "47ac4ac3.4282f4",
        "type": "function",
        "z": "358baec9.c8b902",
        "name": "",
        "func": "var sensors = msg.payload.home.inside_sensors||[];\nvar output = [\"Ingen\"];\nfor (const arr of sensors) {\n    output.push(arr.name)\n}\nif(output!==undefined && output!==[]) {\n    node.send({options:output});\n    if(msg.payload.indoor!==undefined) {\n        node.send({payload:msg.payload.indoor.sensor_s2})\n    }\n    \n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 442,
        "y": 1260,
        "wires": [
            [
                "49524e59.d3921"
            ]
        ]
    },
    {
        "id": "49524e59.d3921",
        "type": "ui_dropdown",
        "z": "358baec9.c8b902",
        "name": "",
        "label": "Välj Inomhusgivare",
        "tooltip": "",
        "place": "Välj",
        "group": "6ee1e12a.a6f04",
        "order": 8,
        "width": "0",
        "height": "0",
        "passthru": false,
        "options": [
            {
                "label": "",
                "value": "",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "indoor/sensor",
        "x": 636,
        "y": 1260,
        "wires": [
            [
                "26c121a.21b7bde"
            ]
        ]
    },
    {
        "id": "26c121a.21b7bde",
        "type": "nibe-indoor",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s2",
        "adjust": "0",
        "x": 850,
        "y": 1211,
        "wires": [
            [
                "24024128.b41ebe",
                "76dc2468.d143ec"
            ],
            []
        ]
    },
    {
        "id": "98a2ba00.9574c8",
        "type": "ui_button",
        "z": "358baec9.c8b902",
        "name": "Uppdatera S2",
        "group": "6ee1e12a.a6f04",
        "order": 11,
        "width": "12",
        "height": "1",
        "passthru": false,
        "label": "Uppdatera",
        "tooltip": "Begär ny data och uppdatera grafen med nya värden.",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "update",
        "x": 640,
        "y": 1197,
        "wires": [
            [
                "26c121a.21b7bde"
            ]
        ]
    },
    {
        "id": "2f4cb05b.407d1",
        "type": "ui_text",
        "z": "358baec9.c8b902",
        "group": "6ee1e12a.a6f04",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Inomhustemperatur",
        "format": "{{msg.payload}} ºC",
        "layout": "row-spread",
        "x": 1196,
        "y": 931,
        "wires": []
    },
    {
        "id": "24024128.b41ebe",
        "type": "switch",
        "z": "358baec9.c8b902",
        "name": "Data",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Inomhustemperatur",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Utomhustemperatur",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Gradminuter",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Tid",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Avvikelse",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Kurvjustering",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 1065,
        "y": 1204,
        "wires": [
            [
                "2f4cb05b.407d1"
            ],
            [],
            [],
            [],
            [
                "8d1f9f48.44fef"
            ],
            [
                "ced9439e.afef"
            ]
        ]
    },
    {
        "id": "38c0fc67.e35064",
        "type": "nibe-request",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "inside_enable_s2",
        "x": 440,
        "y": 966,
        "wires": [
            [
                "15058f79.4342b1"
            ],
            [
                "64fe7e0e.2c1d6"
            ]
        ]
    },
    {
        "id": "a20f3f7d.f9096",
        "type": "ui_template",
        "z": "358baec9.c8b902",
        "group": "6ee1e12a.a6f04",
        "name": "Välj Inomhusgivare info",
        "order": 7,
        "width": 0,
        "height": 0,
        "format": "Välj en temperaturgivare som ska användas i grafen och för ekvationen.<br><br>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 334,
        "y": 1197,
        "wires": [
            []
        ]
    },
    {
        "id": "8cf9b82c.df7338",
        "type": "ui_text",
        "z": "358baec9.c8b902",
        "group": "6ee1e12a.a6f04",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "Avvikelse",
        "label": "Avvikelse",
        "format": "{{msg.payload}} %",
        "layout": "row-spread",
        "x": 1313,
        "y": 1015,
        "wires": []
    },
    {
        "id": "8d1f9f48.44fef",
        "type": "range",
        "z": "358baec9.c8b902",
        "minin": "1",
        "maxin": "2",
        "minout": "0",
        "maxout": "100",
        "action": "scale",
        "round": true,
        "property": "payload",
        "name": "",
        "x": 1152,
        "y": 1015,
        "wires": [
            [
                "8cf9b82c.df7338"
            ]
        ]
    },
    {
        "id": "ced9439e.afef",
        "type": "ui_text",
        "z": "358baec9.c8b902",
        "group": "6ee1e12a.a6f04",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "Kurvjustering",
        "label": "{{msg.topic}}",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1176,
        "y": 973,
        "wires": []
    },
    {
        "id": "67f0bc49.0491c4",
        "type": "ui_dropdown",
        "z": "358baec9.c8b902",
        "name": "",
        "label": "Inomhusreglering",
        "tooltip": "",
        "place": "Välj",
        "group": "6ee1e12a.a6f04",
        "order": 1,
        "width": "0",
        "height": "0",
        "passthru": false,
        "options": [
            {
                "label": "Avaktiverat",
                "value": "off",
                "type": "str"
            },
            {
                "label": "Nibes Inomhusreglering",
                "value": "nibe",
                "type": "str"
            },
            {
                "label": "NibePis Inomhusreglering",
                "value": "nibepi",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "site",
        "x": 419,
        "y": 868,
        "wires": [
            [
                "f8a95348.53c3c"
            ]
        ]
    },
    {
        "id": "15058f79.4342b1",
        "type": "function",
        "z": "358baec9.c8b902",
        "name": "",
        "func": "let nibe = msg.inside_enable_s2;\nlet nibepi = msg.config.indoor.enable_s2;\nmsg.topic = \"red\";\nif(nibe===1 && (nibepi===undefined || nibepi===false)) {\n    msg.payload = \"nibe\";\n} else if(nibe===0 && nibepi===true) {\n    msg.payload = \"nibepi\";\n} else {\n    msg.payload = \"off\"\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 246,
        "y": 868,
        "wires": [
            [
                "67f0bc49.0491c4",
                "edac8d3e.c5625"
            ]
        ]
    },
    {
        "id": "edac8d3e.c5625",
        "type": "function",
        "z": "358baec9.c8b902",
        "name": "",
        "func": "let config = msg.config;\nlet topic = msg.topic;\nif(msg.payload==\"nibe\") {\n    //config.indoor.enable_s2 = false;\n    //config.indoor.sensor_s2 = undefined;\n    if(topic==\"site\") {\n        node.send([{topic:\"inside_enable_s2\",payload:1},{topic:\"indoor/enable\",payload:false},{enabled:true},{enabled:false}]);\n        node.send([null,{topic:\"indoor/sensor\",payload:undefined}])\n    } else {\n        node.send([null,null,{enabled:true},{enabled:false}]);\n    }\n    \n} else if(msg.payload==\"nibepi\") {\n    //config.indoor.enable_s2 = true;\n    if(topic==\"site\") {\n        node.send([{topic:\"inside_enable_s2\",payload:0},{topic:\"indoor/enable\",payload:true},{enabled:true},{enabled:true}]);\n    } else {\n        node.send([null,null,{enabled:true},{enabled:true}]);\n    }\n} else {\n    config.indoor.enable_s2 = false;\n    config.indoor.sensor_s2 = undefined;\n    if(topic==\"site\") {\n        node.send([{topic:\"inside_enable_s2\",payload:0},{topic:\"indoor/enable\",payload:false},{enabled:false},{enabled:false}]);\n        node.send([null,{topic:\"indoor/sensor\",payload:undefined}])\n    } else {\n        node.send([null,null,{enabled:false},{enabled:false}]);\n    }\n}",
        "outputs": 4,
        "noerr": 0,
        "x": 736,
        "y": 868,
        "wires": [
            [
                "f27d9d77.fbdb"
            ],
            [
                "26c121a.21b7bde"
            ],
            [
                "d136e0d4.36424",
                "d5bb2eff.594fe",
                "98a2ba00.9574c8"
            ],
            [
                "a20f3f7d.f9096",
                "49524e59.d3921"
            ]
        ]
    },
    {
        "id": "b123c693.644da8",
        "type": "nibe-request",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 267,
        "y": 966,
        "wires": [
            [
                "38c0fc67.e35064"
            ],
            []
        ]
    },
    {
        "id": "f8a95348.53c3c",
        "type": "nibe-request",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 589,
        "y": 868,
        "wires": [
            [
                "edac8d3e.c5625"
            ],
            []
        ]
    },
    {
        "id": "f27d9d77.fbdb",
        "type": "nibe-output",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "",
        "x": 910,
        "y": 868,
        "wires": [
            []
        ]
    },
    {
        "id": "76dc2468.d143ec",
        "type": "function",
        "z": "358baec9.c8b902",
        "name": "Enable/Disable",
        "func": "if(msg.enabled!==undefined) {\n    let hide = {\n        \"group\":\n            {\"hide\":\n                [\"Inomhusreglering_Inomhusreglering_S2\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n} else {\n    let hide = {\n        \"group\":\n            {\"show\":\n                [\"Inomhusreglering_Inomhusreglering_S2\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 906,
        "y": 1288,
        "wires": [
            [],
            [
                "9410373f.75f968"
            ]
        ]
    },
    {
        "id": "9410373f.75f968",
        "type": "ui_ui_control",
        "z": "358baec9.c8b902",
        "name": "Disable Group S2",
        "events": "all",
        "x": 1126,
        "y": 1288,
        "wires": [
            []
        ]
    },
    {
        "id": "4711e827.788878",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "system",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "readonly",
                "type": "str"
            }
        ],
        "x": 1154,
        "y": 399,
        "wires": [
            [
                "9414a4e7.3d88c8"
            ],
            []
        ]
    },
    {
        "id": "9414a4e7.3d88c8",
        "type": "ui_switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Read-only",
        "tooltip": "",
        "group": "da3c0db0.9c6aa",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "readonly",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 959,
        "y": 399,
        "wires": [
            [
                "4711e827.788878"
            ]
        ]
    },
    {
        "id": "6a959097.836b1",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Enable/Disable",
        "func": "if(msg.payload<=-3275) {\n    let hide = {\n        \"group\":\n            {\"hide\":\n                [\"Inställningar_Värmekurva_S2\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n} else {\n    let hide = {\n        \"group\":\n            {\"show\":\n                [\"Inställningar_Värmekurva_S2\"]\n            }\n        }\n    node.send([msg,{payload:hide}]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 367,
        "y": 665,
        "wires": [
            [
                "1870fc41.cbc664"
            ],
            [
                "b532e9d.acf2018"
            ]
        ]
    },
    {
        "id": "b532e9d.acf2018",
        "type": "ui_ui_control",
        "z": "b7f67da0.fbf1",
        "name": "Disable Group S2",
        "events": "all",
        "x": 601,
        "y": 686,
        "wires": [
            []
        ]
    },
    {
        "id": "fe91dfd1.92491",
        "type": "ui_switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "HA Discovery",
        "tooltip": "",
        "group": "723a0250.fd7dcc",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "discovery",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 157,
        "y": 273,
        "wires": [
            [
                "cdec2513.52ee18"
            ]
        ]
    },
    {
        "id": "cdec2513.52ee18",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "mqtt",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "discovery",
                "type": "str"
            }
        ],
        "x": 395,
        "y": 273,
        "wires": [
            [
                "fe91dfd1.92491"
            ],
            []
        ]
    },
    {
        "id": "536a060f.983278",
        "type": "nibe-hotwater",
        "z": "fa4686d6.c21688",
        "server": "844659a2.8d8508",
        "name": "",
        "enable_autoluxury": true,
        "enable_hw_priority": true,
        "autoluxury_diff": "20",
        "autoluxury_time": "10",
        "x": 388,
        "y": 203,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "cabc9c9b.934ca",
        "type": "ui_button",
        "z": "fa4686d6.c21688",
        "name": "Uppdatera",
        "group": "bcb5f9e4.9bc858",
        "order": 7,
        "width": 12,
        "height": 1,
        "passthru": false,
        "label": "Uppdatera",
        "tooltip": "Begär ny data och uppdatera med nya värden.",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "update",
        "x": 175,
        "y": 203,
        "wires": [
            [
                "536a060f.983278"
            ]
        ]
    },
    {
        "id": "9b8580ac.45b4c",
        "type": "ui_button",
        "z": "fa4686d6.c21688",
        "name": "Uppdatera",
        "group": "38b6d907.520796",
        "order": 5,
        "width": 12,
        "height": 1,
        "passthru": false,
        "label": "Uppdatera",
        "tooltip": "Begär ny data och uppdatera med nya värden.",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "update",
        "x": 175,
        "y": 245,
        "wires": [
            [
                "536a060f.983278"
            ]
        ]
    },
    {
        "id": "2fa37aef.af11c6",
        "type": "subflow:c191a5d.5d76258",
        "z": "fa4686d6.c21688",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "hotwater",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable_autoluxury",
                "type": "str"
            }
        ],
        "x": 496,
        "y": 84,
        "wires": [
            [
                "50a77016.79477"
            ],
            []
        ]
    },
    {
        "id": "50a77016.79477",
        "type": "ui_switch",
        "z": "fa4686d6.c21688",
        "name": "Aktivera Automatisk tillfällig lyx",
        "label": "Aktivera",
        "tooltip": "",
        "group": "bcb5f9e4.9bc858",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "enable_autoluxury",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 228,
        "y": 84,
        "wires": [
            [
                "2fa37aef.af11c6"
            ]
        ]
    },
    {
        "id": "7fdfc0b5.b1058",
        "type": "ui_switch",
        "z": "fa4686d6.c21688",
        "name": "Aktivera Varmvatten prioritet",
        "label": "Aktivera",
        "tooltip": "",
        "group": "38b6d907.520796",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "enable_hw_priority",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 225,
        "y": 133,
        "wires": [
            [
                "2678da12.da8146"
            ]
        ]
    },
    {
        "id": "2678da12.da8146",
        "type": "subflow:c191a5d.5d76258",
        "z": "fa4686d6.c21688",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "hotwater",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable_hw_priority",
                "type": "str"
            }
        ],
        "x": 496,
        "y": 133,
        "wires": [
            [
                "7fdfc0b5.b1058"
            ],
            []
        ]
    },
    {
        "id": "4fefdad9.0edc14",
        "type": "ui_slider",
        "z": "fa4686d6.c21688",
        "name": "",
        "label": "Differens",
        "tooltip": "",
        "group": "bcb5f9e4.9bc858",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "diff",
        "min": "5",
        "max": "50",
        "step": "1",
        "x": 179,
        "y": 343,
        "wires": [
            [
                "9efc9a73.8d9468"
            ]
        ]
    },
    {
        "id": "9efc9a73.8d9468",
        "type": "subflow:c191a5d.5d76258",
        "z": "fa4686d6.c21688",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "hotwater",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "diff",
                "type": "str"
            }
        ],
        "x": 370,
        "y": 343,
        "wires": [
            [
                "4fefdad9.0edc14"
            ],
            []
        ]
    },
    {
        "id": "61c95762.533568",
        "type": "ui_slider",
        "z": "fa4686d6.c21688",
        "name": "",
        "label": "Tidfaktor",
        "tooltip": "",
        "group": "bcb5f9e4.9bc858",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "time",
        "min": 0,
        "max": "50",
        "step": "1",
        "x": 179,
        "y": 385,
        "wires": [
            [
                "34388b96.e63974"
            ]
        ]
    },
    {
        "id": "34388b96.e63974",
        "type": "subflow:c191a5d.5d76258",
        "z": "fa4686d6.c21688",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "hotwater",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "time",
                "type": "str"
            }
        ],
        "x": 370,
        "y": 385,
        "wires": [
            [
                "61c95762.533568"
            ],
            []
        ]
    },
    {
        "id": "9e4523cf.0fe29",
        "type": "ui_toast",
        "z": "b7f67da0.fbf1",
        "position": "bottom right",
        "displayTime": "7",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "topic": "",
        "name": "",
        "x": 706,
        "y": 21,
        "wires": []
    },
    {
        "id": "ae0eda11.749f58",
        "type": "debug",
        "z": "b7f67da0.fbf1",
        "name": "Status",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "x": 540,
        "y": 70,
        "wires": []
    },
    {
        "id": "a95abf3c.1467c",
        "type": "delay",
        "z": "b7f67da0.fbf1",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 507,
        "y": 21,
        "wires": [
            [
                "9e4523cf.0fe29"
            ]
        ]
    },
    {
        "id": "4ee74939.4db6e8",
        "type": "nibe-input",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "error",
        "x": 134,
        "y": 42,
        "wires": [
            [
                "a95abf3c.1467c",
                "ae0eda11.749f58"
            ],
            []
        ]
    },
    {
        "id": "22798341.63387c",
        "type": "ui_switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Loggning på",
        "tooltip": "",
        "group": "97526682.5406d8",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "enable",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 300,
        "y": 2226,
        "wires": [
            [
                "ad9a955e.bca628"
            ]
        ]
    },
    {
        "id": "ad9a955e.bca628",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "log",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable",
                "type": "str"
            }
        ],
        "x": 524,
        "y": 2226,
        "wires": [
            [
                "22798341.63387c",
                "d464fe8e.e8ef7"
            ],
            []
        ]
    },
    {
        "id": "df3307ec.65d498",
        "type": "ui_switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "INFO",
        "tooltip": "",
        "group": "97526682.5406d8",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "info",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 281,
        "y": 2275,
        "wires": [
            [
                "68bba490.cea85c"
            ]
        ]
    },
    {
        "id": "68bba490.cea85c",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "log",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "info",
                "type": "str"
            }
        ],
        "x": 525,
        "y": 2275,
        "wires": [
            [
                "df3307ec.65d498"
            ],
            []
        ]
    },
    {
        "id": "d464fe8e.e8ef7",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Enable/Disable",
        "func": "msg = {\n    enabled:msg.payload\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 759,
        "y": 2226,
        "wires": [
            [
                "df3307ec.65d498",
                "c548dfa7.e7696",
                "4b9a995c.0f11b8",
                "3b259789.2e49a8",
                "d78784c9.e2bbc8",
                "b819b51e.7e2888",
                "5b3bd5b.489a32c"
            ]
        ]
    },
    {
        "id": "c548dfa7.e7696",
        "type": "ui_switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "ERROR",
        "tooltip": "",
        "group": "97526682.5406d8",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "error",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 291,
        "y": 2324,
        "wires": [
            [
                "9f0b5119.f9854"
            ]
        ]
    },
    {
        "id": "9f0b5119.f9854",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "log",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "error",
                "type": "str"
            }
        ],
        "x": 525,
        "y": 2324,
        "wires": [
            [
                "c548dfa7.e7696"
            ],
            []
        ]
    },
    {
        "id": "4b9a995c.0f11b8",
        "type": "ui_switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "DEBUG",
        "tooltip": "",
        "group": "97526682.5406d8",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "debug",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 291,
        "y": 2373,
        "wires": [
            [
                "fbd484b.8d81e78"
            ]
        ]
    },
    {
        "id": "fbd484b.8d81e78",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "log",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "debug",
                "type": "str"
            }
        ],
        "x": 525,
        "y": 2373,
        "wires": [
            [
                "4b9a995c.0f11b8"
            ],
            []
        ]
    },
    {
        "id": "3b259789.2e49a8",
        "type": "ui_switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "CORE",
        "tooltip": "",
        "group": "97526682.5406d8",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "core",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 281,
        "y": 2422,
        "wires": [
            [
                "d695de6d.24616"
            ]
        ]
    },
    {
        "id": "d695de6d.24616",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "log",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "core",
                "type": "str"
            }
        ],
        "x": 525,
        "y": 2422,
        "wires": [
            [
                "3b259789.2e49a8"
            ],
            []
        ]
    },
    {
        "id": "950de0aa.51125",
        "type": "ui_template",
        "z": "b7f67da0.fbf1",
        "group": "97526682.5406d8",
        "name": "Loggning Info",
        "order": 7,
        "width": 0,
        "height": 0,
        "format": "<p>Loggning sker till \"/tmp/nibepi.log\"<br>I SSH kör kommando \"tail -f /tmp/nibepi.log\"<br><br></p>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 349,
        "y": 2177,
        "wires": [
            []
        ]
    },
    {
        "id": "3b6f4ac6.4ef9b6",
        "type": "mqtt in",
        "z": "b7f67da0.fbf1",
        "name": "",
        "topic": "nibe/#",
        "qos": "2",
        "datatype": "auto",
        "broker": "d7f6b34d.d13d6",
        "x": 911,
        "y": 462,
        "wires": [
            [
                "274b71aa.648abe"
            ]
        ]
    },
    {
        "id": "274b71aa.648abe",
        "type": "debug",
        "z": "b7f67da0.fbf1",
        "name": "MQTT",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 1059,
        "y": 462,
        "wires": []
    },
    {
        "id": "b4a9d18b.4c69a",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Enable/Disable",
        "func": "if(msg.payload===true) {\n    node.send({enabled:false});\n} else {\n    node.send({enabled:true});\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 612,
        "y": 245,
        "wires": [
            [
                "3f2df90a.87e2f6",
                "5eaea9fd.2ab8b8",
                "3eed3ea7.c66072",
                "7cc82e4d.8f653",
                "6fe84622.e973e8"
            ]
        ]
    },
    {
        "id": "485ac39d.e1262c",
        "type": "ui_ui_control",
        "z": "df0dd648.98daa8",
        "name": "",
        "events": "all",
        "x": 690,
        "y": 112,
        "wires": [
            [
                "b21fd6b9.6b28e8"
            ]
        ]
    },
    {
        "id": "b21fd6b9.6b28e8",
        "type": "function",
        "z": "df0dd648.98daa8",
        "name": "Prognosreglering",
        "func": "var timeSaved = context.get('time')||(Date.now()-1000);\nvar time = Date.now();\nif(msg.name==\"Prognosreglering\") {\n    if(time>timeSaved) {\n        context.set('time',(time+30000));\n        return msg;\n    }\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 860,
        "y": 112,
        "wires": [
            [
                "8a714b3a.55fa18"
            ]
        ]
    },
    {
        "id": "8a714b3a.55fa18",
        "type": "nibe-request",
        "z": "df0dd648.98daa8",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 1044,
        "y": 112,
        "wires": [
            [],
            [
                "10e30751.e4e639"
            ]
        ]
    },
    {
        "id": "87a83c1.3cd9fc",
        "type": "nibe-request",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 127,
        "y": 385,
        "wires": [
            [],
            [
                "dff05253.9f618"
            ]
        ]
    },
    {
        "id": "e0751200.e40b5",
        "type": "ui_switch",
        "z": "358baec9.c8b902",
        "name": "Aktivera Stoppa värmeproduktion",
        "label": "Stoppa värmeproduktion",
        "tooltip": "",
        "group": "95b0af9c.89089",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "dm_reset_enable_stop",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 280,
        "y": 1442,
        "wires": [
            [
                "c5d3afd1.ce899"
            ]
        ]
    },
    {
        "id": "c5d3afd1.ce899",
        "type": "subflow:c191a5d.5d76258",
        "z": "358baec9.c8b902",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "indoor",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "dm_reset_enable_stop",
                "type": "str"
            }
        ],
        "x": 545,
        "y": 1442,
        "wires": [
            [
                "e0751200.e40b5",
                "49abf480.acd38c"
            ],
            []
        ]
    },
    {
        "id": "5abdd88.e5f8628",
        "type": "subflow:c191a5d.5d76258",
        "z": "358baec9.c8b902",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "indoor",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "dm_reset_stop_diff",
                "type": "str"
            }
        ],
        "x": 545,
        "y": 1498,
        "wires": [
            [
                "46fd6a28.346e94"
            ],
            []
        ]
    },
    {
        "id": "46fd6a28.346e94",
        "type": "ui_slider",
        "z": "358baec9.c8b902",
        "name": "",
        "label": "Differens",
        "tooltip": "",
        "group": "95b0af9c.89089",
        "order": 6,
        "width": "0",
        "height": "0",
        "passthru": false,
        "outs": "end",
        "topic": "dm_reset_stop_diff",
        "min": "0.5",
        "max": "3",
        "step": "0.1",
        "x": 284,
        "y": 1498,
        "wires": [
            [
                "5abdd88.e5f8628"
            ]
        ]
    },
    {
        "id": "bb2ea9a3.783e38",
        "type": "subflow:c191a5d.5d76258",
        "z": "358baec9.c8b902",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "indoor",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "dm_reset_slow_diff",
                "type": "str"
            }
        ],
        "x": 545,
        "y": 1547,
        "wires": [
            [
                "a56e3e6c.baf92"
            ],
            []
        ]
    },
    {
        "id": "a56e3e6c.baf92",
        "type": "ui_slider",
        "z": "358baec9.c8b902",
        "name": "",
        "label": "Differens",
        "tooltip": "",
        "group": "95b0af9c.89089",
        "order": 4,
        "width": "0",
        "height": "0",
        "passthru": false,
        "outs": "end",
        "topic": "dm_reset_slow_diff",
        "min": "0.1",
        "max": "3",
        "step": "0.1",
        "x": 284,
        "y": 1547,
        "wires": [
            [
                "bb2ea9a3.783e38"
            ]
        ]
    },
    {
        "id": "49abf480.acd38c",
        "type": "function",
        "z": "358baec9.c8b902",
        "name": "Enable/Disable",
        "func": "msg = {\n    enabled:msg.payload\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 773,
        "y": 1442,
        "wires": [
            [
                "46fd6a28.346e94"
            ]
        ]
    },
    {
        "id": "bb501ea0.7f712",
        "type": "function",
        "z": "358baec9.c8b902",
        "name": "Enable/Disable",
        "func": "msg = {\n    enabled:msg.payload\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 745,
        "y": 1393,
        "wires": [
            [
                "e0751200.e40b5",
                "46fd6a28.346e94",
                "a56e3e6c.baf92"
            ]
        ]
    },
    {
        "id": "54f823ff.b8206c",
        "type": "ui_ui_control",
        "z": "eee76599.b5f0d8",
        "name": "",
        "events": "all",
        "x": 144,
        "y": 210,
        "wires": [
            [
                "b59bafd9.45e65"
            ]
        ]
    },
    {
        "id": "b59bafd9.45e65",
        "type": "function",
        "z": "eee76599.b5f0d8",
        "name": "Inställningar",
        "func": "var timeSaved = context.get('time')||(Date.now()-1000);\nvar time = Date.now();\nif(msg.name==\"Inställningar\") {\n    if(time>timeSaved) {\n        context.set('time',(time+30000));\n        return msg;\n    }\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 294,
        "y": 210,
        "wires": [
            [
                "893baad1.277128",
                "7bac2960.6ef798",
                "e817a238.c8734",
                "6cbef66.4c31208"
            ]
        ]
    },
    {
        "id": "893baad1.277128",
        "type": "nibe-request",
        "z": "eee76599.b5f0d8",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 260,
        "y": 252,
        "wires": [
            [],
            [
                "d85ce7ca.219c78",
                "8820ada.454c85"
            ]
        ]
    },
    {
        "id": "d85ce7ca.219c78",
        "type": "function",
        "z": "eee76599.b5f0d8",
        "name": "Update list",
        "func": "var sensors = msg.payload.home.inside_sensors;\nvar output = [\"Ingen\"];\nif(sensors.length===0) {\n    return;\n}\nfor (const arr of sensors) {\n    output.push(arr.name)\n}\nif(output!==undefined && output!==[]) {\n    node.send({options:output});\n    if(msg.payload.indoor!==undefined) {\n        node.send({payload:msg.payload.rmu.sensor_s1})\n    }\n    \n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 434,
        "y": 308,
        "wires": [
            [
                "120d7487.c214bb"
            ]
        ]
    },
    {
        "id": "120d7487.c214bb",
        "type": "ui_dropdown",
        "z": "eee76599.b5f0d8",
        "name": "",
        "label": "Välj Inomhusgivare",
        "tooltip": "",
        "place": "Välj",
        "group": "ef983ace.21f138",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "options": [
            {
                "label": "",
                "value": "",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "rmu/sensor",
        "x": 622,
        "y": 308,
        "wires": [
            [
                "17916cf8.c093b3"
            ]
        ]
    },
    {
        "id": "dc42d90.1df3a28",
        "type": "subflow:c191a5d.5d76258",
        "z": "eee76599.b5f0d8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "rmu",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "sensor_s1",
                "type": "str"
            }
        ],
        "x": 237,
        "y": 308,
        "wires": [
            [],
            [
                "d85ce7ca.219c78"
            ]
        ]
    },
    {
        "id": "17916cf8.c093b3",
        "type": "nibe-rmu",
        "z": "eee76599.b5f0d8",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "sensor": "",
        "x": 738,
        "y": 371,
        "wires": [
            [
                "ed7a28da.800c78",
                "fe27461e.7e1e48"
            ],
            []
        ]
    },
    {
        "id": "15852af8.995215",
        "type": "inject",
        "z": "eee76599.b5f0d8",
        "name": "",
        "topic": "update",
        "payload": "Uppdatera",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 524,
        "y": 371,
        "wires": [
            [
                "17916cf8.c093b3"
            ]
        ]
    },
    {
        "id": "8820ada.454c85",
        "type": "function",
        "z": "eee76599.b5f0d8",
        "name": "Update list",
        "func": "var sensors = msg.payload.home.inside_sensors;\nvar output = [\"Ingen\"];\nif(sensors.length===0) {\n    return;\n}\nfor (const arr of sensors) {\n    output.push(arr.name)\n}\nif(output!==undefined && output!==[]) {\n    node.send({options:output});\n    if(msg.payload.indoor!==undefined) {\n        node.send({payload:msg.payload.rmu.sensor_s2})\n    }\n    \n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 434,
        "y": 441,
        "wires": [
            [
                "c9b16100.9942c"
            ]
        ]
    },
    {
        "id": "c9b16100.9942c",
        "type": "ui_dropdown",
        "z": "eee76599.b5f0d8",
        "name": "",
        "label": "Välj Inomhusgivare",
        "tooltip": "",
        "place": "Välj",
        "group": "32b15b25.77ef94",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "options": [
            {
                "label": "",
                "value": "",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "rmu/sensor",
        "x": 622,
        "y": 441,
        "wires": [
            [
                "9e04abe.ef6d058"
            ]
        ]
    },
    {
        "id": "9eada6bf.9eade8",
        "type": "subflow:c191a5d.5d76258",
        "z": "eee76599.b5f0d8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "rmu",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "sensor_s2",
                "type": "str"
            }
        ],
        "x": 237,
        "y": 441,
        "wires": [
            [],
            [
                "8820ada.454c85"
            ]
        ]
    },
    {
        "id": "9e04abe.ef6d058",
        "type": "nibe-rmu",
        "z": "eee76599.b5f0d8",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s2",
        "sensor": "",
        "x": 738,
        "y": 504,
        "wires": [
            [
                "66a2f83a.e878d8",
                "f86092a6.e0f16"
            ],
            []
        ]
    },
    {
        "id": "911f0c0d.14384",
        "type": "inject",
        "z": "eee76599.b5f0d8",
        "name": "",
        "topic": "update",
        "payload": "Uppdatera",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 524,
        "y": 504,
        "wires": [
            [
                "9e04abe.ef6d058"
            ]
        ]
    },
    {
        "id": "66a2f83a.e878d8",
        "type": "function",
        "z": "eee76599.b5f0d8",
        "name": "Enable/Disable",
        "func": "if(msg.enabled!==undefined && msg.enabled===true) {\n    let hide = {\n        \"group\":\n            {\"show\":\n                [\"Inställningar_RMU40_S2\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n} else if(msg.enabled===false) {\n    let hide = {\n        \"group\":\n            {\"hide\":\n                [\"Inställningar_RMU40_S2\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 913,
        "y": 588,
        "wires": [
            [],
            [
                "4ae37d2f.ae3654"
            ]
        ]
    },
    {
        "id": "4ae37d2f.ae3654",
        "type": "ui_ui_control",
        "z": "eee76599.b5f0d8",
        "name": "Disable Group S2",
        "events": "all",
        "x": 1133,
        "y": 588,
        "wires": [
            []
        ]
    },
    {
        "id": "ed7a28da.800c78",
        "type": "debug",
        "z": "eee76599.b5f0d8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 960,
        "y": 371,
        "wires": []
    },
    {
        "id": "f86092a6.e0f16",
        "type": "debug",
        "z": "eee76599.b5f0d8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 949,
        "y": 467,
        "wires": []
    },
    {
        "id": "bbeace10.c8e3d",
        "type": "ui_ui_control",
        "z": "b7f67da0.fbf1",
        "name": "Disable View",
        "events": "all",
        "x": 1204,
        "y": 1204,
        "wires": [
            []
        ]
    },
    {
        "id": "9961a077.ae64e",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "home",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "sensor_timeout",
                "type": "str"
            }
        ],
        "x": 559,
        "y": 1771,
        "wires": [
            [
                "85e36ab1.21f178"
            ],
            []
        ]
    },
    {
        "id": "85e36ab1.21f178",
        "type": "ui_slider",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Timeout tid för MQTT givare",
        "tooltip": "Givaren måste uppdateras inom detta interval annars ignoreras den. OBS \"0\" inaktiverar timeout.",
        "group": "fb207b28.da59b8",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "sensor_timeout",
        "min": 0,
        "max": "120",
        "step": 1,
        "x": 302,
        "y": 1771,
        "wires": [
            [
                "9961a077.ae64e"
            ]
        ]
    },
    {
        "id": "bc033700.b4f528",
        "type": "exec",
        "z": "b7f67da0.fbf1",
        "command": "",
        "addpay": true,
        "append": "",
        "useSpawn": "true",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 974,
        "y": 119,
        "wires": [
            [
                "96e5be75.41ca7"
            ],
            [
                "96e5be75.41ca7"
            ],
            []
        ]
    },
    {
        "id": "8c94d6ec.86fc68",
        "type": "nibe-input",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "dM",
        "add": false,
        "x": 876,
        "y": 686,
        "wires": [
            [
                "5f8c6837.106e18"
            ],
            [
                "e78514aa.0d9f28"
            ]
        ]
    },
    {
        "id": "23951e95.29e3a2",
        "type": "nibe-input",
        "z": "358baec9.c8b902",
        "server": "844659a2.8d8508",
        "name": "outside",
        "add": false,
        "x": 876,
        "y": 735,
        "wires": [
            [
                "61436d60.0601e4"
            ],
            [
                "e78514aa.0d9f28"
            ]
        ]
    },
    {
        "id": "60eab66c.e5a1b8",
        "type": "ui_template",
        "z": "b7f67da0.fbf1",
        "group": "fe94277c.dcd118",
        "name": "",
        "order": 3,
        "width": "12",
        "height": "5",
        "format": "<p>{{msg.payload}}</p>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 1278,
        "y": 119,
        "wires": [
            []
        ]
    },
    {
        "id": "96e5be75.41ca7",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "var data = global.get('cmdLog')||[];\nlet time = Date.now();\nlet da = msg.payload//.replace('\\n','<br>')\nnode.send({payload:da});\n/*\ndata.unshift([da]);\nglobal.set('cmdLog',data);\nif(da!==undefined && da!==[]) {\n    node.send({payload:data});\n}*/",
        "outputs": 1,
        "noerr": 0,
        "x": 1128,
        "y": 119,
        "wires": [
            [
                "60eab66c.e5a1b8"
            ]
        ]
    },
    {
        "id": "db8da946.5afd58",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "Model",
        "env": [
            {
                "name": "Name",
                "value": "system",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "pump",
                "type": "str"
            }
        ],
        "x": 1051,
        "y": 714,
        "wires": [
            [
                "3a72bbe0.7394c4"
            ],
            []
        ]
    },
    {
        "id": "c89baea1.1190b",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "Firmware",
        "env": [
            {
                "name": "Name",
                "value": "system",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "firmware",
                "type": "str"
            }
        ],
        "x": 1061,
        "y": 756,
        "wires": [
            [
                "d9877026.b0431"
            ],
            []
        ]
    },
    {
        "id": "3a72bbe0.7394c4",
        "type": "ui_text",
        "z": "b7f67da0.fbf1",
        "group": "4a7ab836.172ae8",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "Nibe",
        "label": "",
        "format": "Nibe {{msg.payload}}",
        "layout": "row-left",
        "x": 1226,
        "y": 714,
        "wires": []
    },
    {
        "id": "d9877026.b0431",
        "type": "ui_text",
        "z": "b7f67da0.fbf1",
        "group": "4a7ab836.172ae8",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "Firmware",
        "label": "",
        "format": "Firmware {{msg.payload}}",
        "layout": "row-left",
        "x": 1222,
        "y": 756,
        "wires": []
    },
    {
        "id": "e3908904.192158",
        "type": "ui_text_input",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Kör kommando",
        "tooltip": "Skriv ett kommando. Återkoppling i rutan nedan",
        "group": "fe94277c.dcd118",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "",
        "x": 780,
        "y": 119,
        "wires": [
            [
                "bc033700.b4f528"
            ]
        ]
    },
    {
        "id": "95df0257.5f871",
        "type": "ui_text_input",
        "z": "fa4686d6.c21688",
        "d": true,
        "name": "",
        "label": "Start",
        "tooltip": "",
        "group": "38b6d907.520796",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "time",
        "delay": "0",
        "topic": "priority_time_start1",
        "x": 442,
        "y": 476,
        "wires": [
            [
                "4b2e686f.1be868"
            ]
        ]
    },
    {
        "id": "4b2e686f.1be868",
        "type": "subflow:c191a5d.5d76258",
        "z": "fa4686d6.c21688",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "hotwater",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "priority_time_start1",
                "type": "str"
            }
        ],
        "x": 643,
        "y": 476,
        "wires": [
            [
                "95df0257.5f871"
            ],
            []
        ]
    },
    {
        "id": "a06c6ec7.72b5e",
        "type": "ui_dropdown",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Ta bort Register",
        "tooltip": "",
        "place": "Välj register",
        "group": "bd199d65.157fc",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "options": [
            {
                "label": "",
                "value": "",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "removeRegister",
        "x": 871,
        "y": 1421,
        "wires": [
            [
                "1b0cc4df.6a668b"
            ]
        ]
    },
    {
        "id": "77e503d5.77b63c",
        "type": "function",
        "z": "960078e.e3e6d88",
        "name": "",
        "func": "var sensors = msg.payload.home.inside_sensors||[];\nvar output = [\"Ingen\"];\nfor (const arr of sensors) {\n    output.push(arr.name)\n}\nif(output!==undefined && output!==[]) {\n    node.send({options:output});\n    if(msg.payload.price!==undefined) {\n        node.send({payload:msg.payload.price.sensor_s1})\n    }\n    \n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 428,
        "y": 420,
        "wires": [
            [
                "5b35fb44.679dc4"
            ]
        ]
    },
    {
        "id": "9c5f816f.d0c84",
        "type": "nibe-input",
        "z": "960078e.e3e6d88",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 134,
        "y": 420,
        "wires": [
            [
                "77e503d5.77b63c"
            ],
            []
        ]
    },
    {
        "id": "419d4955.0dded8",
        "type": "nibe-request",
        "z": "960078e.e3e6d88",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 134,
        "y": 378,
        "wires": [
            [],
            [
                "77e503d5.77b63c"
            ]
        ]
    },
    {
        "id": "5b35fb44.679dc4",
        "type": "ui_dropdown",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Välj Inomhusgivare",
        "tooltip": "",
        "place": "Välj",
        "group": "1b40f24f.7b6d9e",
        "order": 9,
        "width": "0",
        "height": "0",
        "passthru": false,
        "options": [
            {
                "label": "",
                "value": "",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "price/sensor",
        "x": 601,
        "y": 420,
        "wires": [
            [
                "8dd4be0a.86e46"
            ]
        ]
    },
    {
        "id": "551009f1.15c058",
        "type": "ui_slider",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Differens",
        "tooltip": "Lägsta temperaturdifferens jämfört mot Inomhusbörvärdet.",
        "group": "1b40f24f.7b6d9e",
        "order": 8,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "price/temp_low",
        "min": "-3",
        "max": "2",
        "step": "0.1",
        "x": 1033,
        "y": 315,
        "wires": [
            [
                "8dd4be0a.86e46"
            ]
        ]
    },
    {
        "id": "84e8bdd0.e775f",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "temp_low_s1",
                "type": "str"
            }
        ],
        "x": 853,
        "y": 315,
        "wires": [
            [
                "551009f1.15c058"
            ],
            []
        ]
    },
    {
        "id": "cf821e30.dde36",
        "type": "ui_text_input",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Serieport",
        "tooltip": "",
        "group": "fe94277c.dcd118",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "port",
        "x": 1012,
        "y": 1491,
        "wires": [
            [
                "f0042dae.d44d"
            ]
        ]
    },
    {
        "id": "f0042dae.d44d",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "serial",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "port",
                "type": "str"
            }
        ],
        "x": 1189,
        "y": 1491,
        "wires": [
            [
                "cf821e30.dde36"
            ],
            []
        ]
    },
    {
        "id": "9a16797e.af4448",
        "type": "ui_button",
        "z": "b7f67da0.fbf1",
        "name": "",
        "group": "fe94277c.dcd118",
        "order": 5,
        "width": 6,
        "height": 1,
        "passthru": false,
        "label": "Starta Samba",
        "tooltip": "Startar fildelningsservern och sätter NibePi i skrivläge",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "",
        "x": 402,
        "y": 2632,
        "wires": [
            [
                "7c23dc92.d4de34"
            ]
        ]
    },
    {
        "id": "7c23dc92.d4de34",
        "type": "exec",
        "z": "b7f67da0.fbf1",
        "command": "sudo mount -o remount,rw /",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 645,
        "y": 2632,
        "wires": [
            [],
            [],
            [
                "53907b6b.f7ca84"
            ]
        ]
    },
    {
        "id": "53907b6b.f7ca84",
        "type": "switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "property": "payload.code",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 870,
        "y": 2646,
        "wires": [
            [
                "431f5eda.16be7"
            ]
        ]
    },
    {
        "id": "431f5eda.16be7",
        "type": "exec",
        "z": "b7f67da0.fbf1",
        "command": "sudo service smbd start",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 1056,
        "y": 2646,
        "wires": [
            [],
            [],
            [
                "1028bc02.3efb04"
            ]
        ]
    },
    {
        "id": "1028bc02.3efb04",
        "type": "switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "property": "payload.code",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 835,
        "y": 2723,
        "wires": [
            [
                "4b487231.b42a6c"
            ]
        ]
    },
    {
        "id": "4b487231.b42a6c",
        "type": "change",
        "z": "b7f67da0.fbf1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Samba startad.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 988,
        "y": 2723,
        "wires": [
            [
                "9a132183.4d71"
            ]
        ]
    },
    {
        "id": "9a132183.4d71",
        "type": "ui_toast",
        "z": "b7f67da0.fbf1",
        "position": "bottom right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "topic": "",
        "name": "",
        "x": 1254,
        "y": 2723,
        "wires": []
    },
    {
        "id": "c6b8ea30.00e938",
        "type": "ui_button",
        "z": "b7f67da0.fbf1",
        "name": "",
        "group": "fe94277c.dcd118",
        "order": 6,
        "width": 6,
        "height": 1,
        "passthru": false,
        "label": "Stoppa Samba",
        "tooltip": "Stoppar fildelningsservern och sätter NibePi i läsläge",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "",
        "x": 325,
        "y": 2772,
        "wires": [
            [
                "b6efd9d4.d18858"
            ]
        ]
    },
    {
        "id": "b6efd9d4.d18858",
        "type": "exec",
        "z": "b7f67da0.fbf1",
        "command": "sudo service smbd stop",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 565,
        "y": 2772,
        "wires": [
            [],
            [],
            [
                "38046291.6ece6e"
            ]
        ]
    },
    {
        "id": "38046291.6ece6e",
        "type": "switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "property": "payload.code",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 871,
        "y": 2786,
        "wires": [
            [
                "d4c42e0f.896dd"
            ]
        ]
    },
    {
        "id": "fa2d2ae9.938078",
        "type": "ui_button",
        "z": "b7f67da0.fbf1",
        "name": "",
        "group": "fe94277c.dcd118",
        "order": 7,
        "width": 6,
        "height": 1,
        "passthru": false,
        "label": "Starta om Node-RED",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "Startar om Node-RED",
        "payloadType": "str",
        "topic": "",
        "x": 178,
        "y": 2898,
        "wires": [
            [
                "9a132183.4d71",
                "796d2d88.6cda84"
            ]
        ]
    },
    {
        "id": "7e7da779.2a9ea8",
        "type": "exec",
        "z": "b7f67da0.fbf1",
        "command": "sudo service nodered restart",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 1030,
        "y": 2898,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "85d5ca03.843578",
        "type": "ui_button",
        "z": "b7f67da0.fbf1",
        "name": "",
        "group": "fe94277c.dcd118",
        "order": 8,
        "width": 6,
        "height": 1,
        "passthru": false,
        "label": "Starta om NibePi hårdvara",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "Startar om NibePi hårdvara",
        "payloadType": "str",
        "topic": "",
        "x": 205,
        "y": 2968,
        "wires": [
            [
                "fb6e013f.6f056"
            ]
        ]
    },
    {
        "id": "1601f8.7c0cee09",
        "type": "exec",
        "z": "b7f67da0.fbf1",
        "command": "sudo reboot",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 672,
        "y": 2968,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "d4c42e0f.896dd",
        "type": "change",
        "z": "b7f67da0.fbf1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Samba stoppad.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1060,
        "y": 2786,
        "wires": [
            [
                "9a132183.4d71"
            ]
        ]
    },
    {
        "id": "d0af1b69.cb7df8",
        "type": "ui_text_input",
        "z": "df0dd648.98daa8",
        "name": "",
        "label": "Latitud",
        "tooltip": "",
        "group": "33ed6fb8.2f3ce",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "lat",
        "x": 918,
        "y": 28,
        "wires": [
            [
                "c49768ba.b813b8"
            ]
        ]
    },
    {
        "id": "18e3ee8f.596ea1",
        "type": "ui_text_input",
        "z": "df0dd648.98daa8",
        "name": "",
        "label": "Longitud",
        "tooltip": "",
        "group": "33ed6fb8.2f3ce",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "lon",
        "x": 928,
        "y": 77,
        "wires": [
            [
                "8dd7f637.d92b68"
            ]
        ]
    },
    {
        "id": "d3afa237.f2b84",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "home",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "lat",
                "type": "str"
            }
        ],
        "x": 1238,
        "y": 28,
        "wires": [
            [
                "d0af1b69.cb7df8"
            ],
            []
        ]
    },
    {
        "id": "4bd5cd01.e7f284",
        "type": "subflow:c191a5d.5d76258",
        "z": "df0dd648.98daa8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "home",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "lon",
                "type": "str"
            }
        ],
        "x": 1238,
        "y": 77,
        "wires": [
            [
                "18e3ee8f.596ea1"
            ],
            []
        ]
    },
    {
        "id": "65bf37a8.e18928",
        "type": "ui_text",
        "z": "960078e.e3e6d88",
        "group": "f481a5f0.f9f1c8",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "SmartPrice Info 2",
        "label": "",
        "format": "Alla åtgärder ska däremot nollställas för att NibePi ska kunna styra.",
        "layout": "row-spread",
        "x": 853,
        "y": 679,
        "wires": []
    },
    {
        "id": "d383b3f8.c2437",
        "type": "function",
        "z": "960078e.e3e6d88",
        "name": "",
        "func": "var output = [{Tibber:\"tibber\"},{Nibe:\"nibe\"}];\nif(msg.payload===undefined || msg.payload===10) {\n    output = [{Tibber:\"tibber\"}];\n}\n\nnode.send({options:output});",
        "outputs": 1,
        "noerr": 0,
        "x": 127,
        "y": 1078,
        "wires": [
            [
                "2ec7e694.30d2ea"
            ]
        ]
    },
    {
        "id": "50e1598f.5e01d8",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "source",
                "type": "str"
            }
        ],
        "x": 419,
        "y": 1232,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "321fde4.84f6d22",
        "type": "function",
        "z": "960078e.e3e6d88",
        "name": "",
        "func": "if(msg.payload===false) {\n    msg.payload = \"\";\n    msg.topic = \"source\";\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 246,
        "y": 1232,
        "wires": [
            [
                "50e1598f.5e01d8"
            ]
        ]
    },
    {
        "id": "4a8d9c43.5fb4c4",
        "type": "nibe-input",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "40083",
        "add": false,
        "x": 78,
        "y": 3073,
        "wires": [
            [
                "837ea411.ac0fd8"
            ],
            []
        ]
    },
    {
        "id": "e3cb9196.ba931",
        "type": "nibe-input",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "40081",
        "add": false,
        "x": 85,
        "y": 3122,
        "wires": [
            [
                "d959527f.53779"
            ],
            []
        ]
    },
    {
        "id": "94c9449e.eb7068",
        "type": "nibe-input",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "40079",
        "add": false,
        "x": 85,
        "y": 3171,
        "wires": [
            [
                "c9b81c0b.6a708"
            ],
            []
        ]
    },
    {
        "id": "7190cf5b.062c2",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "let data = context.get('data')||{};\nif(msg.topic==\"40083\") {\n    data.L1 = msg.payload;\n} else if(msg.topic==\"40081\") {\n    data.L2 = msg.payload;\n} else if(msg.topic==\"40079\") {\n    data.L3 = msg.payload;\n}\ncontext.set('data',data);\nif(data.L1!==undefined && data.L2!==undefined && data.L3!==undefined) {\n    let ampere = data.L1+data.L2+data.L3;\nlet volt = 230;\nlet watt = Number((volt*ampere).toFixed(0));\nnode.send({topic:\"Förbrukning\",payload:watt})\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 399,
        "y": 3122,
        "wires": [
            [
                "649fa78e.58fc48",
                "e0eef71b.f47198",
                "4d701d7a.3c5a54"
            ]
        ]
    },
    {
        "id": "649fa78e.58fc48",
        "type": "debug",
        "z": "b7f67da0.fbf1",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 616,
        "y": 3073,
        "wires": []
    },
    {
        "id": "e0eef71b.f47198",
        "type": "ui_chart",
        "z": "b7f67da0.fbf1",
        "name": "",
        "group": "6dbad083.a9946",
        "order": 0,
        "width": 0,
        "height": 0,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "Inga värden än.",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "24",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 589,
        "y": 3122,
        "wires": [
            []
        ]
    },
    {
        "id": "6f65686e.7365c8",
        "type": "inject",
        "z": "b7f67da0.fbf1",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "x": 336,
        "y": 3206,
        "wires": [
            [
                "4d701d7a.3c5a54"
            ]
        ]
    },
    {
        "id": "558394be.fe0c4c",
        "type": "ui_ui_control",
        "z": "b7f67da0.fbf1",
        "name": "Disable Group S2",
        "events": "all",
        "x": 776,
        "y": 3206,
        "wires": [
            []
        ]
    },
    {
        "id": "4d701d7a.3c5a54",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Enable/Disable",
        "func": "if(msg.topic!==\"\") {\n    let hide = {\n        \"group\":\n            {\"show\":\n                [\"Startsida_Förbrukning_strömavkännare\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n} else {\n    let hide = {\n        \"group\":\n            {\"hide\":\n                [\"Startsida_Förbrukning_strömavkännare\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 521,
        "y": 3206,
        "wires": [
            [],
            [
                "558394be.fe0c4c"
            ]
        ]
    },
    {
        "id": "837ea411.ac0fd8",
        "type": "smooth",
        "z": "b7f67da0.fbf1",
        "name": "",
        "property": "payload",
        "action": "mean",
        "count": "5",
        "round": "1",
        "mult": "single",
        "x": 228,
        "y": 3073,
        "wires": [
            [
                "7190cf5b.062c2"
            ]
        ]
    },
    {
        "id": "d959527f.53779",
        "type": "smooth",
        "z": "b7f67da0.fbf1",
        "name": "",
        "property": "payload",
        "action": "mean",
        "count": "5",
        "round": "1",
        "mult": "single",
        "x": 228,
        "y": 3115,
        "wires": [
            [
                "7190cf5b.062c2"
            ]
        ]
    },
    {
        "id": "c9b81c0b.6a708",
        "type": "smooth",
        "z": "b7f67da0.fbf1",
        "name": "",
        "property": "payload",
        "action": "mean",
        "count": "5",
        "round": "1",
        "mult": "single",
        "x": 228,
        "y": 3157,
        "wires": [
            [
                "7190cf5b.062c2"
            ]
        ]
    },
    {
        "id": "9886b52.83c6e48",
        "type": "ui_slider",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "label": "Luftflöde",
        "tooltip": "",
        "group": "ad7a33f3.24adf",
        "order": 5,
        "width": "0",
        "height": "0",
        "passthru": false,
        "outs": "end",
        "topic": "fan/speed_normal",
        "min": "0",
        "max": "350",
        "step": "1",
        "x": 627,
        "y": 511,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "e5304c27.2e273",
        "type": "ui_switch",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "label": "Aktivera",
        "tooltip": "",
        "group": "ad7a33f3.24adf",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "fan/enable",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 634,
        "y": 217,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "9a373f08.e2c5a",
        "type": "ui_switch",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "label": "Aktivera",
        "tooltip": "",
        "group": "b7178cee.09314",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "fan/enable_low",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 634,
        "y": 266,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "58301c4f.167164",
        "type": "ui_slider",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "label": "Luftflöde",
        "tooltip": "",
        "group": "b7178cee.09314",
        "order": 4,
        "width": "0",
        "height": "0",
        "passthru": false,
        "outs": "end",
        "topic": "fan/speed_low",
        "min": "0",
        "max": "350",
        "step": "1",
        "x": 634,
        "y": 364,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "ed6e5604.1f1578",
        "type": "nibe-fan",
        "z": "ae9d7ce8.0991c",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "adjust": "0.5",
        "x": 1008,
        "y": 336,
        "wires": [
            [
                "ab0bb3.7711f45",
                "cbe9662e.b59308"
            ],
            []
        ]
    },
    {
        "id": "4683a850.88e2a8",
        "type": "subflow:c191a5d.5d76258",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "fan",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable",
                "type": "str"
            }
        ],
        "x": 426,
        "y": 217,
        "wires": [
            [
                "e5304c27.2e273"
            ],
            [
                "a496d010.6c77",
                "6f0a5487.09f7cc"
            ]
        ]
    },
    {
        "id": "bcd35f12.d08cd",
        "type": "subflow:c191a5d.5d76258",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "fan",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable_low",
                "type": "str"
            }
        ],
        "x": 426,
        "y": 266,
        "wires": [
            [
                "9a373f08.e2c5a"
            ],
            [
                "47ca21a6.83d04"
            ]
        ]
    },
    {
        "id": "b0cdbf5.a69164",
        "type": "subflow:c191a5d.5d76258",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "fan",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "speed_normal",
                "type": "str"
            }
        ],
        "x": 419,
        "y": 511,
        "wires": [
            [
                "9886b52.83c6e48"
            ],
            []
        ]
    },
    {
        "id": "719c398d.1630c8",
        "type": "subflow:c191a5d.5d76258",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "fan",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "speed_low",
                "type": "str"
            }
        ],
        "x": 426,
        "y": 364,
        "wires": [
            [
                "58301c4f.167164"
            ],
            []
        ]
    },
    {
        "id": "74d64c2d.aaa2a4",
        "type": "ui_switch",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "label": "Aktivera CO2 Givare",
        "tooltip": "",
        "group": "ad7a33f3.24adf",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "fan/enable_co2",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 667,
        "y": 462,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "22979e72.4c48e2",
        "type": "subflow:c191a5d.5d76258",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "fan",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable_co2",
                "type": "str"
            }
        ],
        "x": 419,
        "y": 462,
        "wires": [
            [
                "74d64c2d.aaa2a4"
            ],
            [
                "7a6dc14e.40cc7",
                "cb402e2a.43c7e"
            ]
        ]
    },
    {
        "id": "a76c0feb.f55a6",
        "type": "ui_button",
        "z": "ae9d7ce8.0991c",
        "name": "Uppdatera",
        "group": "ad7a33f3.24adf",
        "order": 8,
        "width": 12,
        "height": 1,
        "passthru": false,
        "label": "Uppdatera",
        "tooltip": "Begär ny data och uppdatera med nya värden.",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "update",
        "x": 644,
        "y": 175,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "abc6da05.fbe198",
        "type": "ui_ui_control",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "events": "all",
        "x": 130,
        "y": 952,
        "wires": [
            [
                "c5f6096b.79b828"
            ]
        ]
    },
    {
        "id": "c5f6096b.79b828",
        "type": "function",
        "z": "ae9d7ce8.0991c",
        "name": "Lufthastighet",
        "func": "var timeSaved = context.get('time')||(Date.now()-1000);\nvar time = Date.now();\nif(msg.name==\"Automatiskt luftflöde\") {\n    if(time>timeSaved) {\n        context.set('time',(time+30000));\n        return msg;\n    }\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 280,
        "y": 952,
        "wires": [
            [
                "b8e637ad.f4c198"
            ]
        ]
    },
    {
        "id": "b8e637ad.f4c198",
        "type": "nibe-request",
        "z": "ae9d7ce8.0991c",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 323,
        "y": 994,
        "wires": [
            [],
            [
                "996fbcf2.8cd2b",
                "ac979e91.e8a4c",
                "9e8f4c75.ef72d"
            ]
        ]
    },
    {
        "id": "589ada4b.bd1974",
        "type": "nibe-input",
        "z": "ae9d7ce8.0991c",
        "server": "844659a2.8d8508",
        "name": "Config",
        "add": false,
        "x": 323,
        "y": 1036,
        "wires": [
            [
                "996fbcf2.8cd2b"
            ],
            []
        ]
    },
    {
        "id": "996fbcf2.8cd2b",
        "type": "function",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "func": "var sensors = msg.payload.home.inside_sensors||[];\nvar output = [\"Ingen\"];\nfor (const arr of sensors) {\n    output.push(arr.name)\n}\nif(output!==undefined && output!==[]) {\n    node.send({options:output});\n    if(msg.payload.fan!==undefined) {\n        node.send({payload:msg.payload.fan.sensor})\n    }\n    \n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 617,
        "y": 1036,
        "wires": [
            [
                "ae39397.22484c8"
            ]
        ]
    },
    {
        "id": "ae39397.22484c8",
        "type": "ui_dropdown",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "label": "Välj CO2 Givare",
        "tooltip": "",
        "place": "Välj",
        "group": "ad7a33f3.24adf",
        "order": 4,
        "width": "0",
        "height": "0",
        "passthru": false,
        "options": [
            {
                "label": "",
                "value": "",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "fan/sensor",
        "x": 815,
        "y": 1036,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "a496d010.6c77",
        "type": "function",
        "z": "ae9d7ce8.0991c",
        "name": "Enable/Disable Fan",
        "func": "let source = msg.payload.fan.enable;\nif(source===true) {\n    msg = {\n    enabled:true\n};\nreturn msg;\n} else if(source===false) {\n    msg = {\n    enabled:false\n};\n\nreturn msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 559,
        "y": 105,
        "wires": [
            [
                "a76c0feb.f55a6",
                "9a373f08.e2c5a",
                "74d64c2d.aaa2a4",
                "9886b52.83c6e48",
                "58301c4f.167164",
                "ae39397.22484c8",
                "19d59f35.ad8c81",
                "a843b767.1617d8",
                "c7e4714f.38ce"
            ]
        ]
    },
    {
        "id": "7a6dc14e.40cc7",
        "type": "function",
        "z": "ae9d7ce8.0991c",
        "name": "Enable/Disable CO2",
        "func": "let source = msg.payload.fan.enable_co2;\nlet fan = msg.payload.fan.enable;\n\nif(fan===true && source===true) {\n    msg = {\n    enabled:true\n};\nreturn msg;\n} else if(fan===false || source===false) {\n    msg = {\n    enabled:false\n};\n\nreturn msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 828,
        "y": 105,
        "wires": [
            [
                "ae39397.22484c8",
                "77fb0198.0185f",
                "d1a7d601.f79028",
                "30a5c5df.10574a"
            ]
        ]
    },
    {
        "id": "47ca21a6.83d04",
        "type": "function",
        "z": "ae9d7ce8.0991c",
        "name": "Enable/Disable Low Speed",
        "func": "let source = msg.payload.fan.enable_low;\nlet fan = msg.payload.fan.enable;\nif(fan===true && source===true) {\n    msg = {\n    enabled:true\n};\nreturn msg;\n} else if(fan===false || source===false) {\n    msg = {\n    enabled:false\n};\n\nreturn msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1100,
        "y": 105,
        "wires": [
            [
                "58301c4f.167164",
                "e5a59b16.947138"
            ]
        ]
    },
    {
        "id": "92d4347e.266668",
        "type": "ui_chart",
        "z": "960078e.e3e6d88",
        "name": "Elprisreglering S2",
        "group": "ab2b8fca.17eca",
        "order": 2,
        "width": 0,
        "height": 0,
        "label": "",
        "chartType": "line",
        "legend": "true",
        "xformat": "dd HH:mm",
        "interpolate": "step",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "48",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 839,
        "y": 518,
        "wires": [
            []
        ]
    },
    {
        "id": "e324889.d71b078",
        "type": "ui_button",
        "z": "960078e.e3e6d88",
        "name": "Uppdatera S2",
        "group": "ab2b8fca.17eca",
        "order": 3,
        "width": 12,
        "height": 1,
        "passthru": false,
        "label": "Uppdatera",
        "tooltip": "Begär ny data och uppdatera med nya värden.",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "update",
        "x": 269,
        "y": 511,
        "wires": [
            [
                "aa3b6866.eabab8"
            ]
        ]
    },
    {
        "id": "ab0bb3.7711f45",
        "type": "function",
        "z": "ae9d7ce8.0991c",
        "name": "Enable/Disable",
        "func": "if(msg.enabled!==undefined && msg.enabled===false) {\n    node.send(msg);\n    let hide = {\n        \"tabs\":\n            {\"hide\":\n                [\"Lufthastighet\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n} else if(msg.enabled===true) {\n    let hide = {\n        \"tabs\":\n            {\"show\":\n                [\"Lufthastighet\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 1116,
        "y": 560,
        "wires": [
            [],
            [
                "facd1c67.c3335"
            ]
        ]
    },
    {
        "id": "facd1c67.c3335",
        "type": "ui_ui_control",
        "z": "ae9d7ce8.0991c",
        "name": "Disable Group FAN",
        "events": "all",
        "x": 1203,
        "y": 665,
        "wires": [
            []
        ]
    },
    {
        "id": "d66d8ffa.7d44e",
        "type": "subflow:c191a5d.5d76258",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "fan",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "speed_high",
                "type": "str"
            }
        ],
        "x": 363,
        "y": 665,
        "wires": [
            [
                "30a5c5df.10574a"
            ],
            []
        ]
    },
    {
        "id": "30a5c5df.10574a",
        "type": "ui_slider",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "label": "Luftflöde",
        "tooltip": "",
        "group": "2ed5a2d7.ca08ce",
        "order": 4,
        "width": "0",
        "height": "0",
        "passthru": false,
        "outs": "end",
        "topic": "fan/speed_high",
        "min": "0",
        "max": "350",
        "step": "1",
        "x": 571,
        "y": 665,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "6ffbfe56.1c967",
        "type": "subflow:c191a5d.5d76258",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "fan",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "low_co2_limit",
                "type": "str"
            }
        ],
        "x": 426,
        "y": 315,
        "wires": [
            [
                "f648d408.d5b588"
            ],
            []
        ]
    },
    {
        "id": "f648d408.d5b588",
        "type": "ui_slider",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "label": "Gränsvärde CO2",
        "tooltip": "",
        "group": "b7178cee.09314",
        "order": 3,
        "width": "0",
        "height": "0",
        "passthru": false,
        "outs": "end",
        "topic": "fan/low_co2_limit",
        "min": "450",
        "max": "2000",
        "step": "25",
        "x": 664,
        "y": 315,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "e0513d92.b889e",
        "type": "subflow:c191a5d.5d76258",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "fan",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "low_cpr_freq",
                "type": "str"
            }
        ],
        "x": 419,
        "y": 413,
        "wires": [
            [
                "e5a59b16.947138"
            ],
            []
        ]
    },
    {
        "id": "e5a59b16.947138",
        "type": "ui_slider",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "label": "Kompressorfrekvens",
        "tooltip": "",
        "group": "b7178cee.09314",
        "order": 5,
        "width": "0",
        "height": "0",
        "passthru": false,
        "outs": "end",
        "topic": "fan/low_cpr_freq",
        "min": "0",
        "max": "120",
        "step": "1",
        "x": 667,
        "y": 413,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "cb402e2a.43c7e",
        "type": "function",
        "z": "ae9d7ce8.0991c",
        "name": "Enable/Disable CO2",
        "func": "let source = msg.payload.fan.enable_co2;\nlet low = msg.payload.fan.enable_low;\n\nif(low===true && source===true) {\n    msg = {\n    enabled:true\n};\nreturn msg;\n} else if(low===false || source===false) {\n    msg = {\n    enabled:false\n};\n\nreturn msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 401,
        "y": 56,
        "wires": [
            [
                "f648d408.d5b588",
                "b62f2b0b.3d3248"
            ]
        ]
    },
    {
        "id": "d1a7d601.f79028",
        "type": "ui_switch",
        "z": "ae9d7ce8.0991c",
        "name": "Öka luftflöde",
        "label": "Aktivera",
        "tooltip": "",
        "group": "2ed5a2d7.ca08ce",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "fan/enable_high",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 581,
        "y": 616,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "bc4f9345.f18b2",
        "type": "subflow:c191a5d.5d76258",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "fan",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable_high",
                "type": "str"
            }
        ],
        "x": 363,
        "y": 616,
        "wires": [
            [
                "d1a7d601.f79028"
            ],
            []
        ]
    },
    {
        "id": "19d59f35.ad8c81",
        "type": "ui_text",
        "z": "ae9d7ce8.0991c",
        "group": "b7178cee.09314",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "Sänk luftflöde",
        "label": "",
        "format": "Sänk luftflöde vid låg kompressorfrekvens",
        "layout": "row-left",
        "x": 430,
        "y": 161,
        "wires": []
    },
    {
        "id": "77fb0198.0185f",
        "type": "ui_text",
        "z": "ae9d7ce8.0991c",
        "group": "2ed5a2d7.ca08ce",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "Öka luftflöde",
        "label": "",
        "format": "Öka luftflödet vid högt CO2 värde",
        "layout": "row-left",
        "x": 581,
        "y": 574,
        "wires": []
    },
    {
        "id": "79edcd08.1549e4",
        "type": "ui_button",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "group": "7c351fda.75426",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Kalibrera",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "fan/filter_value",
        "x": 452,
        "y": 798,
        "wires": [
            [
                "bca3f91a.05d358",
                "69cad340.fdb3ac"
            ]
        ]
    },
    {
        "id": "a843b767.1617d8",
        "type": "ui_switch",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "label": "Aktivera",
        "tooltip": "",
        "group": "7c351fda.75426",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "fan/enable_filter",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 452,
        "y": 749,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "6eb1a695.518348",
        "type": "subflow:c191a5d.5d76258",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "fan",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable_filter",
                "type": "str"
            }
        ],
        "x": 258,
        "y": 749,
        "wires": [
            [
                "a843b767.1617d8"
            ],
            []
        ]
    },
    {
        "id": "c7e4714f.38ce",
        "type": "ui_text",
        "z": "ae9d7ce8.0991c",
        "group": "7c351fda.75426",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "Filterrengöring",
        "label": "",
        "format": "Aktivera för påminnelse om dåligt filter, vid rengjort filter tryck på kalibrera.",
        "layout": "row-left",
        "x": 465,
        "y": 707,
        "wires": []
    },
    {
        "id": "69cad340.fdb3ac",
        "type": "function",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "func": "node.send({topic:\"fan/filter_value_low\",payload:-1});\nnode.send({topic:\"fan/filter_value_normal\",payload:-1});\nnode.send({topic:\"fan/filter_cleaned\",payload:Date.now()})",
        "outputs": 1,
        "noerr": 0,
        "x": 834,
        "y": 812,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "ac979e91.e8a4c",
        "type": "function",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "func": "if(msg.payload.fan.filter_cleaned!==undefined) {\n    msg.payload = getFormattedDate(new Date(msg.payload.fan.filter_cleaned));\nreturn msg;\n}\n\nfunction getFormattedDate(date) {\n    var year = date.getFullYear();\n    var month = date.getMonth() + 1;\n    var day = date.getDate();\n    var hour = date.getHours();\n    var min = date.getMinutes();\n    var sec = date.getSeconds();\n\n    month = (month < 10 ? \"0\" : \"\") + month;\n    day = (day < 10 ? \"0\" : \"\") + day;\n    hour = (hour < 10 ? \"0\" : \"\") + hour;\n    min = (min < 10 ? \"0\" : \"\") + min;\n    sec = (sec < 10 ? \"0\" : \"\") + sec;\n\n    var str = year+\"-\"+month+\"-\"+day+\" \"+hour + \":\" + min;\n\n    /*alert(str);*/\n\n    return str;\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 470,
        "y": 889,
        "wires": [
            [
                "dfda48a5.0eeb08"
            ]
        ]
    },
    {
        "id": "dfda48a5.0eeb08",
        "type": "ui_text",
        "z": "ae9d7ce8.0991c",
        "group": "7c351fda.75426",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Senaste kalibrering",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 706,
        "y": 889,
        "wires": []
    },
    {
        "id": "6f0a5487.09f7cc",
        "type": "function",
        "z": "ae9d7ce8.0991c",
        "name": "Enable/Disable Filter clean",
        "func": "let source = msg.payload.fan.enable_filter;\nlet fan = msg.payload.fan.enable;\n\nif(fan===true && source===true) {\n    msg = {\n    enabled:true\n};\nreturn msg;\n} else if(fan===false || source===false) {\n    msg = {\n    enabled:false\n};\n\nreturn msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1079,
        "y": 749,
        "wires": [
            [
                "79edcd08.1549e4"
            ]
        ]
    },
    {
        "id": "bca3f91a.05d358",
        "type": "nibe-request",
        "z": "ae9d7ce8.0991c",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 302,
        "y": 889,
        "wires": [
            [],
            [
                "ac979e91.e8a4c"
            ]
        ]
    },
    {
        "id": "cbe9662e.b59308",
        "type": "switch",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Filtereffektivitet",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 449,
        "y": 945,
        "wires": [
            [
                "d823fe7b.5a50b"
            ]
        ]
    },
    {
        "id": "d823fe7b.5a50b",
        "type": "ui_text",
        "z": "ae9d7ce8.0991c",
        "group": "7c351fda.75426",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Effektivitet",
        "format": "{{msg.payload}} %",
        "layout": "row-spread",
        "x": 622,
        "y": 945,
        "wires": []
    },
    {
        "id": "c49768ba.b813b8",
        "type": "function",
        "z": "df0dd648.98daa8",
        "name": "",
        "func": "let len = msg.payload.length;\nif(len>8) {\n    msg.payload = msg.payload.slice(0, 8)\n}\nif(msg.payload.includes(',')) {\n    msg.payload = msg.payload.replace(',','.');\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1058,
        "y": 28,
        "wires": [
            [
                "d3afa237.f2b84"
            ]
        ]
    },
    {
        "id": "8dd7f637.d92b68",
        "type": "function",
        "z": "df0dd648.98daa8",
        "name": "",
        "func": "let len = msg.payload.length;\nif(len>8) {\n    msg.payload = msg.payload.slice(0, 8)\n}\nif(msg.payload.includes(',')) {\n    msg.payload = msg.payload.replace(',','.');\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1058,
        "y": 77,
        "wires": [
            [
                "4bd5cd01.e7f284"
            ]
        ]
    },
    {
        "id": "ba1e9bfe.f81a78",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "let len = msg.payload.length;\nif(len>8) {\n    msg.payload = msg.payload.slice(0, 8)\n}\nif(msg.payload.includes(',')) {\n    msg.payload = msg.payload.replace(',','.');\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 967,
        "y": 525,
        "wires": [
            [
                "8b79bac6.370258"
            ]
        ]
    },
    {
        "id": "18984de6.08fc72",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "let len = msg.payload.length;\nif(len>8) {\n    msg.payload = msg.payload.slice(0, 8)\n}\nif(msg.payload.includes(',')) {\n    msg.payload = msg.payload.replace(',','.');\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 967,
        "y": 574,
        "wires": [
            [
                "3118479a.5faed8"
            ]
        ]
    },
    {
        "id": "f6b17d9d.b4c6e",
        "type": "inject",
        "z": "b7f67da0.fbf1",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "1200",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "x": 301,
        "y": 3759,
        "wires": [
            [
                "4ed7b706.b4b118"
            ]
        ]
    },
    {
        "id": "c73f62f9.35885",
        "type": "http request",
        "z": "b7f67da0.fbf1",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": false,
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 819,
        "y": 3640,
        "wires": [
            [
                "94043003.338d"
            ]
        ]
    },
    {
        "id": "5258d0c8.5b55d",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "var config = msg.config;\nvar flows = msg.flows_ts;\nvar nodered = msg.nodered_ts;\nvar nibepi = msg.nibepi_ts;\nmsg.info = msg.payload;\nlet release = config.update.release;\nif(release.includes('snapshot')) {\nif(flows>config.update.flows || config.update.flows===undefined || nodered>config.update.nodered || config.update.nodered===undefined || nibepi>config.update.nibepi || config.update.nibepi===undefined) {\n    newUpdate();\n} else {\n    node.send({enabled:false});\n    node.send([null,null,null,{enabled:false,payload:\"\"}]);\n}\n} else {\n    let version;\n    let newVersion;\n    newVersion = msg.version.replace(/\\./g,\"\");\n    if(newVersion.length===2) newVersion = newVersion+\"0\";\n    newVersion = Number(newVersion);\n    if(config.update.version!==undefined) {\n        version = config.update.version.replace(/\\./g,\"\");\n        if(version.length===2) version = version+\"0\";\n        version = Number(version);\n    }\n    if(version===undefined || version<newVersion) {\n        newUpdate();\n    } else {\n        node.send({enabled:false});\n        node.send([null,null,null,{enabled:false,payload:\"\"}]);\n    }\n}\nfunction toTimestamp(strDate) {\n    var datum = Date.parse(strDate);\n    return Number((datum).toFixed());\n}\nfunction newUpdate() {\n    node.send([null,null,{payload:\"Ny uppdatering tillgängling\"}]);\n    node.send([null,null,null,{enabled:true,payload:msg.info}]);\n    node.send({enabled:true});\n    msg.topic = \"timestamp\";\n    node.send([null,msg]);\n}",
        "outputs": 4,
        "noerr": 0,
        "x": 1072,
        "y": 3689,
        "wires": [
            [
                "12696e02.7efa42"
            ],
            [
                "45747834.4faa58"
            ],
            [
                "b306062e.fd90b8"
            ],
            [
                "28a0d61e.83686a"
            ]
        ]
    },
    {
        "id": "94043003.338d",
        "type": "xml",
        "z": "b7f67da0.fbf1",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 967,
        "y": 3640,
        "wires": [
            [
                "c9bb3f92.46ce"
            ]
        ]
    },
    {
        "id": "35a698b.0a7a168",
        "type": "ui_button",
        "z": "b7f67da0.fbf1",
        "name": "",
        "group": "d814a7db.5cdc38",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": true,
        "label": "Kolla efter uppdateringar",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "",
        "x": 215,
        "y": 3710,
        "wires": [
            [
                "4ed7b706.b4b118"
            ]
        ]
    },
    {
        "id": "91a0740e.6b2bd8",
        "type": "ui_dropdown",
        "z": "b7f67da0.fbf1",
        "name": "Välj version",
        "label": "Version",
        "tooltip": "",
        "place": "Välj version",
        "group": "d814a7db.5cdc38",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "options": [
            {
                "label": "1.1 Beta",
                "value": "master",
                "type": "str"
            },
            {
                "label": "1.1-Snapshot",
                "value": "snapshot",
                "type": "str"
            },
            {
                "label": "ENGLISH: Snapshot",
                "value": "snapshot-EN",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "release",
        "x": 189,
        "y": 3584,
        "wires": [
            [
                "4ed7b706.b4b118",
                "aec4152f.dac168",
                "deed783f.d98498"
            ]
        ]
    },
    {
        "id": "5c76619d.bbf42",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "let config = msg.config;\nif(config.update===undefined) return;\nif(config.update.release===undefined) return;\nif(config.update.release==\"master\" || config.update.release==\"english\") {\n    msg.url = \"https://github.com/anerdins/node-red-contrib-nibepi/commits/master.atom\";\n} else if(config.update.release==\"snapshot\" || config.update.release==\"snapshot-EN\") {\n    msg.url = \"https://github.com/anerdins/node-red-contrib-nibepi/commits/snapshot.atom\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 645,
        "y": 3640,
        "wires": [
            [
                "c73f62f9.35885"
            ]
        ]
    },
    {
        "id": "4ed7b706.b4b118",
        "type": "nibe-request",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 453,
        "y": 3696,
        "wires": [
            [
                "38a6e41d.bbf2fc"
            ],
            []
        ]
    },
    {
        "id": "12696e02.7efa42",
        "type": "ui_button",
        "z": "b7f67da0.fbf1",
        "name": "",
        "group": "d814a7db.5cdc38",
        "order": 10,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Uppdatera NibePi",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "update",
        "x": 650,
        "y": 3696,
        "wires": [
            [
                "ce6c9aaf.cb21b8",
                "2615b7fa.27ee48"
            ]
        ]
    },
    {
        "id": "45747834.4faa58",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "if(msg.topic==\"timestamp\") {\n    context.set('save',msg);\n} else if(msg.topic==\"update\") {\n    let config = msg.config;\n    msg = context.get('save');\n    if(msg===undefined) return;\n    node.send(msg)\n    node.send([null,{payload:\"Letar efter Node-RED mappen...\"}])\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 939,
        "y": 3724,
        "wires": [
            [
                "aa4bd201.8ed27"
            ],
            [
                "b306062e.fd90b8"
            ]
        ]
    },
    {
        "id": "e12a676c.8d8b18",
        "type": "exec",
        "z": "b7f67da0.fbf1",
        "command": "find / -type f -name 'flows.json' 2>/dev/null | sed -r 's|/[^/]+$||' |sort |uniq",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 551,
        "y": 3829,
        "wires": [
            [
                "d86e4714.abb088"
            ],
            [],
            []
        ]
    },
    {
        "id": "b306062e.fd90b8",
        "type": "ui_toast",
        "z": "b7f67da0.fbf1",
        "position": "bottom right",
        "displayTime": "30",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "topic": "",
        "name": "",
        "x": 1196,
        "y": 3759,
        "wires": []
    },
    {
        "id": "d86e4714.abb088",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "let len = (msg.payload.match(/\\n/g) || []).length;\nlet release = msg.config.update.release;\nif(release.includes('snapshot')) release = \"snapshot\";\nif(len>1) {\n    node.send([null,{payload:\"Flera Node-RED mappar hittade, avbryter..\"}])\n} else if(len===1) {\n    let path = msg.payload;\n    path = path.replace('\\n','');\n    msg.path = path;\n    msg.payload = `sudo mount -o remount,rw / && cd ${path} && npm uninstall node-red-contrib-nibepi && npm install --save anerdins/node-red-contrib-nibepi#${release}`\n    node.send([msg,{payload:\"Node-RED mapp hittad.\\nUppdaterar...\"}])\n} else {\n    node.send([null,{payload:\"Node-RED mapp inte hittad. Avbryter.\"}])\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 925,
        "y": 3836,
        "wires": [
            [
                "b484a46d.2b3da8"
            ],
            [
                "b306062e.fd90b8"
            ]
        ]
    },
    {
        "id": "41ce5656.0a7778",
        "type": "exec",
        "z": "b7f67da0.fbf1",
        "command": "",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "Update modules",
        "x": 1263,
        "y": 3857,
        "wires": [
            [],
            [],
            [
                "e19707f8.8ba388"
            ]
        ]
    },
    {
        "id": "ce6c9aaf.cb21b8",
        "type": "nibe-request",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 785,
        "y": 3724,
        "wires": [
            [
                "b578486a.7078d8",
                "b27c8dd9.02c3e",
                "44d61721.dc1b18"
            ],
            []
        ]
    },
    {
        "id": "49987b8d.2c48a4",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "let config = msg.config;\nif(config.update===undefined) return;\nif(config.update.release===undefined) return;\nlet url = \"https://github.com/anerdins/nibepi/commits/master.atom\";\nif(config.update.release==\"master\") {\n    url = \"https://github.com/anerdins/nibepi/commits/master.atom\";\n} else if(config.update.release==\"english\") {\n    url = \"https://github.com/anerdins/nibepi/commits/master.atom\";\n} else if(config.update.release==\"snapshot\") {\n    url = \"https://github.com/anerdins/nibepi/commits/snapshot.atom\";\n} else if(config.update.release==\"snapshot-EN\") {\n    url = \"https://github.com/anerdins/nibepi/commits/snapshot.atom\";\n}\nmsg.url = url;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 771,
        "y": 3591,
        "wires": [
            [
                "e1247ca8.92464"
            ]
        ]
    },
    {
        "id": "fc85e8f6.e60e88",
        "type": "xml",
        "z": "b7f67da0.fbf1",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 1065,
        "y": 3591,
        "wires": [
            [
                "c073c1d0.ff677"
            ]
        ]
    },
    {
        "id": "e1247ca8.92464",
        "type": "http request",
        "z": "b7f67da0.fbf1",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": false,
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 917,
        "y": 3591,
        "wires": [
            [
                "fc85e8f6.e60e88"
            ]
        ]
    },
    {
        "id": "e19707f8.8ba388",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "if(msg.payload.code===0) {\n    let config = msg.config;\n    msg.payload = `sudo mount -o remount,rw / && cd /tmp && wget https://raw.githubusercontent.com/anerdins/nibepi-flow/${config.update.release}/flows.json && cd /tmp && mv -f flows.json ${msg.path}/flows.json`;\n    node.send({payload:\"Lddar ner nya flöden till Node-RED\"});\n    node.send([null,msg]);\n} else {\n    node.send({payload:\"Uppdatering misslyckades.\"});\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 530,
        "y": 4018,
        "wires": [
            [
                "b306062e.fd90b8"
            ],
            [
                "23964a7b.8ed066"
            ]
        ]
    },
    {
        "id": "c9bb3f92.46ce",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "msg.nodered_ts = toTimestamp(msg.payload.feed.entry[0].updated[0]);\nreturn msg;\n\nfunction toTimestamp(strDate) {\n    var datum = Date.parse(strDate);\n    return Number((datum).toFixed());\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 645,
        "y": 3591,
        "wires": [
            [
                "49987b8d.2c48a4"
            ]
        ]
    },
    {
        "id": "c073c1d0.ff677",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "msg.nibepi_ts = toTimestamp(msg.payload.feed.entry[0].updated[0]);\nlet config = msg.config;\nmsg.url = `https://raw.githubusercontent.com/anerdins/nibepi-flow/${config.update.release}/update/VERSION`\nreturn msg;\n\nfunction toTimestamp(strDate) {\n    var datum = Date.parse(strDate);\n    return Number((datum).toFixed());\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 1191,
        "y": 3591,
        "wires": [
            [
                "8078efd.50ea21"
            ]
        ]
    },
    {
        "id": "18cf4e22.f69a12",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Reset after changing source",
        "func": "let config = msg.config;\nif(config.update===undefined) return;\nif(config.update.release===undefined) return;\nif(config.update.release!==msg.payload) {\n    config.update.nodered = undefined;\n    config.update.nibepi = undefined;\n    config.update.version = undefined;\n    config.update.flows = undefined;\n    node.send({payload:config});\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 442,
        "y": 3913,
        "wires": [
            [
                "de4b40e1.dc59f"
            ]
        ]
    },
    {
        "id": "248e79f9.40a626",
        "type": "exec",
        "z": "b7f67da0.fbf1",
        "command": "",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "Update Node-RED flows",
        "x": 894,
        "y": 4074,
        "wires": [
            [],
            [],
            [
                "52a5b4de.76949c"
            ]
        ]
    },
    {
        "id": "52a5b4de.76949c",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "if(msg.payload.code===0) {\n    let config = msg.config;\n    node.send({payload:\"Uppdatering färdig, startar om Node-RED om 10 sekunder\"});\n    config.update.nodered = msg.nodered_ts;\n    config.update.nibepi = msg.nibepi_ts;\n    config.update.version = msg.version;\n    config.update.flows  = msg.flows_ts;\n    node.send([null,{payload:config}]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 1190,
        "y": 4058,
        "wires": [
            [
                "b306062e.fd90b8"
            ],
            [
                "de4b40e1.dc59f",
                "236a4859.181cd8"
            ]
        ]
    },
    {
        "id": "8078efd.50ea21",
        "type": "http request",
        "z": "b7f67da0.fbf1",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": false,
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1190,
        "y": 3535,
        "wires": [
            [
                "a4011ffd.a20ff"
            ]
        ]
    },
    {
        "id": "a4011ffd.a20ff",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "let config = msg.config;\nmsg.version = msg.payload.replace('\\n','');\nmsg.url = `https://raw.githubusercontent.com/anerdins/nibepi-flow/${config.update.release}/update/INFO`\nreturn msg;\n\nfunction toTimestamp(strDate) {\n    var datum = Date.parse(strDate);\n    return Number((datum).toFixed());\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 1270,
        "y": 3638,
        "wires": [
            [
                "8277de5d.5fbb"
            ]
        ]
    },
    {
        "id": "8277de5d.5fbb",
        "type": "http request",
        "z": "b7f67da0.fbf1",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": false,
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1290,
        "y": 3678,
        "wires": [
            [
                "5258d0c8.5b55d"
            ]
        ]
    },
    {
        "id": "28a0d61e.83686a",
        "type": "ui_text",
        "z": "b7f67da0.fbf1",
        "group": "d814a7db.5cdc38",
        "order": 11,
        "width": "12",
        "height": "10",
        "name": "",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "x": 1270,
        "y": 3798,
        "wires": []
    },
    {
        "id": "aa4bd201.8ed27",
        "type": "delay",
        "z": "b7f67da0.fbf1",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "3",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 620,
        "y": 3766,
        "wires": [
            [
                "e12a676c.8d8b18"
            ]
        ]
    },
    {
        "id": "b484a46d.2b3da8",
        "type": "delay",
        "z": "b7f67da0.fbf1",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "3",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1089,
        "y": 3850,
        "wires": [
            [
                "41ce5656.0a7778"
            ]
        ]
    },
    {
        "id": "23964a7b.8ed066",
        "type": "delay",
        "z": "b7f67da0.fbf1",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "3",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 683,
        "y": 4060,
        "wires": [
            [
                "248e79f9.40a626"
            ]
        ]
    },
    {
        "id": "39529b5d.472af4",
        "type": "exec",
        "z": "b7f67da0.fbf1",
        "command": "sudo service nodered restart",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "Restart Node-RED",
        "x": 1190,
        "y": 4178,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "525036.2cc69fcc",
        "type": "delay",
        "z": "b7f67da0.fbf1",
        "name": "",
        "pauseType": "delay",
        "timeout": "15",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "3",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 980,
        "y": 4178,
        "wires": [
            [
                "39529b5d.472af4"
            ]
        ]
    },
    {
        "id": "aec4152f.dac168",
        "type": "nibe-request",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 190,
        "y": 3898,
        "wires": [
            [
                "18cf4e22.f69a12"
            ],
            []
        ]
    },
    {
        "id": "de4b40e1.dc59f",
        "type": "nibe-output",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "setConfig",
        "x": 907,
        "y": 3997,
        "wires": [
            []
        ]
    },
    {
        "id": "4d847a7a.c8ab04",
        "type": "ui_ui_control",
        "z": "b7f67da0.fbf1",
        "name": "",
        "events": "change",
        "x": 80,
        "y": 3658,
        "wires": [
            [
                "c283e2a2.d69fb"
            ]
        ]
    },
    {
        "id": "c283e2a2.d69fb",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Settings",
        "func": "if(msg.name==\"Settings\") {\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 227,
        "y": 3658,
        "wires": [
            [
                "6c307fc7.0310d"
            ]
        ]
    },
    {
        "id": "6c307fc7.0310d",
        "type": "delay",
        "z": "b7f67da0.fbf1",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "60",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 450,
        "y": 3658,
        "wires": [
            [
                "4ed7b706.b4b118"
            ]
        ]
    },
    {
        "id": "b27c8dd9.02c3e",
        "type": "change",
        "z": "b7f67da0.fbf1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Startar uppdatering",
                "tot": "str"
            },
            {
                "t": "delete",
                "p": "topic",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 903,
        "y": 3528,
        "wires": [
            [
                "b306062e.fd90b8"
            ]
        ]
    },
    {
        "id": "b578486a.7078d8",
        "type": "delay",
        "z": "b7f67da0.fbf1",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "3",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 833,
        "y": 3772,
        "wires": [
            [
                "45747834.4faa58"
            ]
        ]
    },
    {
        "id": "6fca90d2.2ce3",
        "type": "ui_text",
        "z": "b7f67da0.fbf1",
        "group": "d814a7db.5cdc38",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "Uppdatering info",
        "label": "Välj vilken version du vill köra med. Efter färdig uppdatering startar Node-RED om.",
        "format": "",
        "layout": "row-left",
        "x": 667,
        "y": 3549,
        "wires": []
    },
    {
        "id": "2615b7fa.27ee48",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "Disable Update button",
        "func": "msg = {\n    enabled:false\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 743,
        "y": 3885,
        "wires": [
            [
                "12696e02.7efa42"
            ]
        ]
    },
    {
        "id": "deed783f.d98498",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "update",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "release",
                "type": "str"
            }
        ],
        "x": 419,
        "y": 3584,
        "wires": [
            [
                "91a0740e.6b2bd8"
            ],
            []
        ]
    },
    {
        "id": "3d914215.23382e",
        "type": "function",
        "z": "51e88f22.62d4a",
        "name": "Set base path",
        "func": "var filename = msg.req.params.fn;\nvar basePath = \"/tmp/\";\nif(filename==\"config.json\") {\n    basePath = \"/etc/nibepi/\"\n}\n\n\n\n\nif(filename.includes(\"..\\\\\")){\n    msg.payload = \"Illegal file path\";\n    msg.statusCode = 405;//not allowed\n    return [null, msg];//fire output 2\n} else if(filename.includes(\"../\")){\n    msg.payload = \"Illegal file path\";\n    msg.statusCode = 405;//not allowed\n    return [null, msg];//fire output 2\n} \n//TODO: add more checks\n\nmsg.filename = basePath + filename;\nreturn [msg, null];//fire output 1\n\n\n",
        "outputs": 2,
        "noerr": 0,
        "x": 367,
        "y": 161,
        "wires": [
            [
                "427c7f2c.19d4a"
            ],
            [
                "ea437e79.1ed52"
            ]
        ]
    },
    {
        "id": "ea437e79.1ed52",
        "type": "http response",
        "z": "51e88f22.62d4a",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 848,
        "y": 189,
        "wires": []
    },
    {
        "id": "427c7f2c.19d4a",
        "type": "file in",
        "z": "51e88f22.62d4a",
        "name": "",
        "filename": "",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "x": 557,
        "y": 141,
        "wires": [
            [
                "ea437e79.1ed52"
            ]
        ]
    },
    {
        "id": "390ce923.2e6c06",
        "type": "catch",
        "z": "51e88f22.62d4a",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 187,
        "y": 241,
        "wires": [
            [
                "a63d0dba.f50ef",
                "d9cf9a8e.2293a8"
            ]
        ]
    },
    {
        "id": "a63d0dba.f50ef",
        "type": "function",
        "z": "51e88f22.62d4a",
        "name": "Set 404",
        "func": "msg.payload = msg.error;\nmsg.statusCode = 404;//resource not found\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 567,
        "y": 241,
        "wires": [
            [
                "ea437e79.1ed52"
            ]
        ]
    },
    {
        "id": "d9cf9a8e.2293a8",
        "type": "debug",
        "z": "51e88f22.62d4a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 217,
        "y": 281,
        "wires": []
    },
    {
        "id": "73edb218.ca480c",
        "type": "ui_template",
        "z": "51e88f22.62d4a",
        "group": "4aaf21c9.38fb8",
        "name": "ui_temlplate - present download links on dashboard",
        "order": 0,
        "width": 0,
        "height": 0,
        "format": "<style>\n    var redirect = function() {\n    window.location.href = \"/files/nibepi.log\";\n    }\n</style>\n<div>\n\n<button onclick=\"redirect()\">Download</button>\n\n<div class=\"my_content_container\">\n    <a href=\"/files/nibepi.log\">Ladda ner logg</a>\n</div>\n    <a href=\"/files/config.json\">Download Config file</a>\n</div>\n\n    <style type=\"text/css\">\n.my_content_container a {\n    border-bottom: 1px solid #555555;\n    border-left: 1px solid #555555;\n    border-right: 1px solid #555555;\n    border-top: 1px solid #555555;\n    background: #a80202;\n    color: #FFFFFF;\n    display: block;\n    height: 2.5em;\n    padding: 0 1em;\n    width: 10em;       \n    text-decoration: \"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif\";\n}\n// :hover and :active styles left as an exercise for the reader.\n</style>",
        "storeOutMessages": false,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 557,
        "y": 321,
        "wires": [
            []
        ]
    },
    {
        "id": "e54e869e.f4a778",
        "type": "comment",
        "z": "51e88f22.62d4a",
        "name": "Create http endpoint <nodered>/files/xxx  where xxx is the file name to download",
        "info": "",
        "x": 407,
        "y": 101,
        "wires": []
    },
    {
        "id": "3a69f55a.5aab6a",
        "type": "http in",
        "z": "51e88f22.62d4a",
        "name": "",
        "url": "/files/:fn",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 197,
        "y": 161,
        "wires": [
            [
                "3d914215.23382e",
                "5fc73a10.3fa5e4"
            ]
        ]
    },
    {
        "id": "342405d6.d20f0a",
        "type": "ui_button",
        "z": "51e88f22.62d4a",
        "name": "",
        "group": "97526682.5406d8",
        "order": 8,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Ladda ner logg",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "x": 290,
        "y": 371,
        "wires": [
            [
                "8300d178.63ac6"
            ]
        ]
    },
    {
        "id": "8300d178.63ac6",
        "type": "http request",
        "z": "51e88f22.62d4a",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": false,
        "url": "http://localhost:1880/files/nibepi.log",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 469,
        "y": 371,
        "wires": [
            [
                "db0871dc.cf081",
                "342405d6.d20f0a"
            ]
        ]
    },
    {
        "id": "db0871dc.cf081",
        "type": "debug",
        "z": "51e88f22.62d4a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 638,
        "y": 371,
        "wires": []
    },
    {
        "id": "5fc73a10.3fa5e4",
        "type": "debug",
        "z": "51e88f22.62d4a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 365,
        "y": 210,
        "wires": []
    },
    {
        "id": "34e37b3f.91f4d4",
        "type": "ui_template",
        "z": "51e88f22.62d4a",
        "group": "db563368.2a2e6",
        "name": "blue",
        "order": 4,
        "width": "2",
        "height": "2",
        "format": "\n<md-button class=\"vibrate filled touched bigfont rounded\" style=\"background-color:#2980b9\"   ng-click=\"send({payload: 'Hello World'})\"> \n    Blue<br/>button\n</md-button> \n\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "x": 456,
        "y": 581,
        "wires": [
            []
        ]
    },
    {
        "id": "1f42f1c0.ade17e",
        "type": "ui_template",
        "z": "51e88f22.62d4a",
        "group": "db563368.2a2e6",
        "name": "red",
        "order": 2,
        "width": "2",
        "height": "2",
        "format": "\n<md-button class=\"vibrate filled touched bigfont rounded\" style=\"background-color:#c0392b\" ng-click=\"send({payload: 'Hello World'})\"> \n    Red<br/>button\n</md-button> \n\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 456,
        "y": 501,
        "wires": [
            []
        ]
    },
    {
        "id": "50eaeaf7.460054",
        "type": "ui_template",
        "z": "51e88f22.62d4a",
        "group": "db563368.2a2e6",
        "name": "green",
        "order": 3,
        "width": "2",
        "height": "2",
        "format": "\n<md-button class=\"filled touched bigfont rounded vibrate\" style=\"background-color:#27ae60\" ng-click=\"send({payload: 'Hello World'})\"> \n    Green<br/>button\n</md-button> \n\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "x": 456,
        "y": 541,
        "wires": [
            []
        ]
    },
    {
        "id": "4450e418.ad604c",
        "type": "ui_template",
        "z": "51e88f22.62d4a",
        "group": "db563368.2a2e6",
        "name": "",
        "order": 5,
        "width": "2",
        "height": "1",
        "format": "\n<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#16a085\"   ng-click=\"send({payload: 'Hello World'})\"> \n    Blue<br/>button\n</md-button> \n\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "x": 466,
        "y": 661,
        "wires": [
            []
        ]
    },
    {
        "id": "325d5e4e.9c5862",
        "type": "ui_template",
        "z": "51e88f22.62d4a",
        "group": "db563368.2a2e6",
        "name": "",
        "order": 6,
        "width": "2",
        "height": "1",
        "format": "\n<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\" ng-click=\"send({payload: 'Hello World'})\"> \n    Red<br/>button\n</md-button> \n\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "x": 466,
        "y": 621,
        "wires": [
            []
        ]
    },
    {
        "id": "8e2fcfe.d61853",
        "type": "ui_template",
        "z": "51e88f22.62d4a",
        "group": "db563368.2a2e6",
        "name": "on",
        "order": 7,
        "width": "1",
        "height": "1",
        "format": "\n<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#34495e\" ng-click=\"send({payload: 'Hello World'})\"> \n    On\n</md-button> \n\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "x": 456,
        "y": 701,
        "wires": [
            []
        ]
    },
    {
        "id": "1bfdfc43.688954",
        "type": "ui_template",
        "z": "51e88f22.62d4a",
        "group": "db563368.2a2e6",
        "name": "off",
        "order": 8,
        "width": "1",
        "height": "1",
        "format": "\n<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#8e44ad\" ng-click=\"send({payload: 'Hello World'})\"> \n    Off\n</md-button> \n\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "x": 456,
        "y": 741,
        "wires": [
            []
        ]
    },
    {
        "id": "89764535.4921b8",
        "type": "ui_template",
        "z": "51e88f22.62d4a",
        "group": "db563368.2a2e6",
        "name": "stuff",
        "order": 0,
        "width": "0",
        "height": "0",
        "format": "<style>\n  .filled { \n      height: 100% !important;\n\n      padding: 0 !important;\n      margin: 0 !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 18px;\n}\n\n   .smallfont {\n  font-size: 12px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    navigator.vibrate(80);\n    });\n    \n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 336,
        "y": 501,
        "wires": [
            []
        ]
    },
    {
        "id": "399a6d3c.af0fb2",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "msg.flows_ts = toTimestamp(msg.payload.feed.entry[0].updated[0]);\nreturn msg;\n\nfunction toTimestamp(strDate) {\n    var datum = Date.parse(strDate);\n    return Number((datum).toFixed());\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 372,
        "y": 3451,
        "wires": [
            [
                "5c76619d.bbf42"
            ]
        ]
    },
    {
        "id": "3f6bdb98.dc2144",
        "type": "xml",
        "z": "b7f67da0.fbf1",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 694,
        "y": 3500,
        "wires": [
            [
                "399a6d3c.af0fb2"
            ]
        ]
    },
    {
        "id": "9b7681f.840428",
        "type": "http request",
        "z": "b7f67da0.fbf1",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": false,
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 546,
        "y": 3500,
        "wires": [
            [
                "3f6bdb98.dc2144"
            ]
        ]
    },
    {
        "id": "38a6e41d.bbf2fc",
        "type": "function",
        "z": "b7f67da0.fbf1",
        "name": "",
        "func": "let config = msg.config;\nif(config.update===undefined) return;\nif(config.update.release===undefined) return;\nif(config.update.release==\"master\" || config.update.release==\"english\") {\n    msg.url = \"https://github.com/anerdins/nibepi-flow/commits/master.atom\";\n} else if(config.update.release==\"snapshot\" || config.update.release==\"snapshot-EN\") {\n    msg.url = \"https://github.com/anerdins/nibepi-flow/commits/snapshot.atom\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 372,
        "y": 3500,
        "wires": [
            [
                "9b7681f.840428"
            ]
        ]
    },
    {
        "id": "b62f2b0b.3d3248",
        "type": "ui_slider",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "label": "Gränsvärde CO2",
        "tooltip": "",
        "group": "2ed5a2d7.ca08ce",
        "order": 3,
        "width": "0",
        "height": "0",
        "passthru": false,
        "outs": "end",
        "topic": "fan/high_co2_limit",
        "min": "450",
        "max": "2000",
        "step": "25",
        "x": 867,
        "y": 49,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "bd230e5b.604cd",
        "type": "subflow:c191a5d.5d76258",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "fan",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "low_co2_limit",
                "type": "str"
            }
        ],
        "x": 629,
        "y": 49,
        "wires": [
            [
                "b62f2b0b.3d3248"
            ],
            []
        ]
    },
    {
        "id": "a0c72050.1c73a",
        "type": "ui_text",
        "z": "fa4686d6.c21688",
        "group": "bcb5f9e4.9bc858",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Vid stort uttag av varmvatten så kan tillfällig lyx startas automatiskt. Ställ in gränsvärden här nedan.",
        "format": "",
        "layout": "row-left",
        "x": 1019,
        "y": 28,
        "wires": []
    },
    {
        "id": "bc411f62.b5f87",
        "type": "ui_text",
        "z": "fa4686d6.c21688",
        "group": "38b6d907.520796",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Om tappvarmvattnet understiger den minsta inställda nivån så startar varmvattenproduktion direkt.",
        "format": "",
        "layout": "row-left",
        "x": 1019,
        "y": 112,
        "wires": []
    },
    {
        "id": "7bac2960.6ef798",
        "type": "nibe-request",
        "z": "eee76599.b5f0d8",
        "server": "844659a2.8d8508",
        "name": "rmu_s1",
        "x": 543,
        "y": 56,
        "wires": [
            [],
            [
                "60e3b487.efea2c"
            ]
        ]
    },
    {
        "id": "60e3b487.efea2c",
        "type": "ui_switch",
        "z": "eee76599.b5f0d8",
        "name": "",
        "label": "RMU40 System 1",
        "tooltip": "",
        "group": "6356450b.b9318c",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 748,
        "y": 56,
        "wires": [
            [
                "a8806c73.18578"
            ]
        ]
    },
    {
        "id": "a8806c73.18578",
        "type": "nibe-output",
        "z": "eee76599.b5f0d8",
        "server": "844659a2.8d8508",
        "name": "rmu_s1",
        "x": 942,
        "y": 56,
        "wires": [
            [
                "60e3b487.efea2c"
            ]
        ]
    },
    {
        "id": "e817a238.c8734",
        "type": "nibe-request",
        "z": "eee76599.b5f0d8",
        "server": "844659a2.8d8508",
        "name": "rmu_s2",
        "x": 543,
        "y": 105,
        "wires": [
            [],
            [
                "f83ba770.b754d8"
            ]
        ]
    },
    {
        "id": "f83ba770.b754d8",
        "type": "ui_switch",
        "z": "eee76599.b5f0d8",
        "name": "",
        "label": "RMU40 System 2",
        "tooltip": "",
        "group": "6356450b.b9318c",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 748,
        "y": 105,
        "wires": [
            [
                "4c596cb9.9e6a44"
            ]
        ]
    },
    {
        "id": "4c596cb9.9e6a44",
        "type": "nibe-output",
        "z": "eee76599.b5f0d8",
        "server": "844659a2.8d8508",
        "name": "rmu_s2",
        "x": 942,
        "y": 105,
        "wires": [
            [
                "f83ba770.b754d8"
            ]
        ]
    },
    {
        "id": "6cbef66.4c31208",
        "type": "nibe-request",
        "z": "eee76599.b5f0d8",
        "server": "844659a2.8d8508",
        "name": "rmu_s3",
        "x": 543,
        "y": 154,
        "wires": [
            [],
            [
                "f680e178.2e0ef"
            ]
        ]
    },
    {
        "id": "f680e178.2e0ef",
        "type": "ui_switch",
        "z": "eee76599.b5f0d8",
        "name": "",
        "label": "RMU40 System 3",
        "tooltip": "",
        "group": "6356450b.b9318c",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "x": 748,
        "y": 154,
        "wires": [
            [
                "f9cc9213.15fb9"
            ]
        ]
    },
    {
        "id": "f9cc9213.15fb9",
        "type": "nibe-output",
        "z": "eee76599.b5f0d8",
        "server": "844659a2.8d8508",
        "name": "rmu_s3",
        "x": 942,
        "y": 154,
        "wires": [
            [
                "f680e178.2e0ef"
            ]
        ]
    },
    {
        "id": "b670321d.7c74e",
        "type": "ui_template",
        "z": "b7f67da0.fbf1",
        "group": "da1887c7.ca0d38",
        "name": "Förord",
        "order": 0,
        "width": 0,
        "height": 0,
        "format": "<div>\n    <h2>NibePi</h2>\n    <p>NibePi är IoT produkten som både gör värmepumpen smartare och effektivare. Med hjälp av MQTT så kan värmepumpen övervakas och styras direkt från det smarta hemmet.<br>\nDet finns flera inbyggda funktioner som kan förbättra komforten och ekonomin. Mer information finns under varje funktion.<br>\n<p>NibePi stödjer alla värmepumpar i Nibes F serie, samt elpannor med tillhörande utedel i VVM serien.<br>\nNibe F370,F470,F730,F750,F1145,F1155,F1245,F1255,F1345,F1355<br>\nVVM 225,310,320,325,500<br></p>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 883,
        "y": 35,
        "wires": [
            []
        ]
    },
    {
        "id": "288c389e.6a59c8",
        "type": "ui_template",
        "z": "b7f67da0.fbf1",
        "group": "fb207b28.da59b8",
        "name": "Extra givare 1",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<p>Extra givare 1</p>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 307,
        "y": 1883,
        "wires": [
            []
        ]
    },
    {
        "id": "6386c6ec.d2c768",
        "type": "ui_template",
        "z": "b7f67da0.fbf1",
        "group": "97526682.5406d8",
        "name": "Loggning info 1",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<p>Loggning 1</p>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 542,
        "y": 2177,
        "wires": [
            []
        ]
    },
    {
        "id": "b41bece3.1e5d4",
        "type": "ui_template",
        "z": "b7f67da0.fbf1",
        "group": "fe94277c.dcd118",
        "name": "Avancerat 1",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<p>Avancerat 1</p>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 791,
        "y": 77,
        "wires": [
            []
        ]
    },
    {
        "id": "4dc4d83.408c428",
        "type": "ui_template",
        "z": "b7f67da0.fbf1",
        "group": "723a0250.fd7dcc",
        "name": "MQTT 1",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<p>MQTT 1</p>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 508,
        "y": 371,
        "wires": [
            []
        ]
    },
    {
        "id": "ae03bb3e.814858",
        "type": "ui_template",
        "z": "b7f67da0.fbf1",
        "group": "da3c0db0.9c6aa",
        "name": "System 1",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<p>System 1</p>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 956,
        "y": 343,
        "wires": [
            []
        ]
    },
    {
        "id": "2b72a94c.b56806",
        "type": "ui_template",
        "z": "b7f67da0.fbf1",
        "group": "605e2041.0137e",
        "name": "Värmekurva S1",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<p>Värmekurva S1</p>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 535,
        "y": 490,
        "wires": [
            []
        ]
    },
    {
        "id": "41b97d73.686ca4",
        "type": "ui_template",
        "z": "b7f67da0.fbf1",
        "group": "ea24545a.5d7038",
        "name": "Värmekurva S2",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<p>Värmekurva S2</p>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 626,
        "y": 539,
        "wires": [
            []
        ]
    },
    {
        "id": "12889531.e5d9eb",
        "type": "ui_template",
        "z": "eee76599.b5f0d8",
        "group": "6356450b.b9318c",
        "name": "RMU 1",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<p>RMU 1</p>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 193,
        "y": 77,
        "wires": [
            []
        ]
    },
    {
        "id": "fe27461e.7e1e48",
        "type": "function",
        "z": "eee76599.b5f0d8",
        "name": "Enable/Disable",
        "func": "if(msg.enabled!==undefined && msg.enabled===true) {\n    let hide = {\n        \"group\":\n            {\"show\":\n                [\"Inställningar_RMU40_S1\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n} else if(msg.enabled===false) {\n    let hide = {\n        \"group\":\n            {\"hide\":\n                [\"Inställningar_RMU40_S1\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 990,
        "y": 315,
        "wires": [
            [],
            [
                "c7cde5a3.053a28"
            ]
        ]
    },
    {
        "id": "c7cde5a3.053a28",
        "type": "ui_ui_control",
        "z": "eee76599.b5f0d8",
        "name": "Disable Group S1",
        "events": "all",
        "x": 1217,
        "y": 308,
        "wires": [
            []
        ]
    },
    {
        "id": "31e5b9cb.625536",
        "type": "ui_template",
        "z": "b7f67da0.fbf1",
        "group": "a8bf2b6e.6abc18",
        "name": "Husinfo text",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<div>\n    <p>För att använda Prognosreglering behöver husets koordinater anges.<br>\n    Fastighetens storlek anges i kvm (Uppvärmd yta) och används för att beräkna rätt flöde\n    för frånluftsvärmepumpar med automatiskt luftflöde<br></p>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 1008,
        "y": 203,
        "wires": [
            []
        ]
    },
    {
        "id": "655c24ec.f9bbdc",
        "type": "ui_text_input",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Fastighetens storlek",
        "tooltip": "",
        "group": "a8bf2b6e.6abc18",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "number",
        "delay": "0",
        "topic": "size",
        "x": 1024,
        "y": 245,
        "wires": [
            [
                "6de034de.5247fc"
            ]
        ]
    },
    {
        "id": "6de034de.5247fc",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "home",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "size",
                "type": "str"
            }
        ],
        "x": 1259,
        "y": 245,
        "wires": [
            [
                "655c24ec.f9bbdc"
            ],
            []
        ]
    },
    {
        "id": "b658a3a0.78523",
        "type": "ui_template",
        "z": "ae9d7ce8.0991c",
        "group": "ad7a33f3.24adf",
        "name": "Hus storlek info",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<div ng-bind-html=\"msg.payload\"></div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 647,
        "y": 1113,
        "wires": [
            []
        ]
    },
    {
        "id": "9e8f4c75.ef72d",
        "type": "function",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "func": "let config = msg.payload;\nif(config.home.size!==undefined && config.home.size!==0 && config.home.size!==\"\") {\n    msg.payload = `<p>Det minsta rekommenderade flödet för fastigheten är ${(config.home.size*0.35*3.6).toFixed(0)} m3/h</p>`\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 477,
        "y": 1113,
        "wires": [
            [
                "b658a3a0.78523"
            ]
        ]
    },
    {
        "id": "67261556.74310c",
        "type": "subflow:c191a5d.5d76258",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "fan",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable_dm_boost",
                "type": "str"
            }
        ],
        "x": 356,
        "y": 1274,
        "wires": [
            [
                "d71ebd3b.ad766"
            ],
            []
        ]
    },
    {
        "id": "d71ebd3b.ad766",
        "type": "ui_switch",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "label": "Aktivera",
        "tooltip": "",
        "group": "ffc74889.8cb7c8",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "fan/enable_dm_boost",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 564,
        "y": 1274,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "be8822b2.3c387",
        "type": "ui_slider",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "label": "Luftflöde",
        "tooltip": "",
        "group": "ffc74889.8cb7c8",
        "order": 5,
        "width": "0",
        "height": "0",
        "passthru": false,
        "outs": "end",
        "topic": "fan/dm_boost_value",
        "min": "0",
        "max": "350",
        "step": "1",
        "x": 564,
        "y": 1323,
        "wires": [
            [
                "ed6e5604.1f1578"
            ]
        ]
    },
    {
        "id": "a8750e84.a53ad",
        "type": "subflow:c191a5d.5d76258",
        "z": "ae9d7ce8.0991c",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "fan",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "dm_boost_value",
                "type": "str"
            }
        ],
        "x": 356,
        "y": 1323,
        "wires": [
            [
                "be8822b2.3c387"
            ],
            []
        ]
    },
    {
        "id": "81922b16.db9638",
        "type": "ui_text",
        "z": "ae9d7ce8.0991c",
        "group": "ffc74889.8cb7c8",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "Gradminut boost",
        "label": "",
        "format": "För att öka effektiviteten på kompressorn så kan luftflödet öka när gradminuterna börjar närma sig start för tillsats.",
        "layout": "row-left",
        "x": 559,
        "y": 1225,
        "wires": []
    },
    {
        "id": "d78784c9.e2bbc8",
        "type": "ui_switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Automatiskt luftflöde",
        "tooltip": "",
        "group": "97526682.5406d8",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "fan",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 331,
        "y": 2471,
        "wires": [
            [
                "9ba7c561.6e6b08"
            ]
        ]
    },
    {
        "id": "9ba7c561.6e6b08",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "log",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "fan",
                "type": "str"
            }
        ],
        "x": 545,
        "y": 2471,
        "wires": [
            [
                "d78784c9.e2bbc8"
            ],
            []
        ]
    },
    {
        "id": "4249c2be.4caddc",
        "type": "debug",
        "z": "b7f67da0.fbf1",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 322,
        "y": 1344,
        "wires": []
    },
    {
        "id": "b0e24ccb.86c35",
        "type": "ui_switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Spara grafer",
        "tooltip": "",
        "group": "da3c0db0.9c6aa",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "save_graph",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 406,
        "y": 2107,
        "wires": [
            [
                "aa96a81d.82d6c8"
            ]
        ]
    },
    {
        "id": "aa96a81d.82d6c8",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "system",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "save_graph",
                "type": "str"
            }
        ],
        "x": 630,
        "y": 2107,
        "wires": [
            [
                "b0e24ccb.86c35"
            ],
            []
        ]
    },
    {
        "id": "796d2d88.6cda84",
        "type": "nibe-output",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "saveGraph",
        "x": 567,
        "y": 2898,
        "wires": [
            [
                "7e7da779.2a9ea8"
            ]
        ]
    },
    {
        "id": "fb6e013f.6f056",
        "type": "nibe-output",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "saveGraph",
        "x": 469,
        "y": 2968,
        "wires": [
            [
                "1601f8.7c0cee09"
            ]
        ]
    },
    {
        "id": "236a4859.181cd8",
        "type": "nibe-output",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "saveGraph",
        "x": 1099,
        "y": 4123,
        "wires": [
            [
                "525036.2cc69fcc"
            ]
        ]
    },
    {
        "id": "5e0de75.c411d18",
        "type": "nibe-request",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 253,
        "y": 1582,
        "wires": [
            [],
            [
                "79bf305.f523ad"
            ]
        ]
    },
    {
        "id": "34add1d5.a2b94e",
        "type": "debug",
        "z": "b7f67da0.fbf1",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 820,
        "y": 1757,
        "wires": []
    },
    {
        "id": "ec00f757.4cdbe8",
        "type": "nibe-graph",
        "z": "65e6bc5.05f2644",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "select": "datagraph",
        "x": 476,
        "y": 252,
        "wires": [
            [
                "d1515232.e5969",
                "8524887c.d97728"
            ],
            []
        ]
    },
    {
        "id": "d1515232.e5969",
        "type": "debug",
        "z": "65e6bc5.05f2644",
        "name": "Graph IN",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 690,
        "y": 294,
        "wires": []
    },
    {
        "id": "71de0e01.6c188",
        "type": "ui_chart",
        "z": "65e6bc5.05f2644",
        "name": "Graf",
        "group": "261b1f51.5c37e",
        "order": 1,
        "width": 0,
        "height": 0,
        "label": "",
        "chartType": "line",
        "legend": "true",
        "xformat": "dd HH:mm",
        "interpolate": "linear",
        "nodata": "Data saknas",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "48",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 1100,
        "y": 231,
        "wires": [
            [
                "606c5425.846fec"
            ]
        ]
    },
    {
        "id": "54623482.22352c",
        "type": "ui_button",
        "z": "65e6bc5.05f2644",
        "name": "Uppdatera",
        "group": "261b1f51.5c37e",
        "order": 2,
        "width": "18",
        "height": "1",
        "passthru": false,
        "label": "Uppdatera",
        "tooltip": "Uppdaterar grafen",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "update",
        "x": 623,
        "y": 140,
        "wires": [
            [
                "ec00f757.4cdbe8"
            ]
        ]
    },
    {
        "id": "63058c8e.1043f4",
        "type": "inject",
        "z": "65e6bc5.05f2644",
        "name": "",
        "topic": "",
        "payload": "[]",
        "payloadType": "json",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 645,
        "y": 189,
        "wires": [
            [
                "71de0e01.6c188"
            ]
        ]
    },
    {
        "id": "4f2c3fe1.ee64c",
        "type": "inject",
        "z": "65e6bc5.05f2644",
        "name": "",
        "topic": "update",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 240,
        "y": 252,
        "wires": [
            [
                "ec00f757.4cdbe8"
            ]
        ]
    },
    {
        "id": "702b6eb2.c73b2",
        "type": "nibe-output",
        "z": "65e6bc5.05f2644",
        "server": "844659a2.8d8508",
        "name": "",
        "x": 1022,
        "y": 378,
        "wires": [
            []
        ]
    },
    {
        "id": "9ffa29c1.b3d8c8",
        "type": "function",
        "z": "65e6bc5.05f2644",
        "name": "Save graph registers",
        "func": "var data = global.get('data');\nvar time = Date.now();\nlet config = msg.config;\nif(config.data===undefined) config.data = {};\nif(config.data.graph===undefined) config.data.graph = [];\nif(msg.payload.isChecked===false) {\n    // Remove register\n    let index = config.data.graph.findIndex(n => n == msg.payload.register);\n    if(index!==-1) {\n        config.data.graph.splice(index);\n        node.send({topic:\"setConfig\",payload:config});\n    } else {\n        // Nothing to remove\n    }\n} else if(msg.payload.isChecked===true) {\n    let index = config.data.graph.findIndex(n => n == msg.payload.register);\n    if(index===-1) {\n        config.data.graph.push(msg.payload.register);\n        node.send({topic:\"setConfig\",payload:config});\n    } else {\n        // Register already exists\n    }\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 765,
        "y": 385,
        "wires": [
            [
                "702b6eb2.c73b2",
                "54e899fa.d59218"
            ]
        ]
    },
    {
        "id": "b58200b4.f0de1",
        "type": "nibe-request",
        "z": "65e6bc5.05f2644",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 554,
        "y": 385,
        "wires": [
            [
                "9ffa29c1.b3d8c8",
                "a9882946.4e8888"
            ],
            []
        ]
    },
    {
        "id": "39af3c28.745144",
        "type": "ui_list",
        "z": "65e6bc5.05f2644",
        "group": "bd199d65.157fc",
        "name": "Data",
        "order": 2,
        "width": "12",
        "height": "11",
        "lineType": "three",
        "actionType": "check",
        "allowHTML": false,
        "outputs": 1,
        "topic": "",
        "x": 414,
        "y": 385,
        "wires": [
            [
                "b58200b4.f0de1"
            ]
        ]
    },
    {
        "id": "7209703c.94e2",
        "type": "nibe-graph",
        "z": "65e6bc5.05f2644",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "select": "registers_selected",
        "x": 234,
        "y": 385,
        "wires": [
            [
                "39af3c28.745144",
                "910decb4.e0a23"
            ],
            []
        ]
    },
    {
        "id": "850769c.f7b9598",
        "type": "inject",
        "z": "65e6bc5.05f2644",
        "name": "",
        "topic": "update",
        "payload": "",
        "payloadType": "date",
        "repeat": "10",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 177,
        "y": 315,
        "wires": [
            [
                "7209703c.94e2"
            ]
        ]
    },
    {
        "id": "910decb4.e0a23",
        "type": "debug",
        "z": "65e6bc5.05f2644",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 533,
        "y": 336,
        "wires": []
    },
    {
        "id": "96122fbe.f0ca2",
        "type": "debug",
        "z": "358baec9.c8b902",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1226,
        "y": 448,
        "wires": []
    },
    {
        "id": "6d821dfd.4142d4",
        "type": "ui_ui_control",
        "z": "65e6bc5.05f2644",
        "name": "",
        "events": "all",
        "x": 333,
        "y": 700,
        "wires": [
            [
                "90aa5691.0f27d8",
                "8524887c.d97728",
                "9e36c8ff.1ecbf8",
                "db88bff5.9059f",
                "fb9ec5ab.879b38",
                "4f496004.61176",
                "82a3ab6e.f68b98",
                "74dba304.b28b2c",
                "1ad79da9.daa052",
                "326e9c2d.201cd4"
            ]
        ]
    },
    {
        "id": "90aa5691.0f27d8",
        "type": "debug",
        "z": "65e6bc5.05f2644",
        "name": "UI",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1093,
        "y": 287,
        "wires": []
    },
    {
        "id": "8524887c.d97728",
        "type": "function",
        "z": "65e6bc5.05f2644",
        "name": "",
        "func": "var ui = msg.payload;\nvar name = msg.name;\nvar tab = \"Datahantering\";\nvar graph = msg.graph;\nvar block = context.get('block')||{};\nif(ui==\"change\") {\n    if(name==tab) {\n        block[msg.socketid] = false;\n        node.send([null,{topic:\"update\"}])\n        \n    } else {\n        block[msg.socketid] = true;\n    }\n} else if(ui==\"lost\") {\n    block[msg.socketid] = true;\n}\nif(graph!==undefined) {\n    let blocked = true;\n    for (var object in block) {\n                    if (block.hasOwnProperty(object)) {\n                        if(block[object]===false) {\n                            blocked = false;\n                        }\n                    }\n                }\n    if(blocked===false) {\n        return msg;\n    } else if(blocked===true) {\n    node.send({payload:[]});\n}\n}\n\ncontext.set('block',block);",
        "outputs": 2,
        "noerr": 0,
        "x": 785,
        "y": 217,
        "wires": [
            [
                "71de0e01.6c188",
                "dc988b21.09bf38"
            ],
            [
                "ec00f757.4cdbe8"
            ]
        ]
    },
    {
        "id": "606c5425.846fec",
        "type": "debug",
        "z": "65e6bc5.05f2644",
        "name": "Graph OUT",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1246,
        "y": 231,
        "wires": []
    },
    {
        "id": "dc988b21.09bf38",
        "type": "debug",
        "z": "65e6bc5.05f2644",
        "name": "NODE",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 981,
        "y": 140,
        "wires": []
    },
    {
        "id": "11630e74.8dac82",
        "type": "inject",
        "z": "65e6bc5.05f2644",
        "name": "",
        "topic": "time",
        "payload": "3",
        "payloadType": "num",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 211,
        "y": 462,
        "wires": [
            [
                "ec00f757.4cdbe8"
            ]
        ]
    },
    {
        "id": "96e42b24.7aaa78",
        "type": "ui_slider",
        "z": "65e6bc5.05f2644",
        "name": "",
        "label": "Tid",
        "tooltip": "",
        "group": "261b1f51.5c37e",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "time",
        "min": 0,
        "max": "72",
        "step": 1,
        "x": 217,
        "y": 504,
        "wires": [
            [
                "ec00f757.4cdbe8"
            ]
        ]
    },
    {
        "id": "c298bb69.805ce8",
        "type": "nibe-graph",
        "z": "65e6bc5.05f2644",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "select": "start_1",
        "x": 451,
        "y": 623,
        "wires": [
            [
                "9e36c8ff.1ecbf8"
            ],
            []
        ]
    },
    {
        "id": "e36871c4.db782",
        "type": "ui_chart",
        "z": "65e6bc5.05f2644",
        "name": "",
        "group": "a8bf2b6e.6abc18",
        "order": 5,
        "width": 0,
        "height": 0,
        "label": "Värmeinformation",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "48",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 853,
        "y": 623,
        "wires": [
            []
        ]
    },
    {
        "id": "b71782d0.0b1ed",
        "type": "ui_slider",
        "z": "65e6bc5.05f2644",
        "name": "",
        "label": "Tid",
        "tooltip": "",
        "group": "a8bf2b6e.6abc18",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "time",
        "min": 0,
        "max": "72",
        "step": 1,
        "x": 246,
        "y": 623,
        "wires": [
            [
                "c298bb69.805ce8"
            ]
        ]
    },
    {
        "id": "a9882946.4e8888",
        "type": "debug",
        "z": "65e6bc5.05f2644",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 578,
        "y": 446,
        "wires": []
    },
    {
        "id": "54e899fa.d59218",
        "type": "debug",
        "z": "65e6bc5.05f2644",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 932,
        "y": 455,
        "wires": []
    },
    {
        "id": "9dbabd89.67234",
        "type": "nibe-graph",
        "z": "65e6bc5.05f2644",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "select": "forecast_1",
        "x": 458,
        "y": 763,
        "wires": [
            [
                "db88bff5.9059f"
            ],
            []
        ]
    },
    {
        "id": "26eb3859.ff5d48",
        "type": "ui_chart",
        "z": "65e6bc5.05f2644",
        "name": "Prognostemperatur S1",
        "group": "7e910a08.c6c984",
        "order": 4,
        "width": "0",
        "height": "0",
        "label": "",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "Data ej tillgängligt",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "24",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 842,
        "y": 763,
        "wires": [
            []
        ]
    },
    {
        "id": "9e36c8ff.1ecbf8",
        "type": "function",
        "z": "65e6bc5.05f2644",
        "name": "",
        "func": "var ui = msg.payload;\nvar name = msg.name;\nvar tab = \"Startsida\";\nvar graph = msg.graph;\nvar block = context.get('block')||{};\nif(ui==\"change\") {\n    if(name==tab) {\n        block[msg.socketid] = false;\n        node.send([null,{topic:\"update\"}])\n        \n    } else {\n        block[msg.socketid] = true;\n    }\n} else if(ui==\"lost\") {\n    block[msg.socketid] = true;\n}\nif(graph!==undefined) {\n    let blocked = true;\n    for (var object in block) {\n                    if (block.hasOwnProperty(object)) {\n                        if(block[object]===false) {\n                            blocked = false;\n                        }\n                    }\n                }\n    if(blocked===false) {\n        return msg;\n    } else if(blocked===true) {\n    node.send({payload:[]});\n}\n}\n\ncontext.set('block',block);",
        "outputs": 2,
        "noerr": 0,
        "x": 652,
        "y": 623,
        "wires": [
            [
                "e36871c4.db782"
            ],
            [
                "c298bb69.805ce8"
            ]
        ]
    },
    {
        "id": "db88bff5.9059f",
        "type": "function",
        "z": "65e6bc5.05f2644",
        "name": "",
        "func": "var ui = msg.payload;\nvar name = msg.name;\nvar tab = \"Prognosreglering\";\nvar graph = msg.graph;\nvar block = context.get('block')||{};\nif(ui==\"change\") {\n    if(name==tab) {\n        block[msg.socketid] = false;\n        node.send([null,{topic:\"update\"}])\n        \n    } else {\n        block[msg.socketid] = true;\n    }\n} else if(ui==\"lost\") {\n    block[msg.socketid] = true;\n}\nif(graph!==undefined) {\n    let blocked = true;\n    for (var object in block) {\n                    if (block.hasOwnProperty(object)) {\n                        if(block[object]===false) {\n                            blocked = false;\n                        }\n                    }\n                }\n    if(blocked===false) {\n        return msg;\n    } else if(blocked===true) {\n    node.send({payload:[]});\n}\n}\n\ncontext.set('block',block);",
        "outputs": 2,
        "noerr": 0,
        "x": 631,
        "y": 763,
        "wires": [
            [
                "26eb3859.ff5d48"
            ],
            [
                "9dbabd89.67234"
            ]
        ]
    },
    {
        "id": "41f84924.bc1198",
        "type": "ui_slider",
        "z": "65e6bc5.05f2644",
        "name": "",
        "label": "Tid",
        "tooltip": "",
        "group": "7e910a08.c6c984",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "time",
        "min": 0,
        "max": "72",
        "step": 1,
        "x": 246,
        "y": 763,
        "wires": [
            [
                "9dbabd89.67234"
            ]
        ]
    },
    {
        "id": "b8e45a29.097168",
        "type": "ui_button",
        "z": "b7f67da0.fbf1",
        "name": "",
        "group": "fe94277c.dcd118",
        "order": 8,
        "width": 6,
        "height": 1,
        "passthru": false,
        "label": "Stäng av NibePi hårdvara",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "Stänger av NibePi",
        "payloadType": "str",
        "topic": "",
        "x": 782,
        "y": 3017,
        "wires": [
            [
                "5ef6c9b8.bf6d08"
            ]
        ]
    },
    {
        "id": "5ef6c9b8.bf6d08",
        "type": "nibe-output",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "saveGraph",
        "x": 1056,
        "y": 3017,
        "wires": [
            [
                "7de64138.6b5d3"
            ]
        ]
    },
    {
        "id": "7de64138.6b5d3",
        "type": "exec",
        "z": "b7f67da0.fbf1",
        "command": "sudo halt",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 1249,
        "y": 3017,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "b881d2a8.569a4",
        "type": "nibe-graph",
        "z": "65e6bc5.05f2644",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "select": "hw_lux",
        "x": 458,
        "y": 896,
        "wires": [
            [
                "fb9ec5ab.879b38"
            ],
            []
        ]
    },
    {
        "id": "fb9ec5ab.879b38",
        "type": "function",
        "z": "65e6bc5.05f2644",
        "name": "",
        "func": "var ui = msg.payload;\nvar name = msg.name;\nvar tab = \"Varmvattenreglering\";\nvar graph = msg.graph;\nvar block = context.get('block')||{};\nif(ui==\"change\") {\n    if(name==tab) {\n        block[msg.socketid] = false;\n        node.send([null,{topic:\"update\"}])\n        \n    } else {\n        block[msg.socketid] = true;\n    }\n} else if(ui==\"lost\") {\n    block[msg.socketid] = true;\n}\nif(graph!==undefined) {\n    let blocked = true;\n    for (var object in block) {\n                    if (block.hasOwnProperty(object)) {\n                        if(block[object]===false) {\n                            blocked = false;\n                        }\n                    }\n                }\n    if(blocked===false) {\n        return msg;\n    } else if(blocked===true) {\n    node.send({payload:[]});\n}\n}\n\ncontext.set('block',block);",
        "outputs": 2,
        "noerr": 0,
        "x": 631,
        "y": 896,
        "wires": [
            [
                "878eb7cb.141428"
            ],
            [
                "b881d2a8.569a4"
            ]
        ]
    },
    {
        "id": "176a8ef5.3e5701",
        "type": "ui_slider",
        "z": "65e6bc5.05f2644",
        "name": "",
        "label": "Tid",
        "tooltip": "",
        "group": "bcb5f9e4.9bc858",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "time",
        "min": 0,
        "max": "72",
        "step": 1,
        "x": 246,
        "y": 896,
        "wires": [
            [
                "b881d2a8.569a4"
            ]
        ]
    },
    {
        "id": "878eb7cb.141428",
        "type": "ui_chart",
        "z": "65e6bc5.05f2644",
        "name": "Automatisk tillfällig lyx",
        "group": "bcb5f9e4.9bc858",
        "order": 5,
        "width": 0,
        "height": 0,
        "label": "",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "48",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 849,
        "y": 896,
        "wires": [
            []
        ]
    },
    {
        "id": "93ac06c3.827608",
        "type": "ui_chart",
        "z": "65e6bc5.05f2644",
        "name": "Varmvatten prioritet",
        "group": "38b6d907.520796",
        "order": 3,
        "width": 0,
        "height": 0,
        "label": "",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "48",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 825,
        "y": 959,
        "wires": [
            []
        ]
    },
    {
        "id": "130583bb.67283c",
        "type": "nibe-graph",
        "z": "65e6bc5.05f2644",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "select": "hw_prio",
        "x": 458,
        "y": 959,
        "wires": [
            [
                "4f496004.61176"
            ],
            []
        ]
    },
    {
        "id": "4f496004.61176",
        "type": "function",
        "z": "65e6bc5.05f2644",
        "name": "",
        "func": "var ui = msg.payload;\nvar name = msg.name;\nvar tab = \"Varmvattenreglering\";\nvar graph = msg.graph;\nvar block = context.get('block')||{};\nif(ui==\"change\") {\n    if(name==tab) {\n        block[msg.socketid] = false;\n        node.send([null,{topic:\"update\"}])\n        \n    } else {\n        block[msg.socketid] = true;\n    }\n} else if(ui==\"lost\") {\n    block[msg.socketid] = true;\n}\nif(graph!==undefined) {\n    let blocked = true;\n    for (var object in block) {\n                    if (block.hasOwnProperty(object)) {\n                        if(block[object]===false) {\n                            blocked = false;\n                        }\n                    }\n                }\n    if(blocked===false) {\n        return msg;\n    } else if(blocked===true) {\n    node.send({payload:[]});\n}\n}\n\ncontext.set('block',block);",
        "outputs": 2,
        "noerr": 0,
        "x": 631,
        "y": 959,
        "wires": [
            [
                "93ac06c3.827608"
            ],
            [
                "130583bb.67283c"
            ]
        ]
    },
    {
        "id": "5662a415.06708c",
        "type": "ui_slider",
        "z": "65e6bc5.05f2644",
        "name": "",
        "label": "Tid",
        "tooltip": "",
        "group": "38b6d907.520796",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "time",
        "min": 0,
        "max": "72",
        "step": 1,
        "x": 246,
        "y": 959,
        "wires": [
            [
                "130583bb.67283c"
            ]
        ]
    },
    {
        "id": "c3d3b2ea.73a9b",
        "type": "nibe-output",
        "z": "b7f67da0.fbf1",
        "server": "844659a2.8d8508",
        "name": "saveGraph",
        "x": 469,
        "y": 3304,
        "wires": [
            []
        ]
    },
    {
        "id": "2dc12b74.a0ebb4",
        "type": "inject",
        "z": "b7f67da0.fbf1",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 238,
        "y": 3304,
        "wires": [
            [
                "c3d3b2ea.73a9b"
            ]
        ]
    },
    {
        "id": "49882825.7b48d8",
        "type": "ui_switch",
        "z": "65e6bc5.05f2644",
        "name": "",
        "label": "Uppdatera grafer med data",
        "tooltip": "Aktiverar att hämta registerdata och uppdatera NibePis interna grafer.",
        "group": "da3c0db0.9c6aa",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "auto_update",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 337,
        "y": 70,
        "wires": [
            [
                "fa95fd50.94cac"
            ]
        ]
    },
    {
        "id": "fa95fd50.94cac",
        "type": "subflow:c191a5d.5d76258",
        "z": "65e6bc5.05f2644",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "system",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "auto_update",
                "type": "str"
            }
        ],
        "x": 587,
        "y": 70,
        "wires": [
            [
                "49882825.7b48d8"
            ],
            []
        ]
    },
    {
        "id": "741e9555.45552c",
        "type": "nibe-graph",
        "z": "65e6bc5.05f2644",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s2",
        "select": "forecast_1",
        "x": 465,
        "y": 819,
        "wires": [
            [
                "82a3ab6e.f68b98"
            ],
            []
        ]
    },
    {
        "id": "82a3ab6e.f68b98",
        "type": "function",
        "z": "65e6bc5.05f2644",
        "name": "",
        "func": "var ui = msg.payload;\nvar name = msg.name;\nvar tab = \"Prognosreglering\";\nvar graph = msg.graph;\nvar block = context.get('block')||{};\nif(ui==\"change\") {\n    if(name==tab) {\n        block[msg.socketid] = false;\n        node.send([null,{topic:\"update\"}])\n        \n    } else {\n        block[msg.socketid] = true;\n    }\n} else if(ui==\"lost\") {\n    block[msg.socketid] = true;\n}\nif(graph!==undefined) {\n    let blocked = true;\n    for (var object in block) {\n                    if (block.hasOwnProperty(object)) {\n                        if(block[object]===false) {\n                            blocked = false;\n                        }\n                    }\n                }\n    if(blocked===false) {\n        return msg;\n    } else if(blocked===true) {\n    node.send({payload:[]});\n}\n}\n\ncontext.set('block',block);",
        "outputs": 2,
        "noerr": 0,
        "x": 638,
        "y": 819,
        "wires": [
            [
                "1045d759.a961c9"
            ],
            [
                "741e9555.45552c"
            ]
        ]
    },
    {
        "id": "e8bbd657.4aa3b8",
        "type": "ui_slider",
        "z": "65e6bc5.05f2644",
        "name": "",
        "label": "Tid",
        "tooltip": "",
        "group": "197ce413.27432c",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "time",
        "min": 0,
        "max": "72",
        "step": 1,
        "x": 253,
        "y": 819,
        "wires": [
            [
                "741e9555.45552c"
            ]
        ]
    },
    {
        "id": "1045d759.a961c9",
        "type": "ui_chart",
        "z": "65e6bc5.05f2644",
        "name": "Prognostemperatur S2",
        "group": "197ce413.27432c",
        "order": 4,
        "width": "0",
        "height": "0",
        "label": "",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "System ej anslutet",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "24",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 842,
        "y": 819,
        "wires": [
            []
        ]
    },
    {
        "id": "1249eda5.8ac642",
        "type": "nibe-graph",
        "z": "65e6bc5.05f2644",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "select": "indoor_1",
        "x": 458,
        "y": 1022,
        "wires": [
            [
                "74dba304.b28b2c"
            ],
            []
        ]
    },
    {
        "id": "74dba304.b28b2c",
        "type": "function",
        "z": "65e6bc5.05f2644",
        "name": "",
        "func": "var ui = msg.payload;\nvar name = msg.name;\nvar tab = \"Inomhusreglering\";\nvar graph = msg.graph;\nvar block = context.get('block')||{};\nif(ui==\"change\") {\n    if(name==tab) {\n        block[msg.socketid] = false;\n        node.send([null,{topic:\"update\"}])\n        \n    } else {\n        block[msg.socketid] = true;\n    }\n} else if(ui==\"lost\") {\n    block[msg.socketid] = true;\n}\nif(graph!==undefined) {\n    let blocked = true;\n    for (var object in block) {\n                    if (block.hasOwnProperty(object)) {\n                        if(block[object]===false) {\n                            blocked = false;\n                        }\n                    }\n                }\n    if(blocked===false) {\n        return msg;\n    } else if(blocked===true) {\n    node.send({payload:[]});\n}\n}\n\ncontext.set('block',block);",
        "outputs": 2,
        "noerr": 0,
        "x": 631,
        "y": 1022,
        "wires": [
            [
                "5f434aee.4ca444"
            ],
            [
                "1249eda5.8ac642"
            ]
        ]
    },
    {
        "id": "a5f5926b.ba0a",
        "type": "ui_slider",
        "z": "65e6bc5.05f2644",
        "name": "",
        "label": "Tid",
        "tooltip": "",
        "group": "a2cfe148.70708",
        "order": 10,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "time",
        "min": 0,
        "max": "72",
        "step": 1,
        "x": 246,
        "y": 1022,
        "wires": [
            [
                "1249eda5.8ac642"
            ]
        ]
    },
    {
        "id": "6b58d375.81bc6c",
        "type": "nibe-graph",
        "z": "65e6bc5.05f2644",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s2",
        "select": "indoor_1",
        "x": 465,
        "y": 1078,
        "wires": [
            [
                "1ad79da9.daa052"
            ],
            []
        ]
    },
    {
        "id": "1ad79da9.daa052",
        "type": "function",
        "z": "65e6bc5.05f2644",
        "name": "",
        "func": "var ui = msg.payload;\nvar name = msg.name;\nvar tab = \"Inomhusreglering\";\nvar graph = msg.graph;\nvar block = context.get('block')||{};\nif(ui==\"change\") {\n    if(name==tab) {\n        block[msg.socketid] = false;\n        node.send([null,{topic:\"update\"}])\n        \n    } else {\n        block[msg.socketid] = true;\n    }\n} else if(ui==\"lost\") {\n    block[msg.socketid] = true;\n}\nif(graph!==undefined) {\n    let blocked = true;\n    for (var object in block) {\n                    if (block.hasOwnProperty(object)) {\n                        if(block[object]===false) {\n                            blocked = false;\n                        }\n                    }\n                }\n    if(blocked===false) {\n        return msg;\n    } else if(blocked===true) {\n    node.send({payload:[]});\n}\n}\n\ncontext.set('block',block);",
        "outputs": 2,
        "noerr": 0,
        "x": 638,
        "y": 1078,
        "wires": [
            [
                "1b015e0a.ec6bc2"
            ],
            [
                "6b58d375.81bc6c"
            ]
        ]
    },
    {
        "id": "a83973b3.c3d1e",
        "type": "ui_slider",
        "z": "65e6bc5.05f2644",
        "name": "",
        "label": "Tid",
        "tooltip": "",
        "group": "6ee1e12a.a6f04",
        "order": 10,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "time",
        "min": 0,
        "max": "72",
        "step": 1,
        "x": 253,
        "y": 1078,
        "wires": [
            [
                "6b58d375.81bc6c"
            ]
        ]
    },
    {
        "id": "1b015e0a.ec6bc2",
        "type": "ui_chart",
        "z": "65e6bc5.05f2644",
        "name": "Inomhusreglering S2",
        "group": "6ee1e12a.a6f04",
        "order": 9,
        "width": "0",
        "height": "0",
        "label": "",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "Data ej tillgängligt ännu.",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "24",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 842,
        "y": 1078,
        "wires": [
            []
        ]
    },
    {
        "id": "5f434aee.4ca444",
        "type": "ui_chart",
        "z": "65e6bc5.05f2644",
        "name": "Inomhusreglering S1",
        "group": "a2cfe148.70708",
        "order": 9,
        "width": "0",
        "height": "0",
        "label": "",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "Data ej tillgängligt ännu.",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "24",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 835,
        "y": 1022,
        "wires": [
            []
        ]
    },
    {
        "id": "b982aa7.a56ab58",
        "type": "ui_chart",
        "z": "65e6bc5.05f2644",
        "name": "Automatiskt luftflöde",
        "group": "ad7a33f3.24adf",
        "order": 6,
        "width": "12",
        "height": "12",
        "label": "",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "24",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 842,
        "y": 1134,
        "wires": [
            []
        ]
    },
    {
        "id": "451cdade.53c734",
        "type": "nibe-graph",
        "z": "65e6bc5.05f2644",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "select": "fan_1",
        "x": 465,
        "y": 1134,
        "wires": [
            [
                "326e9c2d.201cd4"
            ],
            []
        ]
    },
    {
        "id": "326e9c2d.201cd4",
        "type": "function",
        "z": "65e6bc5.05f2644",
        "name": "",
        "func": "var ui = msg.payload;\nvar name = msg.name;\nvar tab = \"Automatiskt luftflöde\";\nvar graph = msg.graph;\nvar block = context.get('block')||{};\nif(ui==\"change\") {\n    if(name==tab) {\n        block[msg.socketid] = false;\n        node.send([null,{topic:\"update\"}])\n        \n    } else {\n        block[msg.socketid] = true;\n    }\n} else if(ui==\"lost\") {\n    block[msg.socketid] = true;\n}\nif(graph!==undefined) {\n    let blocked = true;\n    for (var object in block) {\n                    if (block.hasOwnProperty(object)) {\n                        if(block[object]===false) {\n                            blocked = false;\n                        }\n                    }\n                }\n    if(blocked===false) {\n        return msg;\n    } else if(blocked===true) {\n    node.send({payload:[]});\n}\n}\n\ncontext.set('block',block);",
        "outputs": 2,
        "noerr": 0,
        "x": 638,
        "y": 1134,
        "wires": [
            [
                "b982aa7.a56ab58"
            ],
            [
                "451cdade.53c734"
            ]
        ]
    },
    {
        "id": "41a4486e.6ac608",
        "type": "ui_slider",
        "z": "65e6bc5.05f2644",
        "name": "",
        "label": "Tid",
        "tooltip": "",
        "group": "ad7a33f3.24adf",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "time",
        "min": 0,
        "max": "72",
        "step": 1,
        "x": 253,
        "y": 1134,
        "wires": [
            [
                "451cdade.53c734"
            ]
        ]
    },
    {
        "id": "44d61721.dc1b18",
        "type": "change",
        "z": "b7f67da0.fbf1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Uppdatering pågår, rör inget... Invänta omstart.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1011,
        "y": 3899,
        "wires": [
            [
                "28a0d61e.83686a"
            ]
        ]
    },
    {
        "id": "b819b51e.7e2888",
        "type": "ui_switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Diagnostik",
        "tooltip": "",
        "group": "97526682.5406d8",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "diagnostic",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 301,
        "y": 2520,
        "wires": [
            [
                "a6b3697.c8d4498"
            ]
        ]
    },
    {
        "id": "a6b3697.c8d4498",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "log",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "diagnostic",
                "type": "str"
            }
        ],
        "x": 545,
        "y": 2520,
        "wires": [
            [
                "b819b51e.7e2888"
            ],
            []
        ]
    },
    {
        "id": "5b3bd5b.489a32c",
        "type": "ui_switch",
        "z": "b7f67da0.fbf1",
        "name": "",
        "label": "Prognosreglering",
        "tooltip": "",
        "group": "97526682.5406d8",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "weather",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 321,
        "y": 2569,
        "wires": [
            [
                "2764fba3.e4d1e4"
            ]
        ]
    },
    {
        "id": "2764fba3.e4d1e4",
        "type": "subflow:c191a5d.5d76258",
        "z": "b7f67da0.fbf1",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "log",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "weather",
                "type": "str"
            }
        ],
        "x": 545,
        "y": 2569,
        "wires": [
            [
                "5b3bd5b.489a32c"
            ],
            []
        ]
    },
    {
        "id": "156d24ac.25da5b",
        "type": "ui_chart",
        "z": "27236b7a.3c2274",
        "name": "",
        "group": "3af8f7e6.d24338",
        "order": 2,
        "width": 0,
        "height": 0,
        "label": "Drifttider",
        "chartType": "line",
        "legend": "true",
        "xformat": "dd HH:mm",
        "interpolate": "linear",
        "nodata": "Ingen graf tillgänglig än",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "72",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#ff0000",
            "#004080",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 767,
        "y": 147,
        "wires": [
            []
        ]
    },
    {
        "id": "b1f34ef2.e9568",
        "type": "nibe-graph",
        "z": "27236b7a.3c2274",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "select": "diagnostic_defrost",
        "x": 423,
        "y": 147,
        "wires": [
            [
                "9af4587d.39cc28",
                "592d06bd.f1bce8"
            ],
            []
        ]
    },
    {
        "id": "9af4587d.39cc28",
        "type": "function",
        "z": "27236b7a.3c2274",
        "name": "",
        "func": "var ui = msg.payload;\nvar name = msg.name;\nvar tab = \"Diagnostik\";\nvar graph = msg.graph;\nvar block = context.get('block')||{};\nif(ui==\"change\") {\n    if(name==tab) {\n        block[msg.socketid] = false;\n        node.send([null,{topic:\"update\"}])\n        \n    } else {\n        block[msg.socketid] = true;\n    }\n} else if(ui==\"lost\") {\n    block[msg.socketid] = true;\n}\nif(graph!==undefined) {\n    let blocked = true;\n    for (var object in block) {\n                    if (block.hasOwnProperty(object)) {\n                        if(block[object]===false) {\n                            blocked = false;\n                        }\n                    }\n                }\n    if(blocked===false) {\n        return msg;\n    } else if(blocked===true) {\n    node.send({payload:[]});\n}\n}\n\ncontext.set('block',block);",
        "outputs": 2,
        "noerr": 0,
        "x": 596,
        "y": 147,
        "wires": [
            [
                "156d24ac.25da5b"
            ],
            [
                "b1f34ef2.e9568"
            ]
        ]
    },
    {
        "id": "ce0658.913ce9a8",
        "type": "ui_slider",
        "z": "27236b7a.3c2274",
        "name": "",
        "label": "Tid",
        "tooltip": "",
        "group": "3af8f7e6.d24338",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "time",
        "min": 0,
        "max": "72",
        "step": 1,
        "x": 211,
        "y": 147,
        "wires": [
            [
                "b1f34ef2.e9568"
            ]
        ]
    },
    {
        "id": "592d06bd.f1bce8",
        "type": "function",
        "z": "27236b7a.3c2274",
        "name": "Enable/Disable",
        "func": "if(msg.enabled===false) {\n    let hide = {\n        \"group\":\n            {\"hide\":\n                [\"Diagnostik_Kompressoreffektivitet\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n} else {\n    let hide = {\n        \"group\":\n            {\"show\":\n                [\"Diagnostik_Kompressoreffektivitet\"]\n            }\n        }\n    node.send([null,{payload:hide}]);\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 794,
        "y": 196,
        "wires": [
            [],
            [
                "9ea7c2b5.47c55"
            ]
        ]
    },
    {
        "id": "9ea7c2b5.47c55",
        "type": "ui_ui_control",
        "z": "27236b7a.3c2274",
        "name": "Disable Group S2",
        "events": "all",
        "x": 1007,
        "y": 196,
        "wires": [
            []
        ]
    },
    {
        "id": "4948671e.3c3978",
        "type": "nibe-graph",
        "z": "27236b7a.3c2274",
        "server": "844659a2.8d8508",
        "name": "",
        "system": "s1",
        "select": "efficiency_graph",
        "x": 423,
        "y": 259,
        "wires": [
            [
                "2518a7e6.c9baa8"
            ],
            [
                "94e7615d.bd035"
            ]
        ]
    },
    {
        "id": "2518a7e6.c9baa8",
        "type": "function",
        "z": "27236b7a.3c2274",
        "name": "",
        "func": "var ui = msg.payload;\nvar name = msg.name;\nvar tab = \"Diagnostik\";\nvar graph = msg.graph;\nvar block = context.get('block')||{};\nif(ui==\"change\") {\n    if(name==tab) {\n        block[msg.socketid] = false;\n        node.send([null,{topic:\"update\"}])\n        \n    } else {\n        block[msg.socketid] = true;\n    }\n} else if(ui==\"lost\") {\n    block[msg.socketid] = true;\n}\nif(graph!==undefined) {\n    let blocked = true;\n    for (var object in block) {\n                    if (block.hasOwnProperty(object)) {\n                        if(block[object]===false) {\n                            blocked = false;\n                        }\n                    }\n                }\n    if(blocked===false) {\n        return msg;\n    } else if(blocked===true) {\n    node.send({payload:[]});\n}\n}\n\ncontext.set('block',block);",
        "outputs": 2,
        "noerr": 0,
        "x": 596,
        "y": 259,
        "wires": [
            [
                "c1ddf43e.eca518"
            ],
            [
                "4948671e.3c3978"
            ]
        ]
    },
    {
        "id": "fb927d2f.89856",
        "type": "ui_slider",
        "z": "27236b7a.3c2274",
        "name": "",
        "label": "Dagar",
        "tooltip": "",
        "group": "3af8f7e6.d24338",
        "order": 8,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "time",
        "min": 0,
        "max": "90",
        "step": 1,
        "x": 211,
        "y": 259,
        "wires": [
            [
                "4948671e.3c3978"
            ]
        ]
    },
    {
        "id": "c1ddf43e.eca518",
        "type": "ui_chart",
        "z": "27236b7a.3c2274",
        "name": "",
        "group": "3af8f7e6.d24338",
        "order": 4,
        "width": 0,
        "height": 0,
        "label": "Effektivitet",
        "chartType": "pie",
        "legend": "true",
        "xformat": "dd HH:mm",
        "interpolate": "linear",
        "nodata": "Ingen graf tillgänglig än",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "72",
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#ff0000",
            "#004080",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 784,
        "y": 259,
        "wires": [
            []
        ]
    },
    {
        "id": "94e7615d.bd035",
        "type": "ui_text",
        "z": "27236b7a.3c2274",
        "group": "3af8f7e6.d24338",
        "order": 7,
        "width": "12",
        "height": "3",
        "name": "",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "x": 764,
        "y": 301,
        "wires": []
    },
    {
        "id": "b45691c3.2405a",
        "type": "ui_ui_control",
        "z": "27236b7a.3c2274",
        "name": "",
        "events": "all",
        "x": 137,
        "y": 203,
        "wires": [
            [
                "9af4587d.39cc28",
                "2518a7e6.c9baa8"
            ]
        ]
    },
    {
        "id": "22fa46b9.2067fa",
        "type": "ui_text",
        "z": "960078e.e3e6d88",
        "group": "1b40f24f.7b6d9e",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "Info värme",
        "label": "Begränsa elprisregleringens påverkan med hjälp av en inomhusgivare.<br>Ställ in en differens för den lägsta temperaturen som tillåts vid högt elpris för reglering mot ditt rumsbörvärde.",
        "format": "",
        "layout": "col-center",
        "x": 1085,
        "y": 252,
        "wires": []
    },
    {
        "id": "b5e41612.13ed78",
        "type": "ui_text",
        "z": "960078e.e3e6d88",
        "group": "94305680.d32c48",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "Info värme",
        "label": "Begränsa elprisregleringens påverkan med hjälp av en inomhusgivare.<br>Ställ in en differens för den lägsta temperaturen som tillåts vid högt elpris för reglering mot ditt rumsbörvärde.",
        "format": "",
        "layout": "col-center",
        "x": 574,
        "y": 1386,
        "wires": []
    },
    {
        "id": "a55dd36.0c7fe3",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "temp_low_s2",
                "type": "str"
            }
        ],
        "x": 384,
        "y": 1442,
        "wires": [
            [
                "d41292d7.71f9c"
            ],
            []
        ]
    },
    {
        "id": "d41292d7.71f9c",
        "type": "ui_slider",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Differens",
        "tooltip": "Lägsta temperaturdifferens jämfört mot Inomhusbörvärdet.",
        "group": "94305680.d32c48",
        "order": 8,
        "width": 0,
        "height": 0,
        "passthru": false,
        "outs": "end",
        "topic": "price/temp_low",
        "min": "-3",
        "max": "2",
        "step": "0.1",
        "x": 564,
        "y": 1442,
        "wires": [
            [
                "aa3b6866.eabab8"
            ]
        ]
    },
    {
        "id": "749fe356.3ce75c",
        "type": "nibe-request",
        "z": "960078e.e3e6d88",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 120,
        "y": 1288,
        "wires": [
            [],
            [
                "a7d38e8d.3912f"
            ]
        ]
    },
    {
        "id": "953c6e6b.cd62f",
        "type": "nibe-input",
        "z": "960078e.e3e6d88",
        "server": "844659a2.8d8508",
        "name": "Config",
        "x": 120,
        "y": 1330,
        "wires": [
            [
                "a7d38e8d.3912f"
            ],
            []
        ]
    },
    {
        "id": "a7d38e8d.3912f",
        "type": "function",
        "z": "960078e.e3e6d88",
        "name": "",
        "func": "var sensors = msg.payload.home.inside_sensors||[];\nvar output = [\"Ingen\"];\nfor (const arr of sensors) {\n    output.push(arr.name)\n}\nif(output!==undefined && output!==[]) {\n    node.send({options:output});\n    if(msg.payload.price!==undefined) {\n        node.send({payload:msg.payload.price.sensor_s2})\n    }\n    \n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 414,
        "y": 1330,
        "wires": [
            [
                "4dfc1afe.d9ca64"
            ]
        ]
    },
    {
        "id": "4dfc1afe.d9ca64",
        "type": "ui_dropdown",
        "z": "960078e.e3e6d88",
        "name": "",
        "label": "Välj Inomhusgivare",
        "tooltip": "",
        "place": "Välj",
        "group": "94305680.d32c48",
        "order": 9,
        "width": "0",
        "height": "0",
        "passthru": false,
        "options": [
            {
                "label": "",
                "value": "",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "price/sensor",
        "x": 587,
        "y": 1330,
        "wires": [
            [
                "aa3b6866.eabab8"
            ]
        ]
    },
    {
        "id": "d12fa6cf.081468",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable_temp_s1",
                "type": "str"
            }
        ],
        "x": 1084,
        "y": 105,
        "wires": [
            [
                "33724643.85cd6a"
            ],
            []
        ]
    },
    {
        "id": "33724643.85cd6a",
        "type": "ui_switch",
        "z": "960078e.e3e6d88",
        "name": "Aktivera Temp S1",
        "label": "Inomhusgivare",
        "tooltip": "",
        "group": "1b40f24f.7b6d9e",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "price/enable_temp",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 1294,
        "y": 133,
        "wires": [
            [
                "8dd4be0a.86e46"
            ]
        ]
    },
    {
        "id": "716b8844.bf4848",
        "type": "ui_switch",
        "z": "960078e.e3e6d88",
        "name": "Aktivera Temp S2",
        "label": "Inomhusgivare",
        "tooltip": "",
        "group": "94305680.d32c48",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "price/enable_temp",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 391,
        "y": 1498,
        "wires": [
            [
                "aa3b6866.eabab8"
            ]
        ]
    },
    {
        "id": "6207d08.841933",
        "type": "subflow:c191a5d.5d76258",
        "z": "960078e.e3e6d88",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "price",
                "type": "str"
            },
            {
                "name": "Function",
                "value": "enable_temp_s2",
                "type": "str"
            }
        ],
        "x": 181,
        "y": 1470,
        "wires": [
            [
                "716b8844.bf4848"
            ],
            []
        ]
    }
]